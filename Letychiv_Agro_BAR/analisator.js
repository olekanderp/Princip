[{"id":"645e795e.0fe4b8","type":"tab","label":"Granolyser"},{"id":"3f7fa848.d002d8","type":"tab","label":"Flow 1"},{"id":"f8dca4ee.f01578","type":"tls-config","z":"","name":"","cert":"","key":"","ca":"","verifyservercert":false},{"id":"228b302a.690cf","type":"debug","z":"3f7fa848.d002d8","name":"","active":true,"console":"false","complete":"true","x":366,"y":65,"wires":[]},{"id":"1e7d4eb0.38c791","type":"function","z":"3f7fa848.d002d8","name":"","func":"var str = msg.payload;\n\nvar buff_uf8 = Buffer.from(str, \"utf-8\");\nvar buf_simple = Buffer.from(str);\n\n\nmsg.payload = {\n   buff_uf8, buf_simple  \n};\nreturn msg;","outputs":1,"noerr":0,"x":385,"y":110,"wires":[["61ae89a7.683618","ba6bf4a8.b61278"]]},{"id":"d7a1d9d6.d7d078","type":"function","z":"3f7fa848.d002d8","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":367,"y":151,"wires":[["4c057c10.d15674"]]},{"id":"61ae89a7.683618","type":"debug","z":"3f7fa848.d002d8","name":"","active":true,"console":"false","complete":"true","x":620,"y":112,"wires":[]},{"id":"4c057c10.d15674","type":"debug","z":"3f7fa848.d002d8","name":"","active":false,"console":"false","complete":"true","x":517,"y":154,"wires":[]},{"id":"6f5cf119.a2fd9","type":"function","z":"3f7fa848.d002d8","name":"","func":"\nvar myString = msg.payload;\nvar splits = myString.split(';');\n\n\nmsg.payload = splits;\nreturn msg;","outputs":1,"noerr":0,"x":367,"y":193,"wires":[["2ef45a91.f165c6"]]},{"id":"2ef45a91.f165c6","type":"debug","z":"3f7fa848.d002d8","name":"","active":true,"console":"false","complete":"true","x":516,"y":195,"wires":[]},{"id":"e4c35031.25328","type":"function","z":"3f7fa848.d002d8","name":"","func":"var str = msg.payload;\nmsg.payload = str.toString();\nreturn msg;","outputs":1,"noerr":0,"x":226,"y":237,"wires":[["1e7d4eb0.38c791","d7a1d9d6.d7d078","6f5cf119.a2fd9","4b7a76e0.d60fb8"]]},{"id":"4b7a76e0.d60fb8","type":"debug","z":"3f7fa848.d002d8","name":"","active":false,"console":"false","complete":"true","x":384,"y":279,"wires":[]},{"id":"9f8e315.e4b3dd","type":"function","z":"3f7fa848.d002d8","name":"","func":"var bufferOriginal = msg.payload;\nmsg.payload = decodeURIComponent(bufferOriginal);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":222,"y":290,"wires":[["3569ab1b.84d714"]]},{"id":"3569ab1b.84d714","type":"debug","z":"3f7fa848.d002d8","name":"","active":false,"console":"false","complete":"true","x":377,"y":317,"wires":[]},{"id":"a59554de.bd8b78","type":"comment","z":"3f7fa848.d002d8","name":"1","info":";399;111;�������;16.07.2021    11:19:31;;2020-12-04-717;|;;\n\n\n\n0: 59\n1: 51\n2: 57\n3: 57\n4: 59\n5: 49\n6: 49\n7: 49\n8: 59\n9: 207\n[10 … 19]\n10: 248\n11: 229\n12: 237\n13: 232\n14: 246\n15: 224\n16: 59\n17: 49\n18: 54\n19: 46\n[20 … 29]\n20: 48\n21: 55\n22: 46\n23: 50\n24: 48\n25: 50\n26: 49\n27: 32\n28: 32\n29: 32\n[30 … 39]\n30: 32\n31: 49\n32: 49\n33: 58\n34: 49\n35: 57\n36: 58\n37: 51\n38: 49\n39: 59\n[40 … 49]\n40: 59\n41: 50\n42: 48\n43: 50\n44: 48\n45: 45\n46: 49\n47: 50\n48: 45\n49: 48\n[50 … 59]\n50: 52\n51: 45\n52: 55\n53: 49\n54: 55\n55: 59\n56: 124\n57: 59\n58: 59\n59: 10\n\n\n0: \"\"\n1: \"399\"\n2: \"111\"\n3: \"�������\"\n4: \"16.07.2021 11:19:31\"\n5: \"\"\n6: \"2020-12-04-717\"\n7: \"|\"\n8: \"\"\n9: \"↵\"\n","x":139,"y":458,"wires":[]},{"id":"ba6bf4a8.b61278","type":"function","z":"3f7fa848.d002d8","name":"","func":"var bufferOriginal = msg.payload.buff_uf8;\nmsg.payload = bufferOriginal.toString('utf8');\nreturn msg;\n\n","outputs":1,"noerr":0,"x":559,"y":45,"wires":[["61ae89a7.683618"]]},{"id":"34ea5d7c.002d22","type":"comment","z":"3f7fa848.d002d8","name":"2","info":"0717;7328;7328;��������;28.10.2021    16:05:29;;2020-12-04-717;|;���������;13.6;%;|;�����; 7.4;%;|;�������;77.6;%;|;\n\n0: \"0717\"\n1: \"7328\"\n2: \"7328\"\n3: \"��������\"\n4: \"28.10.2021 16:05:29\"\n5: \"\"\n6: \"2020-12-04-717\"\n7: \"|\"\n8: \"���������\"\n9: \"13.6\"\n[10 … 19]\n10: \"%\"\n11: \"|\"\n12: \"�����\"\n13: \" 7.4\"\n14: \"%\"\n15: \"|\"\n16: \"�������\"\n17: \"77.6\"\n18: \"%\"\n19: \"|\"\n[20 … 20]\n20: \"↵\"","x":282,"y":459,"wires":[]},{"id":"bb89bcdf.4c3da","type":"comment","z":"3f7fa848.d002d8","name":"3","info":"[0 … 9]\n0: 48\n1: 55\n2: 49\n3: 55\n4: 59\n5: 55\n6: 51\n7: 50\n8: 57\n9: 59\n[10 … 19]\n10: 55\n11: 51\n12: 50\n13: 57\n14: 59\n15: 202\n16: 243\n17: 234\n18: 243\n19: 240\n[20 … 29]\n20: 243\n21: 231\n22: 224\n23: 59\n24: 50\n25: 56\n26: 46\n27: 49\n28: 48\n29: 46\n[30 … 39]\n30: 50\n31: 48\n32: 50\n33: 49\n34: 32\n35: 32\n36: 32\n37: 32\n38: 49\n39: 54\n[40 … 49]\n40: 58\n41: 49\n42: 48\n43: 58\n44: 48\n45: 55\n46: 59\n47: 59\n48: 50\n49: 48\n[50 … 59]\n50: 50\n51: 48\n52: 45\n53: 49\n54: 50\n55: 45\n56: 48\n57: 52\n58: 45\n59: 55\n[60 … 69]\n60: 49\n61: 55\n62: 59\n63: 124\n64: 59\n65: 194\n66: 235\n67: 224\n68: 230\n69: 237\n[70 … 79]\n70: 238\n71: 241\n72: 242\n73: 252\n74: 59\n75: 50\n76: 55\n77: 46\n78: 53\n79: 59\n[80 … 89]\n80: 37\n81: 59\n82: 124\n83: 59\n84: 193\n85: 229\n86: 235\n87: 238\n88: 234\n89: 59\n[90 … 99]\n90: 32\n91: 55\n92: 46\n93: 57\n94: 59\n95: 37\n96: 59\n97: 124\n98: 59\n99: 234\n[100 … 109]\n100: 240\n101: 224\n102: 245\n103: 236\n104: 224\n105: 235\n106: 59\n107: 55\n108: 56\n109: 46\n[110 … 116]\n110: 51\n111: 59\n112: 37\n113: 59\n114: 124\n115: 59\n116: 10\n\n\n\n0717;7329;7329;��������;28.10.2021    16:10:07;;2020-12-04-717;|;���������;27.5;%;|;�����; 7.9;%;|;�������;78.3;%;|;\n","x":423,"y":457,"wires":[]},{"id":"6ae5a7e3.8f3a78","type":"debug","z":"3f7fa848.d002d8","name":"","active":true,"console":"false","complete":"true","x":372,"y":395,"wires":[]},{"id":"7960f19b.8245b","type":"comment","z":"3f7fa848.d002d8","name":"4","info":"[0 … 9]\n0: 48\n1: 55\n2: 49\n3: 55\n4: 59\n5: 55\n6: 51\n7: 50\n8: 57\n9: 59\n[10 … 19]\n10: 55\n11: 51\n12: 50\n13: 57\n14: 59\n15: 202\n16: 243\n17: 234\n18: 243\n19: 240\n[20 … 29]\n20: 243\n21: 231\n22: 224\n23: 59\n24: 50\n25: 56\n26: 46\n27: 49\n28: 48\n29: 46\n[30 … 39]\n30: 50\n31: 48\n32: 50\n33: 49\n34: 32\n35: 32\n36: 32\n37: 32\n38: 49\n39: 54\n[40 … 49]\n40: 58\n41: 49\n42: 48\n43: 58\n44: 48\n45: 55\n46: 59\n47: 59\n48: 50\n49: 48\n[50 … 59]\n50: 50\n51: 48\n52: 45\n53: 49\n54: 50\n55: 45\n56: 48\n57: 52\n58: 45\n59: 55\n[60 … 69]\n60: 49\n61: 55\n62: 59\n63: 124\n64: 59\n65: 194\n66: 235\n67: 224\n68: 230\n69: 237\n[70 … 79]\n70: 238\n71: 241\n72: 242\n73: 252\n74: 59\n75: 50\n76: 55\n77: 46\n78: 53\n79: 59\n[80 … 89]\n80: 37\n81: 59\n82: 124\n83: 59\n84: 193\n85: 229\n86: 235\n87: 238\n88: 234\n89: 59\n[90 … 99]\n90: 32\n91: 55\n92: 46\n93: 57\n94: 59\n95: 37\n96: 59\n97: 124\n98: 59\n99: 234\n[100 … 109]\n100: 240\n101: 224\n102: 245\n103: 236\n104: 224\n105: 235\n106: 59\n107: 55\n108: 56\n109: 46\n[110 … 116]\n110: 51\n111: 59\n112: 37\n113: 59\n114: 124\n115: 59\n116: 10\n\n\n\n0717;7329;7329;��������;28.10.2021    16:10:07;;2020-12-04-717;|;���������;27.5;%;|;�����; 7.9;%;|;�������;78.3;%;|;\n","x":559,"y":453,"wires":[]},{"id":"c70b8c45.153c5","type":"tcp in","z":"645e795e.0fe4b8","name":"","server":"server","host":"10.15.16.28","port":"4002","datamode":"stream","datatype":"buffer","newline":"","topic":"","base64":false,"x":144,"y":175,"wires":[["b17f5520.a785b8","b41928dc.8cea78"]]},{"id":"b17f5520.a785b8","type":"converter","z":"645e795e.0fe4b8","name":"","from":"win1251","x":153,"y":229,"wires":[["dea0a970.8fc0b8","c0aa1985.df8f98"]]},{"id":"dea0a970.8fc0b8","type":"debug","z":"645e795e.0fe4b8","name":"convert","active":true,"console":"false","complete":"payload","x":386,"y":229,"wires":[]},{"id":"b8993d2e.89f84","type":"comment","z":"3f7fa848.d002d8","name":"5","info":"0717;7335;7335;Кукуруза;28.10.2021    16:46:15;;2020-12-04-717;|;Влажность;31.8;%;|;Белок; 7.9;%;|;крахмал;77.8;%;|;","x":677,"y":459,"wires":[]},{"id":"5a070fb6.3eed1","type":"comment","z":"3f7fa848.d002d8","name":"6","info":"0717;7336;21000923;Кукуруза;28.10.2021    16:47:45;;2020-12-04-717;|;Влажность;31.8;%;|;Белок; 7.9;%;|;крахмал;77.3;%;|;","x":790,"y":456,"wires":[]},{"id":"c0aa1985.df8f98","type":"function","z":"645e795e.0fe4b8","name":"Body message","func":"let send1C = {\n    truck_id: \"\",\n    device_id: global.get('device_id_infratec'),\n    message: msg.payload\n};\n\n msg.payload = send1C;\n msg.url = global.get(\"send_1c_url_quality\");\nreturn msg;","outputs":1,"noerr":0,"x":393,"y":429,"wires":[["9f2e25ca.2ddc68","1bc21a60.7e1366","f6a7b49b.33fd88"]]},{"id":"d0e8523b.8e792","type":"inject","z":"645e795e.0fe4b8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":113,"y":429,"wires":[["ab20cf77.19f8e"]]},{"id":"ab20cf77.19f8e","type":"function","z":"645e795e.0fe4b8","name":"test","func":"msg.payload = `0717;7336;21000923;Кукуруза;28.10.2021    16:47:45;;2020-12-04-717;|;Влажность;31.8;%;|;Белок; 7.9;%;|;крахмал;77.3;%;|;`;\nreturn msg;","outputs":1,"noerr":0,"x":243,"y":429,"wires":[["c0aa1985.df8f98"]]},{"id":"9f2e25ca.2ddc68","type":"debug","z":"645e795e.0fe4b8","name":"","active":true,"console":"true","complete":"true","x":715,"y":428,"wires":[]},{"id":"1bc21a60.7e1366","type":"http request","z":"645e795e.0fe4b8","name":"Send","method":"POST","ret":"txt","url":"","tls":"","x":544,"y":408,"wires":[["2d3c8cfb.ad95a4"]]},{"id":"7904c34e.02b82c","type":"comment","z":"645e795e.0fe4b8","name":"Відправка в 1С","info":"приклад 1:\n0717;7818;5099206020658;Кукуруза;01.11.2021    10:46:00;;2020-12-04-717;|;Влажность;27.1;%;|;Белок; 7.8;%;|;крахмал;77.0;%;|;\n\nПриклад 2:\n0717;7820;7819;Кукуруза;01.11.2021    11:23:42;;2020-12-04-717;|;Влажность;22.6;%;|;Белок; 7.5;%;|;крахмал;77.4;%;|;","x":93,"y":389,"wires":[]},{"id":"6e823f0f.503a","type":"function","z":"645e795e.0fe4b8","name":"Config","func":"//flow.set('lastAnalys',msg.payload);\nflow.set('barcode',\"\");\n\nglobal.set('device_id_infratec',\"198eefb2-14e2-49a6-b796-b45e7a9adf86\");\nglobal.set(\"send_1c_url_quality\", \"http://10.10.10.15/Granary/hs/PerimeterControl/api/SmartScales/quality\");\nreturn msg;","outputs":1,"noerr":0,"x":326,"y":65,"wires":[[]]},{"id":"61bb6b4f.7a8974","type":"inject","z":"645e795e.0fe4b8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":129,"y":62,"wires":[["6e823f0f.503a"]]},{"id":"b41928dc.8cea78","type":"debug","z":"645e795e.0fe4b8","name":"original","active":true,"console":"false","complete":"payload","x":402,"y":176,"wires":[]},{"id":"4d1c0211.6f08fc","type":"comment","z":"645e795e.0fe4b8","name":"Відправка в 1С","info":"приклад 1:\n0717;7818;5099206020658;Кукуруза;01.11.2021    10:46:00;;2020-12-04-717;|;Влажность;27.1;%;|;Белок; 7.8;%;|;крахмал;77.0;%;|;","x":131,"y":22,"wires":[]},{"id":"eea64674.58de48","type":"comment","z":"645e795e.0fe4b8","name":"GET data","info":"приклад 1:\n0717;7818;5099206020658;Кукуруза;01.11.2021    10:46:00;;2020-12-04-717;|;Влажность;27.1;%;|;Белок; 7.8;%;|;крахмал;77.0;%;|;","x":111,"y":131,"wires":[]},{"id":"2d3c8cfb.ad95a4","type":"debug","z":"645e795e.0fe4b8","name":"","active":true,"console":"true","complete":"true","x":733,"y":363,"wires":[]},{"id":"f6a7b49b.33fd88","type":"json","z":"645e795e.0fe4b8","name":"","x":541,"y":459,"wires":[["9f2e25ca.2ddc68"]]}]
