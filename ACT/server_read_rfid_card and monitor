[{"id":"5123a448.dda04c","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"1b15566b.0966fa","type":"tab","label":"Flow 2","disabled":false,"info":""},{"id":"4fe9b1ce.fa1f7","type":"ui_group","z":"","name":"","tab":"2033c378.c8f71c","disp":true,"width":"14","collapse":false},{"id":"2033c378.c8f71c","type":"ui_tab","z":"","name":"Урожай+","icon":"dashboard"},{"id":"492d246c.0bf1ec","type":"ui_base","theme":{"name":"theme-custom","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#4696f7","baseFont":"Arial,Arial,Helvetica,sans-serif","edited":true,"reset":false},"customTheme":{"name":"BC","default":"#4B7930","baseColor":"#1f8cd6","baseFont":"Arial,Arial,Helvetica,sans-serif","reset":false},"themeState":{"base-color":{"default":"#4B7930","value":"#1f8cd6","edited":true},"page-titlebar-backgroundColor":{"value":"#1f8cd6","edited":false},"page-backgroundColor":{"value":"#47a6e4","edited":true},"page-sidebar-backgroundColor":{"value":"#47a6e4","edited":true},"group-textColor":{"value":"#5aaee7","edited":false},"group-borderColor":{"value":"#47a6e4","edited":true},"group-backgroundColor":{"value":"#47a6e4","edited":true},"widget-textColor":{"value":"#ffffff","edited":true},"widget-backgroundColor":{"value":"#1f8cd6","edited":false},"widget-borderColor":{"value":"#47a6e4","edited":true},"base-font":{"value":"Arial,Arial,Helvetica,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":60,"sy":60,"gx":3,"gy":3,"cx":3,"cy":3,"px":0,"py":0}}},{"id":"2b9e12a7.b3559e","type":"ui_group","z":"","name":"","tab":"","disp":true,"width":"14"},{"id":"cc7fb054.90107","type":"serial-port","z":"","serialport":"/dev/hidraw1","serialbaud":"57600","databits":"8","parity":"none","stopbits":"1","newline":"1000","bin":"false","out":"time","addchar":false,"responsetimeout":"10000"},{"id":"a1475a63.d3a178","type":"HIDConfig","z":"","vid":"65535","pid":"53","name":""},{"id":"bab3903c.acc3c","type":"rpi-keyboard","z":"1b15566b.0966fa","name":"","x":143,"y":177,"wires":[["3625d373.4ed7dc","e756b59a.77aaa8"]]},{"id":"ab5e7027.7c2bc","type":"debug","z":"1b15566b.0966fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":160,"wires":[]},{"id":"b030fd83.466ed","type":"inject","z":"1b15566b.0966fa","name":"","topic":"init","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":130,"y":60,"wires":[["8e0d06a1.380d38"]]},{"id":"8e0d06a1.380d38","type":"function","z":"1b15566b.0966fa","name":"","func":"flow.set('kayboard_buf',[]);\n\nreturn msg;","outputs":1,"noerr":0,"x":260,"y":60,"wires":[[]]},{"id":"7bc4883e.f99878","type":"function","z":"1b15566b.0966fa","name":"","func":"var kbBuf = flow.get('kayboard_buf');\n//driver\nvar temp_signal = msg.payload-1;\nif (temp_signal >= 10) {\n    temp_signal = 0;\n}\n\nkbBuf.push(temp_signal);\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":160,"wires":[["ab5e7027.7c2bc"]]},{"id":"3625d373.4ed7dc","type":"switch","z":"1b15566b.0966fa","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"28","vt":"str"},{"t":"neq","v":"28","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":360,"y":180,"wires":[["821a626f.2b759"],["7bc4883e.f99878"]]},{"id":"e7039a6d.41c428","type":"debug","z":"1b15566b.0966fa","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":850,"y":100,"wires":[]},{"id":"821a626f.2b759","type":"function","z":"1b15566b.0966fa","name":"","func":"msg.payload = flow.get('kayboard_buf');\n\n\n//remove each 2nd element\nvar result = [];\n\nfor (var i = 0; i < msg.payload.length; i++){\n    if(i%2===0){\n      result.push(msg.payload[i]);  \n    }\n}\n\nflow.set('kayboard_buf',[]);\nmsg.payload = result.join(\"\");\nreturn msg;","outputs":1,"noerr":0,"x":570,"y":100,"wires":[["e7039a6d.41c428","114b0019.a76ca"]]},{"id":"59c033d.ddf9ccc","type":"tcp out","z":"1b15566b.0966fa","host":"10.18.8.47","port":"4003","beserver":"client","base64":false,"end":false,"name":"","x":995,"y":348,"wires":[]},{"id":"9d883143.67215","type":"ui_template","z":"1b15566b.0966fa","group":"4fe9b1ce.fa1f7","name":"","order":0,"width":"14","height":"10","format":"<style>\n   h4 {\n    font-family: 'Arial', Times, serif; /* Гарнитура текста */ \n    font-size: 200%; /* Размер шрифта в процентах */ \n   } \n   </style>\n<h4 style=\"color:black;\">Повідомлення:</h4> \n<div style=\"font-size:500%;font-weight:bold;\" ng-bind-html=msg.payload.text></div>\n\n\n\n\n        \n\n\n \n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":411,"y":369,"wires":[[]]},{"id":"5209d6b5.c357d8","type":"http in","z":"1b15566b.0966fa","name":"","url":"/sendToDisp","method":"get","upload":false,"swaggerDoc":"","x":180,"y":395,"wires":[["4b378634.5031e8","c15d1226.4dd07","9d883143.67215"]]},{"id":"c15d1226.4dd07","type":"debug","z":"1b15566b.0966fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":403,"y":406,"wires":[]},{"id":"4b378634.5031e8","type":"http response","z":"1b15566b.0966fa","name":"","statusCode":"","headers":{},"x":398,"y":442,"wires":[]},{"id":"e756b59a.77aaa8","type":"debug","z":"1b15566b.0966fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":374,"y":239,"wires":[]},{"id":"16e249aa.292b36","type":"getHIDdevices","z":"1b15566b.0966fa","name":"1","x":281,"y":652,"wires":[["6a0e6dc1.7e5f44"]]},{"id":"baaa6511.ee6848","type":"HIDdevice","z":"1b15566b.0966fa","connection":"a1475a63.d3a178","name":"","x":102,"y":744,"wires":[["cb5ea177.fb9cb","44d96b41.f7af74","4f41eb93.a45a04"],[]]},{"id":"eb22d8fe.e90388","type":"inject","z":"1b15566b.0966fa","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":142,"y":652,"wires":[["16e249aa.292b36"]]},{"id":"6a0e6dc1.7e5f44","type":"debug","z":"1b15566b.0966fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":443,"y":655,"wires":[]},{"id":"164e48eb.ffe9a7","type":"comment","z":"1b15566b.0966fa","name":"0005493987","info":"","x":657,"y":682,"wires":[]},{"id":"30aafd26.0d33a2","type":"function","z":"1b15566b.0966fa","name":"","func":"var in_buf = msg.payload;\n\n\nmsg.payload = (in_buf[2]);\n\nif(in_buf[2] >= 30 && in_buf[2] !== 39){\n   msg.payload =  (in_buf[2] - 30) + 1;\n}else if(in_buf[2] == 4){\n    msg.payload = \"a\";    \n}else if(in_buf[2] == 5){\n    msg.payload = \"b\";  \n}else if(in_buf[2] === 0){\n    msg.payload = \"\";  \n}else if(in_buf[2] == 6){\n    msg.payload = \"c\";  \n}else if(in_buf[2] == 7){\n    msg.payload = \"d\";  \n}else if(in_buf[2] == 8){\n    msg.payload = \"e\";  \n}else if(in_buf[2] == 39){\n    msg.payload = \"0\";  \n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":396,"y":742,"wires":[["a42130d1.e836a"]]},{"id":"f5382730.3061c8","type":"inject","z":"1b15566b.0966fa","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":141,"y":599,"wires":[["b43a42b3.74358"]]},{"id":"b43a42b3.74358","type":"function","z":"1b15566b.0966fa","name":"init","func":"flow.set(\"mas\",[]);\nflow.set(\"mas_buf_number\",[]);\nflow.set('string_number',\"\");\nflow.set('triger_1',1);\nreturn msg;","outputs":1,"noerr":0,"x":285,"y":599,"wires":[[]]},{"id":"a42130d1.e836a","type":"function","z":"1b15566b.0966fa","name":"","func":"var mas_buf_number = flow.get(\"mas_buf_number\");\nvar length_mas = mas_buf_number.length;\n\nmas_buf_number.push(msg.payload);\nmsg.payload = mas_buf_number;\nflow.set(\"length_mas\", length_mas);\nreturn msg;","outputs":1,"noerr":0,"x":525,"y":743,"wires":[["f8146ecd.321cf","806ab2f.c0d205"]]},{"id":"77228ed4.30393","type":"debug","z":"1b15566b.0966fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":985,"y":797,"wires":[]},{"id":"f8146ecd.321cf","type":"debug","z":"1b15566b.0966fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":741,"y":752,"wires":[]},{"id":"44d96b41.f7af74","type":"delay","z":"1b15566b.0966fa","name":"","pauseType":"rate","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"0.1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":263,"y":717,"wires":[["30aafd26.0d33a2"]]},{"id":"135d45d8.2d0a2a","type":"comment","z":"1b15566b.0966fa","name":"1f0053d4e3","info":"","x":856,"y":678,"wires":[]},{"id":"24724eba.6fcec2","type":"comment","z":"1b15566b.0966fa","name":"30,0,9,0,39,0,39,0,34,0,32,0,7,0,33,0,8,0,32,0","info":"","x":758,"y":713,"wires":[]},{"id":"806ab2f.c0d205","type":"function","z":"1b15566b.0966fa","name":"","func":"msg.payload = flow.get(\"length_mas\");\n\nreturn msg;","outputs":1,"noerr":0,"x":322,"y":833,"wires":[[]]},{"id":"1a34ed09.3980e3","type":"function","z":"1b15566b.0966fa","name":"action_in","func":"msg.payload =  msg.payload + \"in\";\nreturn msg;","outputs":1,"noerr":0,"x":777,"y":263,"wires":[["59c033d.ddf9ccc","f364ae4a.07f45"]]},{"id":"730bc97b.fe6eb8","type":"function","z":"1b15566b.0966fa","name":"action_out","func":"msg.payload =  msg.payload + \"out\";\n   \nflow.set(\"length_mas\",0);\nflow.set(\"mas_buf_number\",[]);\nreturn msg;","outputs":1,"noerr":0,"x":787,"y":485,"wires":[["59c033d.ddf9ccc","2256ba2b.3ccb06"]]},{"id":"f364ae4a.07f45","type":"debug","z":"1b15566b.0966fa","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1038,"y":255,"wires":[]},{"id":"2256ba2b.3ccb06","type":"debug","z":"1b15566b.0966fa","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1035,"y":474,"wires":[]},{"id":"114b0019.a76ca","type":"switch","z":"1b15566b.0966fa","name":"","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"28","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":674,"y":220,"wires":[["1a34ed09.3980e3"]]},{"id":"d2171aad.152bc8","type":"delay","z":"1b15566b.0966fa","name":"","pauseType":"rate","timeout":"6","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":731,"y":579,"wires":[["730bc97b.fe6eb8"]]},{"id":"4d6ad4fe.2dd63c","type":"inject","z":"1b15566b.0966fa","name":"","topic":"","payload":"0005493987","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":554,"y":532,"wires":[["d2171aad.152bc8"]]},{"id":"4912bfe1.e137a","type":"inject","z":"1b15566b.0966fa","name":"","topic":"","payload":"0005493987","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":552,"y":298,"wires":[["1a34ed09.3980e3"]]},{"id":"1d7bd8af.38a207","type":"function","z":"1b15566b.0966fa","name":"","func":"var mas_buf_number = flow.get(\"mas_buf_number\");\nmas_buf_number = mas_buf_number.join('');\n\nmas_buf_number = mas_buf_number.toString();\nmas_buf_number = mas_buf_number.substring(3,9);\n\nmas_buf_number = \"0x\" + mas_buf_number;\nmas_buf_number = mas_buf_number.toString(16);\nmas_buf_number = Number(mas_buf_number);\nmas_buf_number = \"000\" + mas_buf_number;\nmsg.payload  = mas_buf_number ;\n\nmsg.payload  = mas_buf_number ;\n\nflow.set(\"length_mas\", 0);\n\n\nreturn msg;","outputs":1,"noerr":0,"x":825,"y":928,"wires":[["dc247c9f.a6e1c","d2171aad.152bc8"]]},{"id":"dc247c9f.a6e1c","type":"debug","z":"1b15566b.0966fa","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1011,"y":927,"wires":[]},{"id":"b0a72ac6.8a0158","type":"comment","z":"1b15566b.0966fa","name":"0005493987","info":"","x":427,"y":949,"wires":[]},{"id":"cb5ea177.fb9cb","type":"function","z":"1b15566b.0966fa","name":"","func":"var in_buf = msg.payload;\n\n\nmsg.payload = (in_buf[2]);\n\nif(in_buf[2] >= 30 && in_buf[2] !== 39){\n   msg.payload =  (in_buf[2] - 30) + 1;\n}else if(in_buf[2] == 4){\n    msg.payload = \"a\";    \n}else if(in_buf[2] == 5){\n    msg.payload = \"b\";  \n}else if(in_buf[2] === 0){\n    msg.payload = \"\";  \n}else if(in_buf[2] == 6){\n    msg.payload = \"c\";  \n}else if(in_buf[2] == 7){\n    msg.payload = \"d\";  \n}else if(in_buf[2] == 8){\n    msg.payload = \"e\";  \n}else if(in_buf[2] == 39){\n    msg.payload = \"0\";  \n}\n\n\nreturn msg;","outputs":1,"noerr":0,"x":325,"y":905,"wires":[["e3a2497c.230748"]]},{"id":"e3a2497c.230748","type":"function","z":"1b15566b.0966fa","name":"","func":"var mas_buf_number = flow.get(\"mas_buf_number\");\nvar length_mas = mas_buf_number.length;\n\nmas_buf_number.push(msg.payload);\nmsg.payload = mas_buf_number;\nflow.set(\"length_mas\", length_mas);\nreturn msg;","outputs":1,"noerr":0,"x":474,"y":910,"wires":[["806ab2f.c0d205","59b5d41.d45b42c","126c9784.ff8768"]]},{"id":"e97acb85.ac0b18","type":"inject","z":"1b15566b.0966fa","name":"","topic":"","payload":"0005493987","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":157,"y":1038,"wires":[["d3dd1ddf.01de7"]]},{"id":"d3dd1ddf.01de7","type":"function","z":"1b15566b.0966fa","name":"","func":"\nflow.set(\"mas_buf_number\", []);\nreturn msg;","outputs":1,"noerr":0,"x":426,"y":1036,"wires":[["86e6974e.2d02b8"]]},{"id":"59b5d41.d45b42c","type":"debug","z":"1b15566b.0966fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":672,"y":987,"wires":[]},{"id":"86e6974e.2d02b8","type":"debug","z":"1b15566b.0966fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":575,"y":1057,"wires":[]},{"id":"4f41eb93.a45a04","type":"delay","z":"1b15566b.0966fa","name":"","pauseType":"rate","timeout":"6","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":196,"y":979,"wires":[["d3dd1ddf.01de7"]]},{"id":"126c9784.ff8768","type":"switch","z":"1b15566b.0966fa","name":"","property":"length_mas","propertyType":"flow","rules":[{"t":"eq","v":"19","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":664,"y":922,"wires":[["1d7bd8af.38a207"]]}]
