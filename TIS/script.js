[{"id":"5495c7d6.7cbd98","type":"inject","z":"1a2ca682.6f6909","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":100,"y":20,"wires":[["4aa69f4e.49822"]]},{"id":"34d4a45a.2a6aac","type":"debug","z":"1a2ca682.6f6909","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1090,"y":40,"wires":[]},{"id":"d8b85972.195d48","type":"exec","z":"1a2ca682.6f6909","command":"","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":370,"y":60,"wires":[["c03c156f.b09c88","59b9678c.646b58","29f1d421.21206c"],[],[]]},{"id":"4aa69f4e.49822","type":"function","z":"1a2ca682.6f6909","name":"","func":"msg.payload = \"ls /home/pi/share\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":240,"y":20,"wires":[["d8b85972.195d48"]]},{"id":"bb6bcf42.b5c96","type":"inject","z":"1a2ca682.6f6909","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":140,"wires":[["b5573cef.72f81"]]},{"id":"b5573cef.72f81","type":"function","z":"1a2ca682.6f6909","name":"","func":"function formatDate(date) {\n    var d = new Date(date),\n        month = '' + (d.getMonth() + 1),\n        day = '' + d.getDate(),\n        year = d.getFullYear(),\n        hours = d.getHours() + 3,\n        minutes= d.getMinutes(),\n        seconds = d.getSeconds();\n        \n\n    if (month.length < 2) \n        month = '0' + month;\n    if (day.length < 2) \n        day = '0' + day ;\n    if (hours.length < 2) \n        hours = '0' + hours;\n    if (minutes.length < 2) \n        minutes = '0' + minutes;\n    \n    //day = 11;\n    return [year,month,day].join('-');\n}\n\n        var time_in  = formatDate(msg.payload);\n        var time_out = new Date(msg.payload);\n        \nmsg.payload = time_in;\n\nflow.set(\"time_in\", time_in);\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":140,"wires":[["da7849a8.af0218"]]},{"id":"da7849a8.af0218","type":"debug","z":"1a2ca682.6f6909","name":"req","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":430,"y":140,"wires":[]},{"id":"c03c156f.b09c88","type":"function","z":"1a2ca682.6f6909","name":"","func":"var result = msg.payload;\nvar date_today = flow.get(\"time_in\");\n\n//var enter = result.substring(10,11);\nvar enter = String.fromCharCode(10);\nvar arra_dir = result.split(enter);\n\nfor (var i = 0; i < arra_dir.length; i++) {\n     if(arra_dir[i] == date_today){\n            msg.payload = \"is\";\n            break;\n        }else{\n            msg.payload = \"not\";\n        }\n}\n\n\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":60,"wires":[["5d099c5a.cc9494"]]},{"id":"59b9678c.646b58","type":"debug","z":"1a2ca682.6f6909","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":510,"y":20,"wires":[]},{"id":"faf0db5.7e77828","type":"debug","z":"1a2ca682.6f6909","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":590,"y":120,"wires":[]},{"id":"5d099c5a.cc9494","type":"switch","z":"1a2ca682.6f6909","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"not","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":630,"y":60,"wires":[["90cc2dbf.00135","faf0db5.7e77828"]]},{"id":"d7d23e2.3d924c","type":"exec","z":"1a2ca682.6f6909","command":"","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":930,"y":60,"wires":[["34d4a45a.2a6aac","d71af090.4d9cd"],[],[]]},{"id":"90cc2dbf.00135","type":"function","z":"1a2ca682.6f6909","name":"","func":"\nvar date_today = flow.get(\"time_in\");\nvar dir = \"/home/pi/share\"\nmsg.payload = \"mkdir \" + dir + \"/\" + date_today;\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":60,"wires":[["d7d23e2.3d924c","8a6385ff.01e158"]]},{"id":"8a6385ff.01e158","type":"debug","z":"1a2ca682.6f6909","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":810,"y":120,"wires":[]},{"id":"d71af090.4d9cd","type":"function","z":"1a2ca682.6f6909","name":"","func":"var file = \"my file\";\n\nvar cp = \"cp \" + file + \" /home/pi/share\" \nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":140,"wires":[[]]},{"id":"4ee468ca.dfd038","type":"debug","z":"1a2ca682.6f6909","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":730,"y":220,"wires":[]},{"id":"29f1d421.21206c","type":"function","z":"1a2ca682.6f6909","name":"","func":"var result = msg.payload;\nvar date_today = flow.get(\"time_in\");\n\n//var enter = result.substring(10,11);\nvar enter = String.fromCharCode(10);\nvar arra_dir = result.split(enter);\n\nfor (var i = 0; i < arra_dir.length; i++) {\n     if(arra_dir[i] == date_today){\n            msg.payload = \"is\";\n            break;\n        }else{\n            msg.payload = \"not\";\n        }\n}\n\n msg.payload = arra_dir;\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":200,"wires":[["4ee468ca.dfd038"]]}]
