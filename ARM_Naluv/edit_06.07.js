[{"id":"80d8d1e5.1f575","type":"modbus-flex-getter","z":"224ed2cb.a59cce","name":"","showStatusActivities":false,"showErrors":false,"server":"eeebef8f.3d967","x":1365.71435546875,"y":194.2857208251953,"wires":[["1ac5e83d.0f2988"],[]]},{"id":"c2174980.6fc3f8","type":"inject","z":"224ed2cb.a59cce","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":1029.4443626403809,"y":54.08727169036865,"wires":[["8e1ef25e.3674b"]]},{"id":"8e1ef25e.3674b","type":"function","z":"224ed2cb.a59cce","name":"with_1C","func":"//var order = msg.payload;\nvar regime_get1 = \n{\n  \"order_req\": 0,\n  \"route\": 0,\n  \"setpoint\": 0,\n  \"counterr\": 0\n  \n };\nmsg.payload = regime_get1;\nflow.set('regime_get1',regime_get1);\nflow.set('res2',msg.res);\nmsg.res = '';\nmsg.req = '';\nreturn msg;","outputs":"1","noerr":0,"x":1250.877052307129,"y":96.38248062133789,"wires":[["ff049575.727d48"]]},{"id":"ee5a97a.2042768","type":"http in","z":"224ed2cb.a59cce","name":"","url":"/k1_ed/status/data","method":"get","swaggerDoc":"","x":1003.587158203125,"y":96.1269474029541,"wires":[["8e1ef25e.3674b"]]},{"id":"d56e3994.9ef4a8","type":"function","z":"224ed2cb.a59cce","name":"R_5702_order_req","func":"msg.payload = { \n    'fc': 3, \n    'unitid': 1, \n    'address': 5702 , \n    'quantity': 1 \n} ;\nreturn msg;","outputs":1,"noerr":0,"x":1144.8610916137695,"y":195.19839191436768,"wires":[["80d8d1e5.1f575"]]},{"id":"1ac5e83d.0f2988","type":"function","z":"224ed2cb.a59cce","name":"conver_to int","func":"var buf = new ArrayBuffer(2);\nvar intView = new Uint16Array(buf);\nvar fltView = new Uint16Array(buf);\n\nintView[0] = msg.payload[0]; //low\nintView[1] = msg.payload[1]; //high\n\nmsg.payload = parseInt(fltView[0]);\n\nreturn msg;","outputs":1,"noerr":0,"x":1546.8055877685547,"y":192.9539556503296,"wires":[["b0fe87d.c72f378"]]},{"id":"b0fe87d.c72f378","type":"function","z":"224ed2cb.a59cce","name":"5703_route","func":"var regime_get1 = flow.get('regime_get1');\nregime_get1.order_req = msg.payload;\nflow.set('regime_get1',regime_get1);\n\nmsg.payload = { \n    'fc': 3, \n    'unitid': 1, \n    'address': 5703 , \n    'quantity': 1 \n    \n} ;\nreturn msg;","outputs":"1","noerr":0,"x":1125.730110168457,"y":238.32935619354248,"wires":[["676a9bdb.f618c4"]]},{"id":"676a9bdb.f618c4","type":"modbus-flex-getter","z":"224ed2cb.a59cce","name":"","showStatusActivities":false,"showErrors":false,"server":"eeebef8f.3d967","x":1323.7896194458008,"y":239.4246072769165,"wires":[["54b09bf4.520ac4"],[]]},{"id":"54b09bf4.520ac4","type":"function","z":"224ed2cb.a59cce","name":"conver_to int","func":"var buf = new ArrayBuffer(2);\nvar intView = new Uint16Array(buf);\nvar fltView = new Uint16Array(buf);\n\nintView[0] = msg.payload[0]; //low\nintView[1] = msg.payload[1]; //high\n\nmsg.payload = parseInt(fltView[0]);\n\nreturn msg;","outputs":1,"noerr":0,"x":1513.9484405517578,"y":238.6682448387146,"wires":[["6cdcdf00.34505"]]},{"id":"6cdcdf00.34505","type":"function","z":"224ed2cb.a59cce","name":"5704+1_Setpoint","func":"var regime_get1 = flow.get('regime_get1');\nregime_get1.route = msg.payload;\nflow.set('regime_get1',regime_get1);\n\nmsg.payload = { \n    'fc': 3, \n    'unitid': 1, \n    'address': 5704 , \n    'quantity': 2 \n    \n};\nreturn msg;","outputs":"1","noerr":0,"x":1131.5515594482422,"y":287.65080738067627,"wires":[["900eb9f3.a37d58"]]},{"id":"900eb9f3.a37d58","type":"modbus-flex-getter","z":"224ed2cb.a59cce","name":"","showStatusActivities":false,"showErrors":false,"server":"eeebef8f.3d967","x":1335.833152770996,"y":284.5833396911621,"wires":[["29599400.8a20dc"],[]]},{"id":"29599400.8a20dc","type":"function","z":"224ed2cb.a59cce","name":"conver_to float","func":"var buf = new ArrayBuffer(4);\nvar intView = new Uint16Array(buf);\nvar fltView = new Float32Array(buf);\n\nintView[0] = msg.payload[0]; //low\nintView[1] = msg.payload[1]; //high\n\nmsg.payload = parseFloat(fltView[0].toFixed(2));\n\nreturn msg;","outputs":1,"noerr":0,"x":1539.8135147094727,"y":280.4483690261841,"wires":[["e02d4348.80e83"]]},{"id":"e02d4348.80e83","type":"function","z":"224ed2cb.a59cce","name":"5706+1_Counterr_1v","func":"var regime_get = flow.get('regime_get1');\nregime_get1.setpoint = msg.payload;\nflow.set('regime_get1',regime_get1);\n\nmsg.payload = { \n    'fc': 3, \n    'unitid': 1, \n    'address': 5706 , \n    'quantity': 2 \n    \n} ;\nreturn msg;","outputs":"1","noerr":0,"x":1125.5873069763184,"y":332.40078830718994,"wires":[["5830f537.82946c"]]},{"id":"5830f537.82946c","type":"modbus-flex-getter","z":"224ed2cb.a59cce","name":"","showStatusActivities":false,"showErrors":false,"server":"eeebef8f.3d967","x":1343.3331985473633,"y":332.7976408004761,"wires":[["ca55ced3.e38aa"],[]]},{"id":"ca55ced3.e38aa","type":"function","z":"224ed2cb.a59cce","name":"conver_to float","func":"var buf = new ArrayBuffer(4);\nvar intView = new Uint16Array(buf);\nvar fltView = new Float32Array(buf);\n\nintView[0] = msg.payload[0]; //low\nintView[1] = msg.payload[1]; //high\n\nmsg.payload = parseFloat(fltView[0].toFixed(2));\n\nreturn msg;","outputs":1,"noerr":0,"x":1543.6351623535156,"y":325.9246234893799,"wires":[["6f1843ab.b6b9ec"]]},{"id":"6f1843ab.b6b9ec","type":"function","z":"224ed2cb.a59cce","name":"5751","func":"var regime_get1 = flow.get('regime_get1');\nregime_get1.counterr = msg.payload;\nflow.set('regime_get1',regime_get1);\n\n\nmsg.payload = { \n    'fc': 3, \n    'unitid': 1, \n    'address': 5751 , \n    'quantity': 1\n    \n} ;\nflow.set('res',msg.res);\nmsg.req = '';\nmsg.res = '';\nreturn msg;\n\n","outputs":1,"noerr":0,"x":1064.2857666015625,"y":392.85713958740234,"wires":[["2cf08bed.e04d34"]]},{"id":"2cf08bed.e04d34","type":"modbus-flex-getter","z":"224ed2cb.a59cce","name":"","showStatusActivities":false,"showErrors":false,"server":"eeebef8f.3d967","x":1330.4763107299805,"y":388.8095016479492,"wires":[["e1519ebc.3dc0c"],[]]},{"id":"e1519ebc.3dc0c","type":"function","z":"224ed2cb.a59cce","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":1502.002067565918,"y":423.3289375305176,"wires":[["41dbe33c.cd6e8c"]]},{"id":"ff049575.727d48","type":"function","z":"224ed2cb.a59cce","name":"response","func":"msg.res = flow.get('res2');\nmsg.payload = flow.get('regime_get1');\nreturn msg;","outputs":1,"noerr":0,"x":1406.9190254211426,"y":97.72170066833496,"wires":[["a9c95228.abb7c","44cbab3d.f24244"]]},{"id":"a9c95228.abb7c","type":"http response","z":"224ed2cb.a59cce","name":"","x":1538.2762184143066,"y":135.7099952697754,"wires":[]},{"id":"ce899440.0553d8","type":"debug","z":"224ed2cb.a59cce","name":"","active":true,"console":"false","complete":"payload","x":1785.8356628417969,"y":396.62649726867676,"wires":[]},{"id":"44cbab3d.f24244","type":"debug","z":"224ed2cb.a59cce","name":"","active":true,"console":"false","complete":"payload","x":1561.4287185668945,"y":99.99999046325684,"wires":[]},{"id":"41dbe33c.cd6e8c","type":"function","z":"224ed2cb.a59cce","name":"response","func":"msg.res = flow.get('res2');\nmsg.payload = flow.get('regime_get1');\nreturn msg;","outputs":1,"noerr":0,"x":1621.4285621643066,"y":460,"wires":[["90fd410e.b6f1b"]]},{"id":"90fd410e.b6f1b","type":"http response","z":"224ed2cb.a59cce","name":"","x":1758.4999885559082,"y":463.7025718688965,"wires":[]},{"id":"eeebef8f.3d967","type":"modbus-client","z":"","name":"","clienttype":"tcp","bufferCommands":true,"stateLogEnabled":false,"tcpHost":"192.168.5.201","tcpPort":"502","tcpType":"DEFAULT","serialPort":"/dev/ttyUSB","serialType":"RTU-BUFFERD","serialBaudrate":"9600","serialDatabits":"8","serialStopbits":"1","serialParity":"none","serialConnectionDelay":"100","unit_id":"1","commandDelay":"1","clientTimeout":"1000","reconnectTimeout":"2000"}]
