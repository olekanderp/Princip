[{"id":"2e903c22.f77534","type":"tab","label":"RFID UHF"},{"id":"9ef88788.dfecc8","type":"tab","label":"currentTags"},{"id":"4843531a.a50bac","type":"tab","label":"PostgreSql ","disabled":false,"info":""},{"id":"96e2ce02.2e68e","type":"tab","label":"Status devices","disabled":false,"info":""},{"id":"812a160b.c93e38","type":"tab","label":"80 тонн_вїзд","disabled":false,"info":""},{"id":"c7763c53.7c105","type":"tab","label":"80 тонн_виїзд","disabled":false,"info":""},{"id":"ad19a7b.79d5458","type":"tab","label":"60 тонн_вїзд","disabled":false,"info":"табло 2"},{"id":"ecb31b95.29a5e8","type":"tab","label":"60 тонн виїзд","disabled":false,"info":""},{"id":"bd734171.edc5f","type":"tab","label":"Dashboard","disabled":false,"info":""},{"id":"d5e818e4.8eb568","type":"tab","label":"Ваги","disabled":false,"info":""},{"id":"c2288546.fb7328","type":"princip-llrp-device","z":"","ipAddress":"10.3.5.214","port":"5084","log":false},{"id":"b41d0a4b.66efb8","type":"princip-llrp-device","z":"","ipAddress":"10.3.5.212","port":"5084","log":false},{"id":"dbfc505b.85972","type":"princip-llrp-device","z":"","ipAddress":"10.3.5.210","port":"5084","log":false},{"id":"6b7e777b.8252c8","type":"princip-llrp-device","z":"","ipAddress":"10.3.5.217","port":"5084","log":false},{"id":"db481aa7.26a878","type":"princip-llrp-device","z":"","ipAddress":"10.3.5.211","port":"5084","log":false},{"id":"bbf15f5e.1d626","type":"princip-llrp-device","z":"","ipAddress":"10.3.5.216","port":"5084","log":false},{"id":"b9948f4a.ce724","type":"princip-llrp-device","z":"","ipAddress":"10.3.5.215","port":"5084","log":false},{"id":"e3afc53a.234858","type":"postgresdb","z":"","hostname":"10.3.5.253","port":"5432","db":"rfid_log","ssl":false},{"id":"4ebb8212.ee120c","type":"postgresdb","z":"","hostname":"10.3.5.250","port":"5432","db":"rfid_log","ssl":false},{"id":"e45289df.8bbe98","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Kernel IoT  Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":4,"gy":4,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"76db46e9.4c9258","type":"ui_tab","z":"","name":"IoT Dasboard","icon":"Check state","disabled":false,"hidden":false},{"id":"4b6e8f48.bd669","type":"ui_group","z":"","name":"Check LLRP state","tab":"76db46e9.4c9258","disp":true,"width":"6","collapse":false},{"id":"8d2999c5.e54f18","type":"ui_group","z":"","name":"КПП 1","tab":"76db46e9.4c9258","disp":true,"width":"6","collapse":true},{"id":"84ef952b.8bf008","type":"ui_group","z":"","name":"КПП 2","tab":"76db46e9.4c9258","disp":true,"width":"6","collapse":false},{"id":"52d6b5ef.95d89c","type":"ui_group","z":"","name":"Службовий проїзд","tab":"76db46e9.4c9258","disp":true,"width":"6","collapse":false},{"id":"e9302090.7fc66","type":"ui_group","z":"","name":"Ваги 80 т.","tab":"76db46e9.4c9258","disp":true,"width":"6","collapse":false},{"id":"f00e6002.9fd61","type":"ui_group","z":"","name":"Ваги 60 т.","tab":"76db46e9.4c9258","disp":true,"width":"6","collapse":false},{"id":"4bf7e15a.661ae","type":"ui_group","z":"","name":"Лабораторія 1","tab":"76db46e9.4c9258","disp":true,"width":"6","collapse":false},{"id":"4f1a596d.afa5a8","type":"ui_group","z":"","name":"Лабораторія 2","tab":"76db46e9.4c9258","disp":true,"width":"6","collapse":false},{"id":"6ddf97e1.cb79a8","type":"ui_group","z":"","name":"80 тонн, в\"їзд","tab":"b48d64f3.407c98","order":1,"disp":true,"width":"6","collapse":false},{"id":"b48d64f3.407c98","type":"ui_tab","z":"","name":"Monitoring","icon":"dashboard","disabled":false,"hidden":false},{"id":"2d7e0681.e8843a","type":"ui_group","z":"","name":"80 тонн, виїзд","tab":"b48d64f3.407c98","disp":true,"width":"6","collapse":false},{"id":"d7af4cdd.f08d5","type":"ui_group","z":"","name":"60 тонн, в\"їзд","tab":"b48d64f3.407c98","disp":true,"width":"6","collapse":false},{"id":"fbbab3d2.f8787","type":"ui_group","z":"","name":"60 тонн, виїзд","tab":"b48d64f3.407c98","disp":true,"width":"6","collapse":false},{"id":"c4244328.9ca5b","type":"http in","z":"2e903c22.f77534","name":"","url":"/api/platform/setAccessTable","method":"post","upload":false,"swaggerDoc":"","x":160,"y":220,"wires":[["2110b02c.da661"]]},{"id":"2110b02c.da661","type":"function","z":"2e903c22.f77534","name":"set Access Table","func":"// var accessTable = [exampleAcess];\n// var exampleAcess = {\n//     \"pointID\":\"35235325325235\"\n//     \"ip\":\"10.3.5.210\",\n//     \"antennaID\":\"1\",\n//     \"direction\":0,\n//     \"tags\":[\"124124\",\"3525235\"],\n//     \"gpo\":['80','00'],\n//      \"marked\":false\n// }\n\nflow.set('accessTable',msg.payload);\nflow.set('accessTableUpdate',new Date());\nmsg.statusCode = 200;\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":240,"wires":[["f6676e50.0a1d9","17f3df8e.0ecdb"]]},{"id":"f6676e50.0a1d9","type":"http response","z":"2e903c22.f77534","name":"","x":630,"y":240,"wires":[]},{"id":"10132973.287767","type":"inject","z":"2e903c22.f77534","name":"init","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"x":110,"y":40,"wires":[["27672e17.061f42"]]},{"id":"27672e17.061f42","type":"function","z":"2e903c22.f77534","name":"LLRP conf","func":"//040300000012000001dd0000db0007000280 - 02 GPO index, 80 or 00 - on/off\nflow.set('sendGPO','040300000012000001dd0000db000700');\nflow.set('accessTable',[]);\nflow.set('getReaderConfig','0402000000110000012e00000900000000');\n\nreturn msg;","outputs":1,"noerr":0,"x":270,"y":20,"wires":[["7e86a773.ba0c98"]]},{"id":"6db18d2e.3887c4","type":"function","z":"2e903c22.f77534","name":"get row from Access Table","func":"var aT = msg.tempAccessTable;\nvar aTDate = flow.get('accessTableUpdate');\nvar nowDate = Date();\nvar diff = flow.get('actualDiff');\nvar finded = false;\n\nmsg.do = true;\n//if access table is not actual\nif (nowDate-aTDate > diff){\n    msg.do = false;\n}else{\nfor (var i = 0; i < aT.length; i++){\n    //if ((aT[i].ip === msg.ip)&&(Number(aT[i].antenna)===msg.tag.antennaID) && (aT[i].tags.indexOf(msg.tag.tagID) >= 0)&&!(aT[i].done)){\n    if ((aT[i].ip === msg.ip)&&(Number(aT[i].antenna)===msg.tag.antennaID) && (aT[i].tags.indexOf(msg.tag.tagID) >= 0)){\n        msg.accessTable = aT[i];\n        msg.aTLength = aT.length;\n        if ((aT[i].pointID != \"Неопределенно\")){\n            aT[i].done = true;\n        }\n        finded = true;\n        break;\n     }\n}\n}\nmsg.finded = finded;\nreturn msg;","outputs":1,"noerr":0,"x":720,"y":340,"wires":[["4d5e74e2.9dd1ac","e0a6f938.07b298"]]},{"id":"d24474bc.0103e8","type":"function","z":"2e903c22.f77534","name":"get IP","func":"\nmsg.tagID = msg.payload.data.tagID;\nmsg.tag   = msg.payload.data;\nmsg.antennaID = msg.payload.data.antennaID;\nmsg.tempAccessTable = JSON.parse(JSON.stringify(flow.get('accessTable')));\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":340,"wires":[["f6af5c82.542e4","9077ef16.6eb15","ffd26b62.135f68","8e0ba1ba.46ab2"]]},{"id":"9da02192.c56bf","type":"function","z":"2e903c22.f77534","name":"send GPO if Access","func":"var sendGPOtemplate = flow.get('sendGPO');\nvar cmd_temp = [];\nvar cmd = [{},{}]; \nvar cmd_open = '80';\nvar cmd_close = '00';\nvar finded = false;\n\nif (msg.accessTable){\n    var tags = msg.accessTable.tags;\n    \n    for (var i = 0; i < tags.length; i++){\n        if (tags[i] === msg.tagID){\n           \n            for(var j = 0; j < msg.accessTable.gpo.length; j++){\n                \n                temp_cmd = msg.accessTable.gpo[j].slice(-2);\n                \n                var new_cmd = {\n                    \"payload\":new Buffer(sendGPOtemplate+msg.accessTable.gpo[j],'hex'),\n                    \"ip\":msg.ip,\n                    \"cmd\":msg.accessTable.gpo[j],\n                    'tagID':msg.tag.tagID\n                    \n                };\n                \n                if(temp_cmd === cmd_open){\n                    cmd[0] = new_cmd;   \n                    \n                }else if(temp_cmd === cmd_close){\n                    cmd[1] = new_cmd;\n                }\n                \n            } \n            break;\n        } \n    }\n}\n\nreturn cmd;","outputs":2,"noerr":0,"x":1280,"y":380,"wires":[["50716944.cfe018","4b4245b8.380cdc","1d97c93c.518d07","792bd179.919c"],["e634e8e.882df18"]]},{"id":"587a2b62.9c1c64","type":"princip-llrp-out","z":"2e903c22.f77534","name":"217","device":"6b7e777b.8252c8","x":90,"y":360,"wires":[["c0d85f7d.c029a"]]},{"id":"aa006626.24bc98","type":"princip-llrp-in","z":"2e903c22.f77534","name":"217","device":"6b7e777b.8252c8","x":1590,"y":20,"wires":[]},{"id":"a85edc9d.95529","type":"function","z":"2e903c22.f77534","name":"send getReaderConfig LLRP message","func":"msg.payload = new Buffer(flow.get('getReaderConfig'),'hex');\nflow.set(msg.ip,null);\nreturn msg;","outputs":1,"noerr":0,"x":640,"y":700,"wires":[["278d9db.731a562","1d97c93c.518d07"]]},{"id":"6b03daa9.a68084","type":"switch","z":"2e903c22.f77534","name":"","property":"payload.type","propertyType":"msg","rules":[{"t":"eq","v":"getAccessReport","vt":"str"},{"t":"eq","v":"getReaderConfig","vt":"str"}],"checkall":"true","outputs":2,"x":350,"y":340,"wires":[["d24474bc.0103e8","629de05b.cf96f"],["b3b49218.3f4de"]]},{"id":"de9289c1.62e7b8","type":"http in","z":"2e903c22.f77534","name":"","url":"/api/platform/getReaderConfig","method":"get","upload":false,"swaggerDoc":"","x":140,"y":700,"wires":[["1890cfc4.63202"]]},{"id":"ebe890f5.455d3","type":"function","z":"2e903c22.f77534","name":"Waiting for LLRP response","func":"msg.statusCode = 200;\nmsg.payload = flow.get(msg.ip);\nreturn msg;","outputs":1,"noerr":0,"x":1180,"y":700,"wires":[["3f3c07b0.deb2e8"]]},{"id":"b68238d5.b3eb18","type":"http response","z":"2e903c22.f77534","name":"","x":1510,"y":720,"wires":[]},{"id":"b3b49218.3f4de","type":"function","z":"2e903c22.f77534","name":"get Reader config","func":"flow.set(msg.ip,msg.payload.data);\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":420,"wires":[["6bc6dd22.555064"]]},{"id":"278d9db.731a562","type":"delay","z":"2e903c22.f77534","name":"","pauseType":"delay","timeout":"150","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":910,"y":700,"wires":[["ebe890f5.455d3"]]},{"id":"da0e0d2d.c3ba3","type":"http in","z":"2e903c22.f77534","name":"","url":"/api/platform/setDefaultTable","method":"post","upload":false,"swaggerDoc":"","x":180,"y":280,"wires":[["e37c3465.1c0318"]]},{"id":"e37c3465.1c0318","type":"function","z":"2e903c22.f77534","name":"set default Table","func":"// var accessTable = [];\n// var exampleAcess = {\n//     \"ip\":\"10.3.5.210\",\n//     \"port\":5084,\n//     \"gpo\":['0180','0200']\n// }\n\nflow.set('accessTable',msg.payload);\nmsg.statusCode = 200;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":280,"wires":[["4e149eca.2616f"]]},{"id":"4e149eca.2616f","type":"http response","z":"2e903c22.f77534","name":"","x":630,"y":280,"wires":[]},{"id":"cec58ca7.83fdc","type":"link in","z":"9ef88788.dfecc8","name":"","links":["ffd26b62.135f68"],"x":35,"y":40,"wires":[["7d421dff.385864","f800bca0.6163f","f2aedd5d.80016","fc9b253d.77b8c8","17697a91.6b7095"]]},{"id":"7d421dff.385864","type":"function","z":"9ef88788.dfecc8","name":"","func":"var ip_name = msg.ip.replace(/\\./g,\"_\");\nvar rfidTags = flow.get(ip_name);\nvar allTags = flow.get('allTags');\n\nif (!allTags){\n    allTags = [];\n}\n\nif(!(rfidTags)){\n    rfidTags = [];\n}\n\nvar tag = {\n    \"ip_name\":ip_name,\n    \"ip\":msg.ip,\n    \"antennaID\":msg.tag.antennaID,\n    \"tagID\":msg.tag.tagID,\n    \"timestamp\":new Date(),\n    \"peakRSSI\":msg.tag.PeakRSSI\n}\n\nfindedAllTags = false;\nfor (var i = 0; i < allTags.length; i++){\n    if((allTags[i].tagID === tag.tagID) && ((allTags[i].antennaID === tag.antennaID))){\n         findedAllTags = true; \n         allTags[i] = tag;\n    }\n}\nif(!findedAllTags){\n    allTags.push(tag);\n}\n\nfinded = false;\nif (rfidTags){\n    for (var i = 0; i < rfidTags.length; i++){\n        if((rfidTags[i].tagID === tag.tagID) && ((rfidTags[i].antennaID === tag.antennaID))){\n         finded = true; \n         rfidTags[i] = tag;\n        }\n    }\n}\n\nif (!finded){\n    rfidTags.push(tag);   \n}\n\nflow.set(ip_name,rfidTags);\nflow.set(\"allTags\",allTags);\nmsg.payload = tag;\nmsg.ip_name = ip_name;\nreturn msg;","outputs":1,"noerr":0,"x":130,"y":40,"wires":[["c8af1b1c.7ccdf8","f3cb8f3e.bac25"]]},{"id":"ffd26b62.135f68","type":"link out","z":"2e903c22.f77534","name":"","links":["cec58ca7.83fdc"],"x":655,"y":380,"wires":[]},{"id":"c0d85f7d.c029a","type":"function","z":"2e903c22.f77534","name":"set IP","func":"msg.ip = \"10.3.5.217\";\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":360,"wires":[["6b03daa9.a68084"]]},{"id":"1d97c93c.518d07","type":"switch","z":"2e903c22.f77534","name":"","property":"ip","propertyType":"msg","rules":[{"t":"eq","v":"10.3.5.217","vt":"str"},{"t":"eq","v":"10.3.5.216","vt":"str"},{"t":"eq","v":"10.3.5.215","vt":"str"},{"t":"eq","v":"10.3.5.214","vt":"str"},{"t":"eq","v":"10.3.5.212","vt":"str"},{"t":"eq","v":"10.3.5.211","vt":"str"},{"t":"eq","v":"10.3.5.210","vt":"str"}],"checkall":"true","outputs":7,"x":1340,"y":140,"wires":[["aa006626.24bc98"],["123900e1.1300df"],["2884f.5111e7b1a"],["6b862b0b.c62fb4"],["83bf901b.cde65"],["40d11da3.8c75c4"],["86f4d188.d3743"]]},{"id":"75965e4a.28e01","type":"princip-llrp-out","z":"2e903c22.f77534","name":"216","device":"bbf15f5e.1d626","x":90,"y":400,"wires":[["e022cb06.bbdf78"]]},{"id":"e022cb06.bbdf78","type":"function","z":"2e903c22.f77534","name":"set IP","func":"msg.ip = \"10.3.5.216\";\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":400,"wires":[["6b03daa9.a68084"]]},{"id":"af48538.06b8db","type":"princip-llrp-out","z":"2e903c22.f77534","name":"215","device":"b9948f4a.ce724","x":90,"y":440,"wires":[["12c82f.a0e557d1"]]},{"id":"12c82f.a0e557d1","type":"function","z":"2e903c22.f77534","name":"set IP","func":"msg.ip = \"10.3.5.215\";\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":440,"wires":[["6b03daa9.a68084"]]},{"id":"9be104ae.0d7af8","type":"princip-llrp-out","z":"2e903c22.f77534","name":"214","device":"c2288546.fb7328","x":90,"y":480,"wires":[["3487464f.9bdc0a"]]},{"id":"3487464f.9bdc0a","type":"function","z":"2e903c22.f77534","name":"set IP","func":"msg.ip = \"10.3.5.214\";\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":480,"wires":[["6b03daa9.a68084"]]},{"id":"1aa3c300.db0bcd","type":"princip-llrp-out","z":"2e903c22.f77534","name":"212","device":"b41d0a4b.66efb8","x":90,"y":520,"wires":[["b56f815c.beb35"]]},{"id":"b56f815c.beb35","type":"function","z":"2e903c22.f77534","name":"set IP","func":"msg.ip = \"10.3.5.212\";\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":520,"wires":[["6b03daa9.a68084"]]},{"id":"241d8135.7cc34e","type":"princip-llrp-out","z":"2e903c22.f77534","name":"211","device":"db481aa7.26a878","x":90,"y":560,"wires":[["8f2e8c42.70bfa"]]},{"id":"8f2e8c42.70bfa","type":"function","z":"2e903c22.f77534","name":"set IP","func":"msg.ip = \"10.3.5.211\";\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":560,"wires":[["6b03daa9.a68084"]]},{"id":"bd7cf3f.c318a1","type":"princip-llrp-out","z":"2e903c22.f77534","name":"210","device":"dbfc505b.85972","x":90,"y":600,"wires":[["a55f9469.47cae8"]]},{"id":"a55f9469.47cae8","type":"function","z":"2e903c22.f77534","name":"set IP","func":"msg.ip = \"10.3.5.210\";\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":600,"wires":[["6b03daa9.a68084"]]},{"id":"123900e1.1300df","type":"princip-llrp-in","z":"2e903c22.f77534","name":"216","device":"bbf15f5e.1d626","x":1590,"y":60,"wires":[]},{"id":"2884f.5111e7b1a","type":"princip-llrp-in","z":"2e903c22.f77534","name":"215","device":"b9948f4a.ce724","x":1590,"y":100,"wires":[]},{"id":"6b862b0b.c62fb4","type":"princip-llrp-in","z":"2e903c22.f77534","name":"214","device":"c2288546.fb7328","x":1590,"y":140,"wires":[]},{"id":"83bf901b.cde65","type":"princip-llrp-in","z":"2e903c22.f77534","name":"212","device":"b41d0a4b.66efb8","x":1590,"y":180,"wires":[]},{"id":"40d11da3.8c75c4","type":"princip-llrp-in","z":"2e903c22.f77534","name":"211","device":"db481aa7.26a878","x":1590,"y":220,"wires":[]},{"id":"86f4d188.d3743","type":"princip-llrp-in","z":"2e903c22.f77534","name":"210","device":"dbfc505b.85972","x":1590,"y":260,"wires":[]},{"id":"da1c65a.88aa298","type":"http in","z":"9ef88788.dfecc8","name":"","url":"/api/platform/getTag","method":"get","upload":false,"swaggerDoc":"","x":130,"y":80,"wires":[["4f4087f4.f215e8"]]},{"id":"4f4087f4.f215e8","type":"function","z":"9ef88788.dfecc8","name":"","func":"var rfidID    = msg.req.query.rfidID.replace(/\\./g,\"_\");\nvar antennaID = msg.req.query.antennaID;\n\nif(antennaID){\n    antennaID = Number(antennaID);\n}\n\nvar tags = [];\nvar rfidTags = flow.get(rfidID);\n\nvar currentDate = new Date();\nvar difference  = 4000;\n\nif(rfidTags){\nfor (var i = rfidTags.length-1; i >=0; i--){\n    \n   if((rfidTags[i].antennaID===antennaID)&&((currentDate - rfidTags[i].timestamp) <= difference)){\n        tags.push({\n            'tagID':rfidTags[i].tagID,\n            'PeakRSSI':rfidTags[i].PeakRSSI,\n            'tagLastSeen':rfidTags[i].timestamp,\n            'currentDate':currentDate,\n            'diff':currentDate-rfidTags[i].timestamp\n            \n        });\n        \n    }\n}\n}\nmsg.payload = tags;\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":80,"wires":[["65e8e5b7.faa0ec"]]},{"id":"65e8e5b7.faa0ec","type":"http response","z":"9ef88788.dfecc8","name":"","x":470,"y":80,"wires":[]},{"id":"c8af1b1c.7ccdf8","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"console":false,"complete":"payload","x":610,"y":116,"wires":[]},{"id":"12268aa6.415875","type":"http in","z":"2e903c22.f77534","name":"","url":"/api/platform/setReaderConfig","method":"post","upload":false,"swaggerDoc":"","x":660,"y":40,"wires":[["7b716f64.4ad0b","a2bcf0dd.977fe","72f5a2d6.ee39bc"]]},{"id":"7b716f64.4ad0b","type":"function","z":"2e903c22.f77534","name":"","func":"var gpo_cmd = msg.payload.cmd;\nvar sendGPO = flow.get('sendGPO');\nmsg.ip      = msg.req.query.rfidID;\nmsg.payload = new Buffer(sendGPO+gpo_cmd,'hex');\nmsg.cmd = gpo_cmd.slice(-2);\nreturn msg;","outputs":"1","noerr":0,"x":910,"y":60,"wires":[["9fb57c8a.a08d7"]]},{"id":"a2bcf0dd.977fe","type":"http response","z":"2e903c22.f77534","name":"","x":910,"y":100,"wires":[]},{"id":"5ef9860f.fbc278","type":"inject","z":"9ef88788.dfecc8","name":"","topic":"","payload":"10_3_5_210","payloadType":"flow","repeat":"","crontab":"","once":false,"x":120,"y":160,"wires":[["8e4fc3e7.43e63"]]},{"id":"8e4fc3e7.43e63","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"console":"false","complete":"false","x":290,"y":160,"wires":[]},{"id":"73c98008.e27d1","type":"inject","z":"9ef88788.dfecc8","name":"","topic":"","payload":"allTags","payloadType":"flow","repeat":"","crontab":"","once":false,"x":110,"y":200,"wires":[["39e0495d.0dc666"]]},{"id":"39e0495d.0dc666","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"console":"false","complete":"false","x":290,"y":200,"wires":[]},{"id":"3a48f87.8773e08","type":"inject","z":"9ef88788.dfecc8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":100,"y":240,"wires":[["d2068014.791dc"]]},{"id":"d2068014.791dc","type":"function","z":"9ef88788.dfecc8","name":"","func":"flow.set(\"allTags\",[]);\nreturn msg;","outputs":1,"noerr":0,"x":270,"y":240,"wires":[[]]},{"id":"5410fb15.1b1a04","type":"http in","z":"9ef88788.dfecc8","name":"","url":"/api/platform/getAllTags","method":"get","upload":false,"swaggerDoc":"","x":140,"y":120,"wires":[["93062f26.ade07"]]},{"id":"93062f26.ade07","type":"function","z":"9ef88788.dfecc8","name":"","func":"var allTags = flow.get(\"allTags\");\nvar tags    = [];\nvar currentDate = new Date();\nvar difference  = 4000;\n\nif(allTags){\nfor (var i = allTags.length-1; i >=0; i--){\n    \n   if(((currentDate - allTags[i].timestamp) <= difference)){\n        tags.push({\n            \"ip\":allTags[i].ip,\n            \"antenna\":allTags[i].antennaID,\n            'tagID':allTags[i].tagID,\n            'PeakRSSI':allTags[i].PeakRSSI,\n            'tagLastSeen':allTags[i].timestamp,\n            'currentDate':currentDate,\n            'diff':currentDate-allTags[i].timestamp\n        });\n        \n    }\n}\n}\nmsg.payload = tags;\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":120,"wires":[["69955c64.e416e4","f0fa9e80.66a5b"]]},{"id":"69955c64.e416e4","type":"http response","z":"9ef88788.dfecc8","name":"","x":470,"y":120,"wires":[]},{"id":"484e26a.d99e6d8","type":"inject","z":"2e903c22.f77534","name":"","topic":"","payload":"puller","payloadType":"flow","repeat":"","crontab":"","once":false,"onceDelay":"","x":100,"y":780,"wires":[["beab8dd9.67eb"]]},{"id":"4d5e74e2.9dd1ac","type":"switch","z":"2e903c22.f77534","name":"do","property":"do","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":930,"y":340,"wires":[["fd19fb67.660488"]]},{"id":"f0fa9e80.66a5b","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"console":"false","complete":"false","x":490,"y":160,"wires":[]},{"id":"f3cb8f3e.bac25","type":"function","z":"9ef88788.dfecc8","name":"","func":"var tag = msg.payload;\nmsg = {\n  \"payload\":tag \n}\n\nreturn msg;","outputs":1,"noerr":0,"x":326,"y":41,"wires":[["73f46c11.77fdf4"]]},{"id":"73f46c11.77fdf4","type":"template","z":"9ef88788.dfecc8","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"INSERT INTO public.taglogs(ip, tagid, antenna, diff, peakrssi, lasttimeSeen) VALUES ('{{payload.ip}}', '{{payload.tagID}}','{{payload.antennaID}}', 0,{{payload.peakRSSI}}, now())","x":459,"y":41,"wires":[[]]},{"id":"bb92dbd6.d27e08","type":"inject","z":"2e903c22.f77534","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":93.5,"y":840,"wires":[["d86d4176.ad823"]]},{"id":"d86d4176.ad823","type":"function","z":"2e903c22.f77534","name":"get row from Access Table","func":"var aT = flow.get('accessTable');\nvar aTDate = flow.get('accessTableUpdate');\nvar nowDate = Date();\nvar diff = 2000;\n\nmsg.do = true;\n//if access table is not actual\nif (nowDate-aTDate > diff){\n    msg.do = false;\n}else{\nfor (var i = 0; i < aT.length; i++){\n    if ((aT[i].ip === msg.ip)&&Number(aT[i].antenna)===msg.tag.antennaID){\n        msg.accessTable = aT[i];\n        msg.aTLength = aT.length;\n        break;\n     }\n}\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":294,"y":840,"wires":[["beab8dd9.67eb"]]},{"id":"7e86a773.ba0c98","type":"function","z":"2e903c22.f77534","name":"TB conf","func":"var devTokens = {\n    \"10.3.5.210\":\"JBhPbXOIurjYtactEULG\",\n\"10.3.5.211\":\"wUalPuK6AjterGIkukel\",\n\"10.3.5.214\":\"4lvWYttSbqXtqJi5f4zR\",\n\"10.3.5.215\":\"D0nQSqXFsTPywQ4L4Bpo\",\n\"10.3.5.216\":\"lJISUdDHKj9PNl2WIFpQ\",\n\"10.3.5.217\":\"RVdgJEDzY2NJvYMkFVB9\",\n\"10.3.5.212\":\"uGq9E2Vq9cnIyrCMx5mX\"\n};\nflow.set('devTokens',devTokens);\nflow.set('hostTB',\"10.3.5.223\");\nflow.set('portTB',\"8080\");\n\nreturn msg;","outputs":1,"noerr":0,"x":260,"y":80,"wires":[["98956c1c.8e513"]]},{"id":"f6af5c82.542e4","type":"function","z":"2e903c22.f77534","name":"send to TB","func":"var devTokens = flow.get('devTokens');\nmsg.url = \"http://\"+flow.get('hostTB')+\":\"+flow.get('portTB')+\"/api/v1/\"+devTokens[msg.ip]+\"/telemetry\";\nmsg.payload = msg.tag;\nmsg.payload.lastSeenTimestampUTC = new Date();\nmsg.payload.ip = msg.ip;\n\nreturn msg;","outputs":1,"noerr":0,"x":620,"y":480,"wires":[[]]},{"id":"3d502f87.6302b","type":"function","z":"2e903c22.f77534","name":"send to 1C","func":"msg.url = flow.get('host1C');\nmsg.tag.lastSeenTimestampUTC = new Date();\nmsg.tag.ip = msg.ip;\nmsg.tag.antenna = msg.tag.antennaID;\nmsg.tag.direction = 'IN';\nmsg.payload = [msg.tag];\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":620,"wires":[["e05be75c.b90f28","77255bc4.9f19e4"]]},{"id":"e05be75c.b90f28","type":"http request","z":"2e903c22.f77534","name":"to 1C","method":"POST","ret":"txt","url":"","tls":"","x":830,"y":620,"wires":[["d22e867.8a1c478"]]},{"id":"98956c1c.8e513","type":"function","z":"2e903c22.f77534","name":"1C conf","func":"//var host1C = \"http://s-app-mir-test/rfid_mir_test/hs/PerimeterControl/api/PrincipNodeRed/getTags\";\nvar host1C = \"http://s-app-mir/UE_mir/hs/PerimeterControl/api/PrincipNodeRed/getTags\";\nflow.set('host1C',host1C);\nflow.set('actualDiff',86900); //сколько секунда таблица доступа актуальна\nmsg.url = host1C;\nflow.set('puller',[]);\nflow.set('puller_timeout_sec',15);\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":80,"wires":[["87ad8170.e587f"]]},{"id":"e634e8e.882df18","type":"delay","z":"2e903c22.f77534","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1490,"y":380,"wires":[["1d97c93c.518d07","50716944.cfe018"]]},{"id":"f800bca0.6163f","type":"function","z":"9ef88788.dfecc8","name":"","func":"msg.payload = msg.tag;\nmsg.payload.lastSeenTimestampUTC = new Date();\nmsg.payload.ip = msg.ip;\nreturn msg;","outputs":1,"noerr":0,"x":160,"y":340,"wires":[["1e7183ff.1ad5cc","1e0fab7c.1ac375"]]},{"id":"1783efb4.d19ac","type":"postgres","z":"9ef88788.dfecc8","postgresdb":"e3afc53a.234858","name":"rfid_log","output":true,"outputs":1,"x":740,"y":760,"wires":[["c54ab09c.aa8fb"]]},{"id":"ea521376.d2938","type":"template","z":"9ef88788.dfecc8","name":"query field1","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"INSERT INTO thingsboard(\n            lastSeenTimestampUTC,antennaID,tagID,tagSeenCount,PeakRSSI,ip)\n    VALUES ($param1,$param2,$param3,$param4,$param5,$param6);","x":570,"y":760,"wires":[["1783efb4.d19ac"]]},{"id":"1e0fab7c.1ac375","type":"function","z":"9ef88788.dfecc8","name":"setup params","func":"\n\nmsg.queryParameters = msg.queryParameters || {};\nmsg.queryParameters.param1 = msg.payload.lastSeenTimestampUTC;\nmsg.queryParameters.param2 = msg.payload.antennaID;\nmsg.queryParameters.param3 = msg.payload.tagID;\nmsg.queryParameters.param4 = msg.payload.tagSeenCount;\nmsg.queryParameters.param5 = msg.payload.PeakRSSI;\nmsg.queryParameters.param6 = msg.payload.ip;\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":760,"wires":[["ea521376.d2938"]]},{"id":"c54ab09c.aa8fb","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":890,"y":760,"wires":[]},{"id":"a927e9d7.325cf8","type":"comment","z":"9ef88788.dfecc8","name":"Записати дані в таблицю для РФІД Антен","info":"","x":470,"y":720,"wires":[]},{"id":"1e7183ff.1ad5cc","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":330,"y":360,"wires":[]},{"id":"f2aedd5d.80016","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":330,"y":300,"wires":[]},{"id":"72f5a2d6.ee39bc","type":"function","z":"2e903c22.f77534","name":"","func":"msg.payload.ip = msg.req.query.rfidID;\nmsg.payload.event_name = \"Отправка команды \";\nmsg.payload.event_desc = msg.payload.event_name+\" \"+msg.payload.ip+\" \"+msg.payload.cmd;\nmsg.tagID = flow.get(msg.req.query.rfidID);\nreturn msg;","outputs":1,"noerr":0,"x":910,"y":20,"wires":[["d020626d.13d02"]]},{"id":"357b487.368c6b8","type":"link in","z":"9ef88788.dfecc8","name":"send event","links":["d020626d.13d02"],"x":175,"y":480,"wires":[["af3faeb7.af28a","abc7a47a.2f35e8"]]},{"id":"d020626d.13d02","type":"link out","z":"2e903c22.f77534","name":"","links":["357b487.368c6b8"],"x":1055,"y":20,"wires":[]},{"id":"af3faeb7.af28a","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":430,"y":480,"wires":[]},{"id":"d2572e91.9daab","type":"postgres","z":"9ef88788.dfecc8","postgresdb":"e3afc53a.234858","name":"rfid_log","output":true,"outputs":1,"x":740,"y":580,"wires":[["3743e17.b32bf1e"]]},{"id":"3743e17.b32bf1e","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":870,"y":580,"wires":[]},{"id":"a71e9269.c6ca8","type":"inject","z":"4843531a.a50bac","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":140,"wires":[["ee610f4f.6be98"]]},{"id":"ee610f4f.6be98","type":"template","z":"4843531a.a50bac","name":"CREATE TABLE","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"CREATE TABLE event_table\n(\n    Event_name character varying,\n    Event_description character varying,\n    IP character varying,\n    Command character varying\n\n)","x":350,"y":140,"wires":[["2e283965.7cf456"]]},{"id":"4174a612.747a68","type":"inject","z":"4843531a.a50bac","name":"trigger","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":130,"y":220,"wires":[["a3692f5d.5a39b"]]},{"id":"a3692f5d.5a39b","type":"template","z":"4843531a.a50bac","name":"format query","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"select * from event_table ","x":330,"y":220,"wires":[["2e283965.7cf456"]]},{"id":"2e283965.7cf456","type":"postgres","z":"4843531a.a50bac","postgresdb":"e3afc53a.234858","name":"rfid_log","output":true,"outputs":1,"x":580,"y":180,"wires":[["4b999abd.d74014"]]},{"id":"adca34a8.a0a508","type":"comment","z":"4843531a.a50bac","name":"створена таблиця івентів ","info":"","x":290,"y":100,"wires":[]},{"id":"23f6caa9.e29f76","type":"comment","z":"4843531a.a50bac","name":"читаєм таблицю івентів","info":"","x":290,"y":180,"wires":[]},{"id":"80df38a5.8d6178","type":"comment","z":"9ef88788.dfecc8","name":"Відправка даних на таблицю івентів","info":"","x":450,"y":540,"wires":[]},{"id":"4982de7f.d82ce","type":"comment","z":"4843531a.a50bac","name":"прочитати дані таблиці  РФІД Антен","info":"","x":230,"y":440,"wires":[]},{"id":"49d6c5c8.1d2dbc","type":"inject","z":"4843531a.a50bac","name":"trigger","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":130,"y":480,"wires":[["6c08ef5b.54722"]]},{"id":"6c08ef5b.54722","type":"template","z":"4843531a.a50bac","name":"format query","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"select * from thingsboard limit 100","x":370,"y":480,"wires":[["c2d62544.5a8188"]]},{"id":"c8cf3554.f96708","type":"comment","z":"4843531a.a50bac","name":"створена таблиця для РФІД Антен","info":"","x":240,"y":360,"wires":[]},{"id":"c2d62544.5a8188","type":"postgres","z":"4843531a.a50bac","postgresdb":"e3afc53a.234858","name":"rfid_log","output":true,"outputs":1,"x":580,"y":400,"wires":[["346f9e97.ab6792"]]},{"id":"346f9e97.ab6792","type":"debug","z":"4843531a.a50bac","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":750,"y":400,"wires":[]},{"id":"4d5bdff8.447b","type":"template","z":"4843531a.a50bac","name":"CREATE TABLE","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"CREATE TABLE thingsboard\n(\n    lastSeenTimestampUTC character varying,\n    antennaID INTEGER,\n    tagID character varying,\n    tagSeenCount INTEGER,\n    PeakRSSI INTEGER,\n    ip character varying\n\n)","x":330,"y":400,"wires":[["c2d62544.5a8188"]]},{"id":"65ea216.4ba4de","type":"inject","z":"4843531a.a50bac","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":400,"wires":[["4d5bdff8.447b"]]},{"id":"4b999abd.d74014","type":"debug","z":"4843531a.a50bac","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":730,"y":180,"wires":[]},{"id":"87ad8170.e587f","type":"http request","z":"2e903c22.f77534","name":"","method":"GET","ret":"txt","url":"","tls":"","x":350,"y":140,"wires":[["511306fb.842018","f97190e1.97841","43a46e52.d4b46"]]},{"id":"511306fb.842018","type":"function","z":"2e903c22.f77534","name":"set Access Table","func":"flow.set('accessTable',JSON.parse(msg.payload));\nflow.set('accessTableUpdate',new Date());\nreturn msg;","outputs":1,"noerr":0,"x":630,"y":120,"wires":[[]]},{"id":"9e27c9a2.2083c8","type":"inject","z":"4843531a.a50bac","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":40,"wires":[["16ad8cc0.c5f853"]]},{"id":"16ad8cc0.c5f853","type":"template","z":"4843531a.a50bac","name":" add colon","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"ALTER TABLE event_table\nADD COLUMN lastSeenTimestampUTC CHARACTER VARYING;","x":340,"y":40,"wires":[["a1fd0388.21225","2e283965.7cf456"]]},{"id":"a1fd0388.21225","type":"debug","z":"4843531a.a50bac","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":40,"wires":[]},{"id":"abc7a47a.2f35e8","type":"function","z":"9ef88788.dfecc8","name":"setup params","func":"var cmd_str_f_ch = msg.payload.cmd;\n    cmd_str_f_ch = cmd_str_f_ch.substring(0,2);\nvar cmd_str_f_cmd = msg.payload.cmd\n    cmd_str_f_cmd = cmd_str_f_cmd.substring(2,5);\n\n\nmsg.queryParameters = msg.queryParameters || {};\nmsg.queryParameters.param1 = msg.payload.event_name;\nmsg.queryParameters.param2 = msg.payload.event_desc;\nmsg.queryParameters.param3 = msg.payload.ip;\nmsg.queryParameters.param4 = cmd_str_f_cmd;\nmsg.queryParameters.param5 = new Date();\nmsg.queryParameters.param6 = cmd_str_f_ch;\nmsg.queryParameters.param7 = new Date();\nmsg.queryParameters.param8 = msg.tagID;\n\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":640,"wires":[["5b41a5e3.1fb1fc"]]},{"id":"5b41a5e3.1fb1fc","type":"template","z":"9ef88788.dfecc8","name":"query field1","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"INSERT INTO event_table(\n             Event_name,Event_description,IP,Command,lastSeenTimestampUTC,channel,date_time,tag)\n    VALUES ($param1,$param2,$param3,$param4,$param5,$param6,$param7,$param8);","x":570,"y":640,"wires":[["8a157269.5b365","d2572e91.9daab"]]},{"id":"d268a250.da404","type":"template","z":"4843531a.a50bac","name":"format query вибірка","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"SELECT * FROM event_table\nLIMIT 10 OFFSET 0;","x":340,"y":260,"wires":[["2e283965.7cf456"]]},{"id":"f0216051.cfd21","type":"inject","z":"4843531a.a50bac","name":"trigger","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":110,"y":260,"wires":[["d268a250.da404"]]},{"id":"d22e867.8a1c478","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1130,"y":620,"wires":[]},{"id":"fc9b253d.77b8c8","type":"function","z":"9ef88788.dfecc8","name":"80t","func":"var tag_ip = msg.ip;\n//msg.payload = tag_ip;\nvar ID = msg.tagID;\nif(tag_ip == \"10.3.5.217\"){\n  msg.payload =  ID;  \n}else{\n  msg.payload =  5;  \n    \n}\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":300,"wires":[["ee87d1ff.40f94","d6842c99.7d71b"]]},{"id":"17697a91.6b7095","type":"function","z":"9ef88788.dfecc8","name":"60t","func":"var tag_ip = msg.ip;\n//msg.payload = tag_ip;\nvar ID = msg.tagID;\nif(tag_ip == \"10.3.5.212\"){\n  msg.payload =  ID;  \n}else{\n  msg.payload =  5;  \n    \n}\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":260,"wires":[["c3b00b70.3983d8"]]},{"id":"c3b00b70.3983d8","type":"switch","z":"9ef88788.dfecc8","name":"","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"5","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":670,"y":260,"wires":[["425681b5.7e627"]]},{"id":"ee87d1ff.40f94","type":"switch","z":"9ef88788.dfecc8","name":"","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"5","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":670,"y":300,"wires":[["9647502f.c4f64"]]},{"id":"92aff750.ea7e28","type":"tcp out","z":"9ef88788.dfecc8","host":"","port":"4003","beserver":"server","base64":false,"end":false,"name":"","x":980,"y":300,"wires":[]},{"id":"187de7f.2312c18","type":"tcp out","z":"9ef88788.dfecc8","host":"","port":"4004","beserver":"server","base64":false,"end":false,"name":"","x":980,"y":260,"wires":[]},{"id":"425681b5.7e627","type":"delay","z":"9ef88788.dfecc8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":820,"y":260,"wires":[["187de7f.2312c18"]]},{"id":"9647502f.c4f64","type":"delay","z":"9ef88788.dfecc8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":820,"y":300,"wires":[["92aff750.ea7e28"]]},{"id":"d6842c99.7d71b","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":730,"y":340,"wires":[]},{"id":"8a157269.5b365","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":710,"y":660,"wires":[]},{"id":"9077ef16.6eb15","type":"function","z":"2e903c22.f77534","name":"Filling Puller","func":"var puller = flow.get('puller');\nvar puller_timeout_sec = flow.get('puller_timeout_sec');\nvar current_element = {\n    'ip':msg.ip,\n    'tagID':msg.tagID,\n    'antennaID':msg.tag.antennaID,\n    'lastSeenTimestampUTC':new Date()\n}\nvar pull = true;\nvar finded = false\nfor (var i = 0; i < puller.length; i++){\n    var element = puller[i];\n    if ((element.ip === current_element.ip)&&(element.tagID===current_element.tagID)&&(element.antennaID===current_element.antennaID)){\n        var diff = (current_element.lastSeenTimestampUTC-element.lastSeenTimestampUTC)/1000;\n        if (diff < puller_timeout_sec){\n            pull = false; \n        }else{\n            puller[i]=current_element;\n        }\n        finded = true;\n    }\n}\nif (!finded){\n    puller.push(current_element);\n}\n\nflow.set('puller',puller);\nmsg.pull = pull;\nmsg.diff = diff;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":500,"wires":[["ef15917b.7d65a","7ba19641.bbdc48","8f435d78.0434"]]},{"id":"8f435d78.0434","type":"switch","z":"2e903c22.f77534","name":"","property":"pull","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":480,"y":600,"wires":[["3d502f87.6302b","6db18d2e.3887c4","933916fb.2194e8","b935733.1287d9"]]},{"id":"629de05b.cf96f","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":610,"y":520,"wires":[]},{"id":"beab8dd9.67eb","type":"debug","z":"2e903c22.f77534","name":"","active":false,"console":"false","complete":"false","x":490,"y":780,"wires":[]},{"id":"43a46e52.d4b46","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":630,"y":160,"wires":[]},{"id":"17f3df8e.0ecdb","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":600,"y":200,"wires":[]},{"id":"f97190e1.97841","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":670,"y":80,"wires":[]},{"id":"32992367.10de4c","type":"function","z":"2e903c22.f77534","name":"check rule to SOVA event","func":"var ChannelNumber = null;\nvar Type = null;\nvar truck1 = 'не визначено';\nvar truck2 = 'не визначено';\n\nif((msg.ip === '10.3.5.210')&&(msg.antennaID==1)){\n    //въезд КПП 1\n    ChannelNumber = 5;\n    Type = 'TruckIn';\n}else if ((msg.ip === '10.3.5.216')&&(msg.antennaID==1)){\n    //въезд КПП 2\n    ChannelNumber = 7;\n    Type = 'TruckIn';\n}else if ((msg.ip === '10.3.5.210')&&(msg.antennaID==2)){\n    //выезд КПП 1\n    ChannelNumber = 5;\n    Type = 'TruckOut';\n}else if ((msg.ip === '10.3.5.216')&&(msg.antennaID==2)){\n    //выезд КПП 2\n    ChannelNumber = 7;\n    Type = 'TruckOut';\n}\n\n//получим по метка номер транспорта\n// \"tags_data\": [\n// {\n// \"tag\": \"e20000161708017526200fb5\",\n// \"truck_number\": \"БЕЗНОМЕРА3\",\n// \"truck_number2\": \"\",\n// \"waybill_number\": \"\"\n// },\n// {\n// \"tag\": \"e200001b290902701840ecb3\",\n// \"truck_number\": \"СЛУЖБТЕСТ\",\n// \"truck_number2\": \"\",\n// \"waybill_number\": \"\"\n// }\n// ]\nmsg.ChannelNumber = ChannelNumber;\nmsg.Type = Type;\nvar aT = flow.get('accessTable');\nfor (var i = 0; i < aT.length; i++){\n    var tags_data = aT[i].tags_data;\n    for (var j = 0; j < tags_data.length; j++){\n        if (tags_data[j].tag === msg.tagID){\n            truck1 = tags_data[j].truck_number;\n            truck2 = tags_data[j].truck_number2;\n        }        \n    }\n}\nmsg.truck1 = truck1;\nmsg.truck2 = truck2;\n\nmsg.payload = {\"truck1\": truck1, \n                \"ObjectID\": \"1001\", \n                \"truck2\": truck2,\n                \"Value\": \"test\",\n                \"ChannelNumber\": ChannelNumber, \n                \"Type\": Type};\nreturn msg;","outputs":1,"noerr":0,"x":960,"y":480,"wires":[["d79d90cb.4de4d"]]},{"id":"1f1ddfc6.81c56","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1390,"y":480,"wires":[]},{"id":"933916fb.2194e8","type":"switch","z":"2e903c22.f77534","name":"Въезд - выезд","property":"ip","propertyType":"msg","rules":[{"t":"eq","v":"10.3.5.210","vt":"str"},{"t":"eq","v":"10.3.5.216","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":940,"y":420,"wires":[["32992367.10de4c"],["32992367.10de4c"]]},{"id":"d79d90cb.4de4d","type":"http request","z":"2e903c22.f77534","name":"","method":"POST","ret":"txt","url":"http://10.45.1.60:8081/event","tls":"","x":1190,"y":480,"wires":[["1f1ddfc6.81c56"]]},{"id":"e185f9a3.38ca08","type":"http in","z":"2e903c22.f77534","name":"","url":"/api/platform/getAccessTable","method":"get","upload":false,"swaggerDoc":"","x":140,"y":940,"wires":[["42c0c525.8eecbc"]]},{"id":"42c0c525.8eecbc","type":"function","z":"2e903c22.f77534","name":"get Access Table","func":"msg.payload = flow.get('accessTable');\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":940,"wires":[["68b4048a.4a001c"]]},{"id":"68b4048a.4a001c","type":"http response","z":"2e903c22.f77534","name":"","statusCode":"","headers":{},"x":560,"y":940,"wires":[]},{"id":"6bc6dd22.555064","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":710,"y":420,"wires":[]},{"id":"abf7107c.1ebd7","type":"comment","z":"96e2ce02.2e68e","name":"GPI state & antenna state","info":"","x":210,"y":180,"wires":[]},{"id":"1890cfc4.63202","type":"function","z":"2e903c22.f77534","name":"set msg.ip","func":"msg.ip = msg.ip = msg.req.query.rfidID;\nmsg.local = false;\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":700,"wires":[["a85edc9d.95529"]]},{"id":"572b42cd.cfbf7c","type":"link in","z":"2e903c22.f77534","name":"get Config","links":["b549ef2b.260b3"],"x":335,"y":620,"wires":[["a85edc9d.95529"]]},{"id":"4b2607e.52171f8","type":"link out","z":"2e903c22.f77534","name":"get config response","links":["56f3391c.5a7c08"],"x":1475,"y":660,"wires":[]},{"id":"3ec4c753.cd5b98","type":"inject","z":"96e2ce02.2e68e","name":"КПП №1","topic":"","payload":"10.3.5.210","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":220,"wires":[["83c44fe1.44712"]]},{"id":"83c44fe1.44712","type":"function","z":"96e2ce02.2e68e","name":"set msg.ip","func":"msg.ip = msg.payload;\nmsg.local = true;\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":320,"wires":[["b549ef2b.260b3"]]},{"id":"b549ef2b.260b3","type":"link out","z":"96e2ce02.2e68e","name":"","links":["572b42cd.cfbf7c"],"x":515,"y":320,"wires":[]},{"id":"56f3391c.5a7c08","type":"link in","z":"96e2ce02.2e68e","name":"","links":["4b2607e.52171f8"],"x":395,"y":420,"wires":[["1c43653f.3949bb"]]},{"id":"5789b391.a07b7c","type":"inject","z":"96e2ce02.2e68e","name":"КПП №2","topic":"","payload":"10.3.5.216","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":260,"wires":[["83c44fe1.44712"]]},{"id":"48ccc849.545d28","type":"inject","z":"96e2ce02.2e68e","name":"Службовий проїзд","topic":"","payload":"10.3.5.211","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":210,"y":300,"wires":[["83c44fe1.44712"]]},{"id":"60843f51.0000c","type":"inject","z":"96e2ce02.2e68e","name":"Ваги 80 тонн","topic":"","payload":"10.3.5.217","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":340,"wires":[["83c44fe1.44712"]]},{"id":"88b516d1.0a5ae8","type":"inject","z":"96e2ce02.2e68e","name":"Ваги 60 тонн","topic":"","payload":"10.3.5.212","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":380,"wires":[["83c44fe1.44712"]]},{"id":"54219b78.cd6be4","type":"inject","z":"96e2ce02.2e68e","name":"Лабораторія 1","topic":"","payload":"10.3.5.214","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":420,"wires":[["83c44fe1.44712"]]},{"id":"899f3006.0f285","type":"inject","z":"96e2ce02.2e68e","name":"Лабораторія 2","topic":"","payload":"10.3.5.215","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":460,"wires":[["83c44fe1.44712"]]},{"id":"3f3c07b0.deb2e8","type":"switch","z":"2e903c22.f77534","name":"","property":"local","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1380,"y":700,"wires":[["4b2607e.52171f8"],["b68238d5.b3eb18"]]},{"id":"cd1d17ec.550548","type":"ui_button","z":"96e2ce02.2e68e","name":"","group":"8d2999c5.e54f18","order":0,"width":0,"height":0,"passthru":false,"label":"КПП 1","tooltip":"","color":"","bgcolor":"","icon":"","payload":"10.3.5.210","payloadType":"str","topic":"","x":150,"y":600,"wires":[["83c44fe1.44712"]]},{"id":"1c43653f.3949bb","type":"function","z":"96e2ce02.2e68e","name":"","func":"if(msg.payload){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":420,"wires":[["122e1136.20a22f"]]},{"id":"fcd8facd.8c3908","type":"ui_switch","z":"96e2ce02.2e68e","name":"","label":"КПП 1.  IP 210","tooltip":"","group":"8d2999c5.e54f18","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":840,"y":260,"wires":[[]]},{"id":"8dd078bb.4b7458","type":"ui_button","z":"96e2ce02.2e68e","name":"","group":"84ef952b.8bf008","order":0,"width":0,"height":0,"passthru":false,"label":"КПП 2","tooltip":"","color":"","bgcolor":"","icon":"","payload":"10.3.5.216","payloadType":"str","topic":"","x":150,"y":640,"wires":[["83c44fe1.44712"]]},{"id":"9bb787e4.6cb518","type":"ui_switch","z":"96e2ce02.2e68e","name":"","label":"КПП 2.  IP  216","tooltip":"","group":"84ef952b.8bf008","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":840,"y":300,"wires":[[]]},{"id":"10ce7ec6.294881","type":"ui_switch","z":"96e2ce02.2e68e","name":"","label":"Службовий проїзд.  IP  211","tooltip":"","group":"52d6b5ef.95d89c","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":880,"y":340,"wires":[[]]},{"id":"fbd928e1.454fc8","type":"ui_switch","z":"96e2ce02.2e68e","name":"","label":"Ваги 80 т.  IP  217","tooltip":"","group":"e9302090.7fc66","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":850,"y":380,"wires":[[]]},{"id":"72713d33.59cc04","type":"ui_switch","z":"96e2ce02.2e68e","name":"","label":"Ваги 60 т.  IP  212","tooltip":"","group":"f00e6002.9fd61","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":850,"y":420,"wires":[[]]},{"id":"dd85baa8.7e51a8","type":"ui_switch","z":"96e2ce02.2e68e","name":"","label":"Лабораторія 1.  IP  214","tooltip":"","group":"4bf7e15a.661ae","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":860,"y":460,"wires":[[]]},{"id":"122e1136.20a22f","type":"switch","z":"96e2ce02.2e68e","name":"","property":"ip","propertyType":"msg","rules":[{"t":"eq","v":"10.3.5.210","vt":"str"},{"t":"eq","v":"10.3.5.216","vt":"str"},{"t":"eq","v":"10.3.5.211","vt":"str"},{"t":"eq","v":"10.3.5.217","vt":"str"},{"t":"eq","v":"10.3.5.212","vt":"str"},{"t":"eq","v":"10.3.5.214","vt":"str"},{"t":"eq","v":"10.3.5.215","vt":"str"}],"checkall":"true","repair":false,"outputs":7,"x":630,"y":420,"wires":[["fcd8facd.8c3908"],["9bb787e4.6cb518"],["10ce7ec6.294881"],["fbd928e1.454fc8"],["72713d33.59cc04"],["dd85baa8.7e51a8"],["af392a49.87c798"]]},{"id":"e3182788.beb428","type":"ui_button","z":"96e2ce02.2e68e","name":"","group":"52d6b5ef.95d89c","order":0,"width":0,"height":0,"passthru":false,"label":"Службовий проїзд","tooltip":"","color":"","bgcolor":"","icon":"","payload":"10.3.5.211","payloadType":"str","topic":"","x":190,"y":680,"wires":[["83c44fe1.44712"]]},{"id":"850a2b1f.620568","type":"ui_button","z":"96e2ce02.2e68e","name":"","group":"e9302090.7fc66","order":0,"width":0,"height":0,"passthru":false,"label":"Ваги 80 т.","tooltip":"","color":"","bgcolor":"","icon":"","payload":"10.3.5.217","payloadType":"str","topic":"","x":160,"y":720,"wires":[["83c44fe1.44712"]]},{"id":"6c9a84f1.7e8a4c","type":"ui_button","z":"96e2ce02.2e68e","name":"","group":"f00e6002.9fd61","order":0,"width":0,"height":0,"passthru":false,"label":"Ваги 60 т.","tooltip":"","color":"","bgcolor":"","icon":"","payload":"10.3.5.212","payloadType":"str","topic":"","x":160,"y":760,"wires":[["83c44fe1.44712"]]},{"id":"24f1038d.b4e52c","type":"ui_button","z":"96e2ce02.2e68e","name":"","group":"4bf7e15a.661ae","order":0,"width":0,"height":0,"passthru":false,"label":"Лабораторія 1","tooltip":"","color":"","bgcolor":"","icon":"","payload":"10.3.5.214","payloadType":"str","topic":"","x":180,"y":800,"wires":[["83c44fe1.44712"]]},{"id":"5d3a6c1f.912414","type":"ui_button","z":"96e2ce02.2e68e","name":"","group":"4f1a596d.afa5a8","order":0,"width":0,"height":0,"passthru":false,"label":"Лабораторія 2","tooltip":"","color":"","bgcolor":"","icon":"","payload":"10.3.5.215","payloadType":"str","topic":"","x":180,"y":840,"wires":[["83c44fe1.44712"]]},{"id":"af392a49.87c798","type":"ui_switch","z":"96e2ce02.2e68e","name":"","label":"Лабораторія 2.  IP  215","tooltip":"","group":"4f1a596d.afa5a8","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":860,"y":500,"wires":[[]]},{"id":"64707f85.bfdb1","type":"ui_button","z":"96e2ce02.2e68e","name":"","group":"4b6e8f48.bd669","order":0,"width":0,"height":0,"passthru":false,"label":"Проверить статусы","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":200,"y":40,"wires":[["9195185c.0a6cd8"]]},{"id":"9195185c.0a6cd8","type":"function","z":"96e2ce02.2e68e","name":"КПП 1","func":"msg.payload = '10.3.5.210';\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":40,"wires":[["d430267d.75df38","83c44fe1.44712"]]},{"id":"d430267d.75df38","type":"delay","z":"96e2ce02.2e68e","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":510,"y":40,"wires":[["32b6b30f.9088cc"]]},{"id":"32b6b30f.9088cc","type":"function","z":"96e2ce02.2e68e","name":"КПП 2","func":"msg.payload = '10.3.5.216';\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":40,"wires":[["de0ce8d3.e7ab68","83c44fe1.44712"]]},{"id":"de0ce8d3.e7ab68","type":"delay","z":"96e2ce02.2e68e","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":790,"y":40,"wires":[["b8c5b043.e5ad7"]]},{"id":"5913228e.b3322c","type":"delay","z":"96e2ce02.2e68e","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":590,"y":80,"wires":[["df7da35a.fad6b"]]},{"id":"b8c5b043.e5ad7","type":"function","z":"96e2ce02.2e68e","name":"Службовий проїзд","func":"msg.payload = '10.3.5.211';\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":80,"wires":[["5913228e.b3322c","83c44fe1.44712"]]},{"id":"df7da35a.fad6b","type":"function","z":"96e2ce02.2e68e","name":"Ваги 80 т.","func":"msg.payload = '10.3.5.217';\nreturn msg;","outputs":1,"noerr":0,"x":720,"y":80,"wires":[["83c44fe1.44712","ee3fa563.32af68"]]},{"id":"ee3fa563.32af68","type":"delay","z":"96e2ce02.2e68e","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":890,"y":80,"wires":[["ff4e0518.fa7b08"]]},{"id":"ff4e0518.fa7b08","type":"function","z":"96e2ce02.2e68e","name":"Ваги 60 т.","func":"msg.payload = '10.3.5.212';\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":120,"wires":[["d77862e5.3224b","83c44fe1.44712"]]},{"id":"d77862e5.3224b","type":"delay","z":"96e2ce02.2e68e","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":590,"y":120,"wires":[["8e4b2272.df387"]]},{"id":"8e4b2272.df387","type":"function","z":"96e2ce02.2e68e","name":"Лабораторія 1","func":"msg.payload = '10.3.5.214';\nreturn msg;","outputs":1,"noerr":0,"x":760,"y":120,"wires":[["f6ef156a.397f78","83c44fe1.44712"]]},{"id":"9c0cf385.38775","type":"function","z":"96e2ce02.2e68e","name":"Лабораторія 2","func":"msg.payload = '10.3.5.215';\nreturn msg;","outputs":1,"noerr":0,"x":760,"y":180,"wires":[["83c44fe1.44712"]]},{"id":"f6ef156a.397f78","type":"delay","z":"96e2ce02.2e68e","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":930,"y":120,"wires":[["9c0cf385.38775"]]},{"id":"3217b7f.67a7048","type":"inject","z":"9ef88788.dfecc8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":940,"wires":[["cf8ce021.6ac78"]]},{"id":"cf8ce021.6ac78","type":"debug","z":"9ef88788.dfecc8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":310,"y":940,"wires":[]},{"id":"9fb57c8a.a08d7","type":"switch","z":"2e903c22.f77534","name":"","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"00","vt":"str"},{"t":"eq","v":"80","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":160,"wires":[["d72e6aa4.94ed38"],["1d97c93c.518d07"]]},{"id":"d72e6aa4.94ed38","type":"delay","z":"2e903c22.f77534","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1150,"y":80,"wires":[["1d97c93c.518d07"]]},{"id":"ef15917b.7d65a","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"diff","x":710,"y":800,"wires":[]},{"id":"7ba19641.bbdc48","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"pull","x":730,"y":860,"wires":[]},{"id":"b935733.1287d9","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":780,"y":580,"wires":[]},{"id":"e0a6f938.07b298","type":"function","z":"2e903c22.f77534","name":"event_search_in_access_table","func":"msg.payload = {};\nmsg.payload.ip = msg.ip;\nmsg.payload.event_name = \"Поиск в таблице доступа\";\nmsg.payload.event_desc = msg.payload.event_name+\" \"+msg.ip+\" \"+msg.antennaID;\nmsg.tagID = msg.tag.tagID;\nreturn msg;","outputs":1,"noerr":0,"x":890,"y":280,"wires":[["564acb4f.591be4"]]},{"id":"4a0fd1e3.34a21","type":"function","z":"9ef88788.dfecc8","name":"setup params","func":"msg.queryParameters = msg.queryParameters || {};\nmsg.queryParameters.param1 = msg.payload.event_name;\nmsg.queryParameters.param2 = msg.payload.event_desc;\nmsg.queryParameters.param3 = msg.payload.ip;\nmsg.queryParameters.param4 = msg.tagID;\nmsg.queryParameters.param5 = new Date();\nmsg.queryParameters.param6 = msg.antennaID;\nmsg.queryParameters.param7 = new Date();\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":880,"wires":[["cb483e63.21304"]]},{"id":"cb483e63.21304","type":"template","z":"9ef88788.dfecc8","name":"query field1","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"INSERT INTO event_table(\n             Event_name,Event_description,IP,tag,lastSeenTimestampUTC,channel,date_time)\n    VALUES ($param1,$param2,$param3,$param4,$param5,$param6,$param7);","x":550,"y":880,"wires":[["86b60810.5c9828"]]},{"id":"86b60810.5c9828","type":"postgres","z":"9ef88788.dfecc8","postgresdb":"e3afc53a.234858","name":"rfid_log","output":true,"outputs":1,"x":720,"y":880,"wires":[["4e5a6607.fa92f8"]]},{"id":"4e5a6607.fa92f8","type":"debug","z":"9ef88788.dfecc8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":890,"y":860,"wires":[]},{"id":"cbc29aad.66d948","type":"comment","z":"9ef88788.dfecc8","name":"Відправка даних на таблицю івентів 2","info":"","x":440,"y":840,"wires":[]},{"id":"380960b8.ba4a2","type":"link in","z":"9ef88788.dfecc8","name":"events 2","links":["564acb4f.591be4"],"x":195,"y":880,"wires":[["4a0fd1e3.34a21"]]},{"id":"564acb4f.591be4","type":"link out","z":"2e903c22.f77534","name":"","links":["380960b8.ba4a2"],"x":1775,"y":320,"wires":[]},{"id":"50716944.cfe018","type":"function","z":"2e903c22.f77534","name":"event_send_from_access_table","func":"msg.payload = {};\nmsg.payload.ip = msg.ip;\nmsg.payload.event_name = \"Отправка команды с таблицы доступа\";\nmsg.payload.event_desc = msg.payload.event_name+\" \"+msg.ip+\" \"+msg.antennaID;\nmsg.tagID = msg.tagID;\nmsg.payload.cmd = msg.cmd;\nreturn msg;","outputs":1,"noerr":0,"x":920,"y":220,"wires":[["d020626d.13d02","8f92c626.34fb28"]]},{"id":"4b4245b8.380cdc","type":"function","z":"2e903c22.f77534","name":"event_find_in_acces_table","func":"msg.payload = {};\n\nmsg.payload.ip = msg.ip;\nmsg.payload.event_name = \"Найдена в таблице доступа\";\nmsg.payload.event_desc = msg.payload.event_name+\" \"+msg.ip+\" \"+msg.antennaID;\n\nreturn msg;","outputs":1,"noerr":0,"x":1580,"y":320,"wires":[["564acb4f.591be4"]]},{"id":"8e0ba1ba.46ab2","type":"function","z":"2e903c22.f77534","name":"set last tag","func":"var lastTags = flow.set(msg.ip,msg.tagID);\n\nreturn msg;","outputs":1,"noerr":0,"x":810,"y":520,"wires":[["df8e4fcf.6776c"]]},{"id":"df8e4fcf.6776c","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1040,"y":560,"wires":[]},{"id":"8f92c626.34fb28","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":1160,"y":200,"wires":[]},{"id":"792bd179.919c","type":"debug","z":"2e903c22.f77534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1630,"y":460,"wires":[]},{"id":"77255bc4.9f19e4","type":"function","z":"2e903c22.f77534","name":"event_send_to_1c","func":"msg.payload.ip = msg.ip;\nmsg.payload.event_name = \"Отправка в 1С\";\nmsg.payload.event_desc = msg.payload.event_name+\" \"+msg.ip+\" \"+msg.antennaID;\n\nreturn msg;","outputs":1,"noerr":0,"x":1010,"y":780,"wires":[["564acb4f.591be4"]]},{"id":"fd19fb67.660488","type":"switch","z":"2e903c22.f77534","name":"finded","property":"finded","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1110,"y":380,"wires":[["9da02192.c56bf"],[]]},{"id":"c10b37b0.279c88","type":"function","z":"812a160b.c93e38","name":"погасити світлофори СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":240,"wires":[["ba786a9.599a798"]]},{"id":"c6795937.914648","type":"function","z":"812a160b.c93e38","name":"Світлофор червний СТ_0","func":"\n\n\nmsg.payload =\"START1;0;1;3;0;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":200,"wires":[["ba786a9.599a798"]]},{"id":"53e4e05.9307d2","type":"function","z":"812a160b.c93e38","name":"Світлофор зелений СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":160,"wires":[["ba786a9.599a798"]]},{"id":"ba786a9.599a798","type":"converter","z":"812a160b.c93e38","name":"","from":"win1251","x":880,"y":400,"wires":[["8ed9065d.a1f248"]]},{"id":"8ed9065d.a1f248","type":"tcp out","z":"812a160b.c93e38","host":"10.3.5.228","port":"9761","beserver":"client","base64":false,"end":false,"name":"","x":1060,"y":400,"wires":[]},{"id":"730c59f4.35cf98","type":"function","z":"812a160b.c93e38","name":"ТЕСТ сторона 1","func":"\nvar num_avto_r1 = \" ПІСЛЯ  \";\nvar num_avto_r2 = \" СМС \";\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":530,"y":840,"wires":[["ba786a9.599a798"]]},{"id":"3f984c85.bd5d74","type":"function","z":"812a160b.c93e38","name":"Світлофор зелений СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":560,"y":880,"wires":[["ba786a9.599a798"]]},{"id":"c641e115.e5626","type":"function","z":"812a160b.c93e38","name":"Світлофор червний СТ_1","func":"\n\n\nmsg.payload =\"START1;0;1;3;1;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":560,"y":920,"wires":[["ba786a9.599a798"]]},{"id":"a94f56a1.83c078","type":"function","z":"812a160b.c93e38","name":"погасити світлофори СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":560,"y":960,"wires":[["ba786a9.599a798"]]},{"id":"8a383cdf.b3895","type":"function","z":"812a160b.c93e38","name":"ТЕСТ сторона 0","func":"\nvar num_avto_r1 = \"    \";\nvar num_avto_r2 = \"   \";\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":490,"y":280,"wires":[["ba786a9.599a798"]]},{"id":"fd45b67.4a3f648","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":160,"wires":[["53e4e05.9307d2"]]},{"id":"89e5229f.028a6","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":200,"wires":[["c6795937.914648"]]},{"id":"966d5bae.687aa8","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":240,"wires":[["c10b37b0.279c88"]]},{"id":"77e76ad1.665094","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":280,"wires":[["8a383cdf.b3895"]]},{"id":"21adad81.2e2a92","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":780,"wires":[["730c59f4.35cf98"]]},{"id":"12c3b689.fff229","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":880,"wires":[["3f984c85.bd5d74"]]},{"id":"3386ec02.9e5684","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":920,"wires":[["c641e115.e5626"]]},{"id":"5322a49.e98ea5c","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":960,"wires":[["a94f56a1.83c078"]]},{"id":"1ccad8bc.ff8647","type":"function","z":"812a160b.c93e38","name":"яскравість 100 всі сторони","func":"\n\n\nmsg.payload =\"START1;0;0;102;255;255;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":360,"y":60,"wires":[["ba786a9.599a798"]]},{"id":"9d2b6637.876158","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":60,"wires":[["1ccad8bc.ff8647"]]},{"id":"c59c6883.e0e6c8","type":"comment","z":"812a160b.c93e38","name":"80 тон, від вагів","info":"","x":120,"y":740,"wires":[]},{"id":"745c3aca.aa4d24","type":"comment","z":"812a160b.c93e38","name":"80 тонн, до вагів","info":"","x":120,"y":20,"wires":[]},{"id":"65ee7222.7dcffc","type":"converter","z":"ad19a7b.79d5458","name":"","from":"win1251","x":840,"y":480,"wires":[["a1f55ca5.1e7b4"]]},{"id":"72bbded1.c49c3","type":"function","z":"ad19a7b.79d5458","name":"погасити світлофори СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":820,"wires":[["65ee7222.7dcffc"]]},{"id":"154e7e05.226402","type":"function","z":"ad19a7b.79d5458","name":"Світлофор червний СТ_0","func":"\n\n\nmsg.payload =\"START1;0;1;3;0;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":780,"wires":[["65ee7222.7dcffc"]]},{"id":"e6db6302.7704f","type":"function","z":"ad19a7b.79d5458","name":"Світлофор зелений СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":740,"wires":[["65ee7222.7dcffc"]]},{"id":"a1f55ca5.1e7b4","type":"tcp out","z":"ad19a7b.79d5458","host":"10.3.5.226","port":"9761","beserver":"client","base64":false,"end":false,"name":"","x":1020,"y":480,"wires":[]},{"id":"80f8f990.2cd228","type":"function","z":"ad19a7b.79d5458","name":"ТЕСТ сторона 1","func":"\nvar num_avto_r1 = \" Тест  \";\nvar num_avto_r2 = \" 1с \";\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":550,"y":140,"wires":[["65ee7222.7dcffc"]]},{"id":"2ded541a.93d5cc","type":"function","z":"ad19a7b.79d5458","name":"Світлофор зелений СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":570,"y":180,"wires":[["65ee7222.7dcffc"]]},{"id":"fd86d180.ba80f","type":"function","z":"ad19a7b.79d5458","name":"Світлофор червний СТ_1","func":"\n\n\nmsg.payload =\"START1;0;1;3;1;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":570,"y":220,"wires":[["65ee7222.7dcffc"]]},{"id":"1516693.a106d97","type":"function","z":"ad19a7b.79d5458","name":"погасити світлофори СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":570,"y":260,"wires":[["65ee7222.7dcffc"]]},{"id":"fda31402.ec17d8","type":"function","z":"ad19a7b.79d5458","name":"ТЕСТ сторона 0","func":"\nvar num_avto_r1 = \" табло 2  \";\nvar num_avto_r2 = \" сторона 1 \";\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":450,"y":860,"wires":[["65ee7222.7dcffc"]]},{"id":"bea52a84.efa778","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":740,"wires":[["e6db6302.7704f"]]},{"id":"b6fd4bec.3fac38","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":780,"wires":[["154e7e05.226402"]]},{"id":"92e3e535.e41cc8","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":820,"wires":[["72bbded1.c49c3"]]},{"id":"ec45e990.ca64d8","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":860,"wires":[["fda31402.ec17d8"]]},{"id":"2756e8b4.ba6008","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":140,"wires":[["80f8f990.2cd228"]]},{"id":"7a575f63.0e202","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":180,"wires":[["2ded541a.93d5cc"]]},{"id":"b56f41d1.2841f","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":220,"wires":[["fd86d180.ba80f"]]},{"id":"9ad4f2ac.3e426","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":260,"wires":[["1516693.a106d97"]]},{"id":"d2cfc9fb.160b28","type":"function","z":"ad19a7b.79d5458","name":"яскравість 100 всі сторони","func":"\n\n\nmsg.payload =\"START1;0;0;102;255;255;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":580,"y":80,"wires":[["65ee7222.7dcffc"]]},{"id":"b325a87.4759758","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":80,"wires":[["d2cfc9fb.160b28"]]},{"id":"ea96bc66.ebf1","type":"comment","z":"ad19a7b.79d5458","name":"60 тон, вїзд_від вагів","info":"","x":100,"y":660,"wires":[]},{"id":"2aa80596.ee7f2a","type":"comment","z":"ad19a7b.79d5458","name":"60 тон, вїзд_до вагів","info":"","x":140,"y":40,"wires":[]},{"id":"e19dcfaa.e1875","type":"converter","z":"ecb31b95.29a5e8","name":"","from":"win1251","x":820,"y":400,"wires":[["1d5ea15c.47adef"]]},{"id":"ac7bb142.fe4bf","type":"function","z":"ecb31b95.29a5e8","name":"погасити світлофори СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":860,"wires":[["e19dcfaa.e1875"]]},{"id":"eb6b534d.2eaba","type":"function","z":"ecb31b95.29a5e8","name":"Світлофор червний СТ_0","func":"\n\n\nmsg.payload =\"START1;0;1;3;0;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":820,"wires":[["e19dcfaa.e1875"]]},{"id":"5b872c39.d453d4","type":"function","z":"ecb31b95.29a5e8","name":"Світлофор зелений СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":780,"wires":[["e19dcfaa.e1875"]]},{"id":"1d5ea15c.47adef","type":"tcp out","z":"ecb31b95.29a5e8","host":"10.3.5.225","port":"9761","beserver":"client","base64":false,"end":false,"name":"","x":1000,"y":400,"wires":[]},{"id":"8b06539c.34f4d","type":"function","z":"ecb31b95.29a5e8","name":"ТЕСТ сторона 1","func":"\nvar num_avto_r1 = \" табло 3  \";\nvar num_avto_r2 = \" сторона 1 \";\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":490,"y":120,"wires":[["e19dcfaa.e1875"]]},{"id":"6edbbbf1.9728b4","type":"function","z":"ecb31b95.29a5e8","name":"Світлофор зелений СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":510,"y":160,"wires":[["e19dcfaa.e1875"]]},{"id":"3bfd35bd.05610a","type":"function","z":"ecb31b95.29a5e8","name":"Світлофор червний СТ_1","func":"\n\n\nmsg.payload =\"START1;0;1;3;1;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":510,"y":200,"wires":[["e19dcfaa.e1875"]]},{"id":"f5b91b41.49c608","type":"function","z":"ecb31b95.29a5e8","name":"погасити світлофори СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":510,"y":240,"wires":[["e19dcfaa.e1875"]]},{"id":"94f402b5.cba2a","type":"function","z":"ecb31b95.29a5e8","name":"ТЕСТ сторона 0","func":"\nvar num_avto_r1 = \" табло 3  \";\nvar num_avto_r2 = \" сторона 2 \";\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":490,"y":900,"wires":[["e19dcfaa.e1875"]]},{"id":"6c6ac01a.e3681","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":780,"wires":[["5b872c39.d453d4"]]},{"id":"f4a8fa18.77e0c8","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":820,"wires":[["eb6b534d.2eaba"]]},{"id":"174b131f.fb7f6d","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":860,"wires":[["ac7bb142.fe4bf"]]},{"id":"16ae67eb.854fc8","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":900,"wires":[["94f402b5.cba2a"]]},{"id":"178e202.39b31e","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":120,"wires":[["8b06539c.34f4d"]]},{"id":"ad88fb75.0f61e8","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":160,"wires":[["6edbbbf1.9728b4"]]},{"id":"eb44ba8f.7ea698","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":200,"wires":[["3bfd35bd.05610a"]]},{"id":"35d89ce6.f423e4","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":240,"wires":[["f5b91b41.49c608"]]},{"id":"33f89bdb.95ad44","type":"function","z":"ecb31b95.29a5e8","name":"яскравість 100 всі сторони","func":"\n\n\nmsg.payload =\"START1;0;0;102;255;255;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":380,"y":60,"wires":[["e19dcfaa.e1875"]]},{"id":"f0ecb3ed.a882e","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":60,"wires":[["33f89bdb.95ad44"]]},{"id":"8a219a92.e18488","type":"comment","z":"ecb31b95.29a5e8","name":"60 тон, виїзд_від вагів","info":"","x":140,"y":720,"wires":[]},{"id":"8b240b62.066568","type":"comment","z":"ecb31b95.29a5e8","name":"60 тон, виїзд_до вагів","info":"","x":140,"y":20,"wires":[]},{"id":"a8829c6f.f45fc","type":"function","z":"c7763c53.7c105","name":"погасити світлофори СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":460,"y":200,"wires":[["ac7f4f37.e0a5f"]]},{"id":"af59a754.426b78","type":"function","z":"c7763c53.7c105","name":"Світлофор червний СТ_0","func":"\n\n\nmsg.payload =\"START1;0;1;3;0;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":460,"y":160,"wires":[["ac7f4f37.e0a5f"]]},{"id":"98e0613e.ddd32","type":"function","z":"c7763c53.7c105","name":"Світлофор зелений СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":460,"y":120,"wires":[["ac7f4f37.e0a5f"]]},{"id":"ac7f4f37.e0a5f","type":"converter","z":"c7763c53.7c105","name":"","from":"win1251","x":780,"y":420,"wires":[["ecd00db0.b1a3a"]]},{"id":"ecd00db0.b1a3a","type":"tcp out","z":"c7763c53.7c105","host":"10.3.5.224","port":"9761","beserver":"client","base64":false,"end":false,"name":"","x":960,"y":420,"wires":[]},{"id":"2237f2c6.0ee85e","type":"function","z":"c7763c53.7c105","name":"ТЕСТ сторона 1","func":"\nvar num_avto_r1 = \" Табло 4  \";\nvar num_avto_r2 = \" Сторона 2 \";\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":450,"y":720,"wires":[["ac7f4f37.e0a5f"]]},{"id":"c1b54c1e.e3f2d","type":"function","z":"c7763c53.7c105","name":"Світлофор зелений СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":470,"y":760,"wires":[["ac7f4f37.e0a5f"]]},{"id":"fb986830.39b5c8","type":"function","z":"c7763c53.7c105","name":"Світлофор червний СТ_1","func":"\n\n\nmsg.payload =\"START1;0;1;3;1;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":470,"y":800,"wires":[["ac7f4f37.e0a5f"]]},{"id":"626486b1.311ad8","type":"function","z":"c7763c53.7c105","name":"погасити світлофори СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":470,"y":840,"wires":[["ac7f4f37.e0a5f"]]},{"id":"5a6ff387.cc33cc","type":"function","z":"c7763c53.7c105","name":"ТЕСТ сторона 0","func":"\nvar num_avto_r1 = \" табло 4  \";\nvar num_avto_r2 = \" сторона 1 \";\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":430,"y":240,"wires":[["ac7f4f37.e0a5f"]]},{"id":"2afaf026.b8371","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":120,"wires":[["98e0613e.ddd32"]]},{"id":"af7b55c0.2d6158","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":160,"wires":[["af59a754.426b78"]]},{"id":"ea84e6de.1f7e68","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":200,"wires":[["a8829c6f.f45fc"]]},{"id":"94b74ba2.fcfcb8","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":240,"wires":[["5a6ff387.cc33cc"]]},{"id":"3f56b083.8aeed","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":720,"wires":[["2237f2c6.0ee85e"]]},{"id":"450a37de.9227c8","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":760,"wires":[["c1b54c1e.e3f2d"]]},{"id":"d7c45f5b.5a061","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":800,"wires":[["fb986830.39b5c8"]]},{"id":"1140a308.0bc4fd","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":840,"wires":[["626486b1.311ad8"]]},{"id":"c9952a1e.59d4d8","type":"function","z":"c7763c53.7c105","name":"яскравість 100 всі сторони","func":"\n\n\nmsg.payload =\"START1;0;0;102;255;255;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":380,"y":80,"wires":[["ac7f4f37.e0a5f"]]},{"id":"756a7bf.ff2f484","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":80,"wires":[["c9952a1e.59d4d8"]]},{"id":"84a798e.0adc168","type":"comment","z":"c7763c53.7c105","name":"80 тон, вїзд_від вагів","info":"","x":120,"y":580,"wires":[]},{"id":"5cd8e8a8.2b8948","type":"comment","z":"c7763c53.7c105","name":"80 тон, вїзд_до вагів","info":"","x":140,"y":40,"wires":[]},{"id":"4aaa0a3e.582404","type":"function","z":"812a160b.c93e38","name":"Дані строки з 1C ст_0","func":"msg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":500,"y":320,"wires":[["ba786a9.599a798"]]},{"id":"ac9fc964.198938","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":310,"y":580,"wires":[["f10614e2.69c738"]]},{"id":"f10614e2.69c738","type":"function","z":"812a160b.c93e38","name":"init Змінні для події    #вага","func":"flow.set(\"cmdOts1_80\",false);\nflow.set(\"msgPayload_80\",{});\nflow.set(\"row1_80\",\"\");\nflow.set(\"row2_80\",\"\");\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":540,"wires":[[]]},{"id":"98125f8b.7f479","type":"function","z":"812a160b.c93e38","name":"true","func":"var dies_1 = msg.payload.row1;\nvar dies_2 = msg.payload.row2;\n\n    if(dies_1 == \"#вес\" || dies_2 == \"#вес\"){\n        flow.set(\"cmdOts1_80\",true);\n    }else if(dies_1 !== \"#вес\" && dies_2 !== \"#вес\"){\n        flow.set(\"cmdOts1_80\",false);\n    }\n\nvar last_mes = {\n    row1: dies_1,\n    row2: dies_2\n}\n\nflow.set(\"row1_80\", msg.payload.row1);\nflow.set(\"row2_80\", msg.payload.row2);\nflow.set(\"msgPayload_80\", last_mes);\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":500,"wires":[["6cc0dd31.722024"]]},{"id":"f5574f38.910aa","type":"switch","z":"812a160b.c93e38","name":"","property":"cmdOts1_80","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":290,"y":500,"wires":[["98125f8b.7f479"]]},{"id":"1f898da.7985472","type":"inject","z":"812a160b.c93e38","name":"reset","topic":"","payload":"msgPayload_80","payloadType":"flow","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":290,"y":540,"wires":[["f5574f38.910aa"]]},{"id":"6cc0dd31.722024","type":"function","z":"812a160b.c93e38","name":"Дані строки з 1C","func":"var row1 = flow.get(\"row1_80\");\nvar row2 = flow.get(\"row2_80\");\n\n//msg.payload.row1 = flow.get(\"row1\");\n//msg.payload.row2 = flow.get(\"row2\");\n\n\nif(row1 == \"#вес\" ){\n   msg.payload.row1 = global.get(\"weight_80\");\n   msg.payload.row2 = flow.get(\"row2_80\"); \n   }else if(row2 == \"#вес\" ){\n   msg.payload.row2 = global.get(\"weight_80\");\n   msg.payload.row1 = flow.get(\"row1_80\"); \n}\n\n\nmsg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":570,"y":500,"wires":[["ba786a9.599a798"]]},{"id":"8f281eed.37f58","type":"function","z":"812a160b.c93e38","name":"Дані строки з 1C ст_1","func":"msg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":540,"y":800,"wires":[["ba786a9.599a798"]]},{"id":"31cf0069.36638","type":"function","z":"c7763c53.7c105","name":"Дані строки з 1C ст_0","func":"msg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":440,"y":280,"wires":[["ac7f4f37.e0a5f"]]},{"id":"53baeb09.d4f8e4","type":"function","z":"c7763c53.7c105","name":"Дані строки з 1C ст_1","func":"msg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":460,"y":680,"wires":[["ac7f4f37.e0a5f"]]},{"id":"918e1513.fdbed8","type":"function","z":"ad19a7b.79d5458","name":"Дані строки з 1C ст_1","func":"msg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":560,"y":300,"wires":[["65ee7222.7dcffc"]]},{"id":"d961d006.6096e","type":"function","z":"ad19a7b.79d5458","name":"Дані строки з 1C ст_0","func":"msg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":460,"y":700,"wires":[["65ee7222.7dcffc"]]},{"id":"b33e6036.2f231","type":"function","z":"ecb31b95.29a5e8","name":"Дані строки з 1C ст_1","func":"msg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":500,"y":280,"wires":[["e19dcfaa.e1875"]]},{"id":"e6a7344a.891c98","type":"function","z":"ecb31b95.29a5e8","name":"Дані строки з 1C ст_0","func":"msg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":740,"wires":[["e19dcfaa.e1875"]]},{"id":"d8d74af5.e80178","type":"link in","z":"812a160b.c93e38","name":"80_т_2 команда з 1с","links":["673e4096.295fc"],"x":255,"y":440,"wires":[["98125f8b.7f479"]]},{"id":"a188999c.c168d8","type":"inject","z":"812a160b.c93e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":330,"y":1120,"wires":[["11ebc69b.e04099"]]},{"id":"11ebc69b.e04099","type":"function","z":"812a160b.c93e38","name":"init Змінні для події    #вага","func":"flow.set(\"cmdOts1_81\",false);\nflow.set(\"msgPayload_81\",{});\nflow.set(\"row1_81\",\"\");\nflow.set(\"row2_81\",\"\");\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":1080,"wires":[[]]},{"id":"684addb0.eb6a24","type":"function","z":"812a160b.c93e38","name":"true","func":"var dies_1 = msg.payload.row1;\nvar dies_2 = msg.payload.row2;\n\n    if(dies_1 == \"#вес\" || dies_2 == \"#вес\"){\n        flow.set(\"cmdOts1_81\",true);\n    }else if(dies_1 !== \"#вес\" && dies_2 !== \"#вес\"){\n        flow.set(\"cmdOts1_81\",false);\n    }\n\nvar last_mes = {\n    row1: dies_1,\n    row2: dies_2\n}\n\nflow.set(\"row1_81\", msg.payload.row1);\nflow.set(\"row2_81\", msg.payload.row2);\nflow.set(\"msgPayload_81\", last_mes);\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":1040,"wires":[["80b109b7.fa3848"]]},{"id":"fe748ed.7cf6c7","type":"switch","z":"812a160b.c93e38","name":"","property":"cmdOts1_81","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":310,"y":1040,"wires":[["684addb0.eb6a24"]]},{"id":"54eb1867.3892b8","type":"inject","z":"812a160b.c93e38","name":"reset","topic":"","payload":"msgPayload_81","payloadType":"flow","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":310,"y":1080,"wires":[["fe748ed.7cf6c7"]]},{"id":"80b109b7.fa3848","type":"function","z":"812a160b.c93e38","name":"Дані строки з 1C","func":"var row1 = flow.get(\"row1_81\");\nvar row2 = flow.get(\"row2_81\");\n\n//msg.payload.row1 = flow.get(\"row1\");\n//msg.payload.row2 = flow.get(\"row2\");\n\n\nif(row1 == \"#вес\" ){\n   msg.payload.row1 = global.get(\"weight_80\");\n   msg.payload.row2 = flow.get(\"row2_81\"); \n   }else if(row2 == \"#вес\" ){\n   msg.payload.row2 = global.get(\"weight_80\");\n   msg.payload.row1 = flow.get(\"row1_81\"); \n}\n\n\nmsg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":590,"y":1040,"wires":[["ba786a9.599a798"]]},{"id":"1d1a2793.639e68","type":"link in","z":"812a160b.c93e38","name":"80_т_1 команда з 1С","links":["bd9d95e2.fc34f8"],"x":275,"y":1000,"wires":[["684addb0.eb6a24"]]},{"id":"2f050fc8.59ac","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":250,"y":1020,"wires":[["8777ea42.dba608"]]},{"id":"8777ea42.dba608","type":"function","z":"c7763c53.7c105","name":"init Змінні для події    #вага","func":"flow.set(\"cmdOts1_83\",false);\nflow.set(\"msgPayload_83\",{});\nflow.set(\"row1_83\",\"\");\nflow.set(\"row2_83\",\"\");\nreturn msg;","outputs":1,"noerr":0,"x":460,"y":980,"wires":[[]]},{"id":"54837dfa.8f1544","type":"function","z":"c7763c53.7c105","name":"true","func":"var dies_1 = msg.payload.row1;\nvar dies_2 = msg.payload.row2;\n\n    if(dies_1 == \"#вес\" || dies_2 == \"#вес\"){\n        flow.set(\"cmdOts1_83\",true);\n    }else if(dies_1 !== \"#вес\" && dies_2 !== \"#вес\"){\n        flow.set(\"cmdOts1_83\",false);\n    }\n\nvar last_mes = {\n    row1: dies_1,\n    row2: dies_2\n}\n\nflow.set(\"row1_83\", msg.payload.row1);\nflow.set(\"row2_83\", msg.payload.row2);\nflow.set(\"msgPayload_83\", last_mes);\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":940,"wires":[["633c60c4.1fce7"]]},{"id":"f1790645.2a7718","type":"switch","z":"c7763c53.7c105","name":"","property":"cmdOts1_83","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":230,"y":940,"wires":[["54837dfa.8f1544"]]},{"id":"f384e2ad.0a12c","type":"inject","z":"c7763c53.7c105","name":"reset","topic":"","payload":"msgPayload","payloadType":"flow","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":980,"wires":[["f1790645.2a7718"]]},{"id":"633c60c4.1fce7","type":"function","z":"c7763c53.7c105","name":"Дані строки з 1C","func":"var row1 = flow.get(\"row1_83\");\nvar row2 = flow.get(\"row2_83\");\n\n//msg.payload.row1 = flow.get(\"row1\");\n//msg.payload.row2 = flow.get(\"row2\");\n\n\nif(row1 == \"#вес\" ){\n   msg.payload.row1 = global.get(\"weight_80\");\n   msg.payload.row2 = flow.get(\"row2_83\"); \n   }else if(row2 == \"#вес\" ){\n   msg.payload.row2 = global.get(\"weight_80\");\n   msg.payload.row1 = flow.get(\"row1_83\"); \n}\n\n\nmsg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":510,"y":940,"wires":[[]]},{"id":"af644280.09ac6","type":"link in","z":"c7763c53.7c105","name":"80_т_4 команда з 1С","links":["38ab168.9e321ea"],"x":195,"y":900,"wires":[["54837dfa.8f1544"]]},{"id":"a7656207.ba599","type":"inject","z":"c7763c53.7c105","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":190,"y":500,"wires":[["34259ed0.ae0492"]]},{"id":"34259ed0.ae0492","type":"function","z":"c7763c53.7c105","name":"init Змінні для події    #вага","func":"flow.set(\"cmdOts1_82\",false);\nflow.set(\"msgPayload_82\",{});\nflow.set(\"row1_82\",\"\");\nflow.set(\"row2_82\",\"\");\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":460,"wires":[[]]},{"id":"46a4d5ac.821cbc","type":"function","z":"c7763c53.7c105","name":"true","func":"var dies_1 = msg.payload.row1;\nvar dies_2 = msg.payload.row2;\n\n    if(dies_1 == \"#вес\" || dies_2 == \"#вес\"){\n        flow.set(\"cmdOts1_82\",true);\n    }else if(dies_1 !== \"#вес\" && dies_2 !== \"#вес\"){\n        flow.set(\"cmdOts1_82\",false);\n    }\n\nvar last_mes = {\n    row1: dies_1,\n    row2: dies_2\n}\n\nflow.set(\"row1_82\", msg.payload.row1);\nflow.set(\"row2_82\", msg.payload.row2);\nflow.set(\"msgPayload_82\", last_mes);\nreturn msg;","outputs":1,"noerr":0,"x":290,"y":420,"wires":[["cf846aa9.850cd8"]]},{"id":"7cca101d.19fa4","type":"switch","z":"c7763c53.7c105","name":"","property":"cmdOts1_82","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":170,"y":420,"wires":[["46a4d5ac.821cbc"]]},{"id":"e7e47fbb.2d69c","type":"inject","z":"c7763c53.7c105","name":"reset","topic":"","payload":"msgPayload_82","payloadType":"flow","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":460,"wires":[["7cca101d.19fa4"]]},{"id":"cf846aa9.850cd8","type":"function","z":"c7763c53.7c105","name":"Дані строки з 1C","func":"var row1 = flow.get(\"row1_82\");\nvar row2 = flow.get(\"row2_82\");\n\n//msg.payload.row1 = flow.get(\"row1\");\n//msg.payload.row2 = flow.get(\"row2\");\n\n\nif(row1 == \"#вес\" ){\n   msg.payload.row1 = global.get(\"weight_80\");\n   msg.payload.row2 = flow.get(\"row2_82\"); \n   }else if(row2 == \"#вес\" ){\n   msg.payload.row2 = global.get(\"weight_80\");\n   msg.payload.row1 = flow.get(\"row1_82\"); \n}\n\n\nmsg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":450,"y":420,"wires":[["ac7f4f37.e0a5f"]]},{"id":"fc39a7a8.b713c8","type":"link in","z":"c7763c53.7c105","name":"80_т_3 команда з 1с","links":["d7647786.a75638"],"x":135,"y":380,"wires":[["46a4d5ac.821cbc"]]},{"id":"dc8886f4.879c58","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":230,"y":460,"wires":[["33f39be5.63b1d4"]]},{"id":"33f39be5.63b1d4","type":"function","z":"ad19a7b.79d5458","name":"init Змінні для події    #вага","func":"flow.set(\"cmdOts1_60\",false);\nflow.set(\"msgPayload_60\",{});\nflow.set(\"row1_60\",\"\");\nflow.set(\"row2_60\",\"\");\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":420,"wires":[[]]},{"id":"5073317e.c0448","type":"function","z":"ad19a7b.79d5458","name":"true","func":"var dies_1 = msg.payload.row1;\nvar dies_2 = msg.payload.row2;\n\n    if(dies_1 == \"#вес\" || dies_2 == \"#вес\"){\n        flow.set(\"cmdOts1_60\",true);\n    }else if(dies_1 !== \"#вес\" && dies_2 !== \"#вес\"){\n        flow.set(\"cmdOts1_60\",false);\n    }\n\nvar last_mes = {\n    row1: dies_1,\n    row2: dies_2\n}\n\nflow.set(\"row1_60\", msg.payload.row1);\nflow.set(\"row2_60\", msg.payload.row2);\nflow.set(\"msgPayload_60\", last_mes);\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":380,"wires":[["ca65373b.b03968"]]},{"id":"b995a7b4.70e448","type":"switch","z":"ad19a7b.79d5458","name":"","property":"cmdOts1_60","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":210,"y":380,"wires":[["5073317e.c0448"]]},{"id":"ee4df40f.67de38","type":"inject","z":"ad19a7b.79d5458","name":"reset","topic":"","payload":"msgPayload_60","payloadType":"flow","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":210,"y":420,"wires":[["b995a7b4.70e448"]]},{"id":"ca65373b.b03968","type":"function","z":"ad19a7b.79d5458","name":"Дані строки з 1C","func":"var row1 = flow.get(\"row1_60\");\nvar row2 = flow.get(\"row2_60\");\n\n//msg.payload.row1 = flow.get(\"row1\");\n//msg.payload.row2 = flow.get(\"row2\");\n\n\nif(row1 == \"#вес\" ){\n   msg.payload.row1 = global.get(\"weight_60\");\n   msg.payload.row2 = flow.get(\"row2_60\"); \n   }else if(row2 == \"#вес\" ){\n   msg.payload.row2 = global.get(\"weight_60\");\n   msg.payload.row1 = flow.get(\"row1_60\"); \n}\n\n\nmsg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":490,"y":380,"wires":[["65ee7222.7dcffc"]]},{"id":"22b7aa0e.1c3e86","type":"link in","z":"ad19a7b.79d5458","name":"60_т_2 команда з 1с","links":["aeb4136b.a2c1d"],"x":175,"y":340,"wires":[["5073317e.c0448"]]},{"id":"6d78eba8.a2fe74","type":"inject","z":"ad19a7b.79d5458","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":210,"y":1040,"wires":[["6c8a522b.c6b38c"]]},{"id":"6c8a522b.c6b38c","type":"function","z":"ad19a7b.79d5458","name":"init Змінні для події    #вага","func":"flow.set(\"cmdOts1_61\",false);\nflow.set(\"msgPayload_61\",{});\nflow.set(\"row1_61\",\"\");\nflow.set(\"row2_61\",\"\");\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":1000,"wires":[[]]},{"id":"1a008e38.ca6e12","type":"function","z":"ad19a7b.79d5458","name":"true","func":"var dies_1 = msg.payload.row1;\nvar dies_2 = msg.payload.row2;\n\n    if(dies_1 == \"#вес\" || dies_2 == \"#вес\"){\n        flow.set(\"cmdOts1_61\",true);\n    }else if(dies_1 !== \"#вес\" && dies_2 !== \"#вес\"){\n        flow.set(\"cmdOts1_61\",false);\n    }\n\nvar last_mes = {\n    row1: dies_1,\n    row2: dies_2\n}\n\nflow.set(\"row1_61\", msg.payload.row1);\nflow.set(\"row2_61\", msg.payload.row2);\nflow.set(\"msgPayload_61\", last_mes);\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":960,"wires":[["a457fbd7.fe9cb8"]]},{"id":"e5608f2.ab8947","type":"switch","z":"ad19a7b.79d5458","name":"","property":"cmdOts1_61","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":190,"y":960,"wires":[["1a008e38.ca6e12"]]},{"id":"41d0aeab.ca73d","type":"inject","z":"ad19a7b.79d5458","name":"reset","topic":"","payload":"msgPayload_61","payloadType":"flow","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":1000,"wires":[["e5608f2.ab8947"]]},{"id":"a457fbd7.fe9cb8","type":"function","z":"ad19a7b.79d5458","name":"Дані строки з 1C","func":"var row1 = flow.get(\"row1_61\");\nvar row2 = flow.get(\"row2_61\");\n\n//msg.payload.row1 = flow.get(\"row1\");\n//msg.payload.row2 = flow.get(\"row2\");\n\n\nif(row1 == \"#вес\" ){\n   msg.payload.row1 = global.get(\"weight_60\");\n   msg.payload.row2 = flow.get(\"row2_61\"); \n   }else if(row2 == \"#вес\" ){\n   msg.payload.row2 = global.get(\"weight_60\");\n   msg.payload.row1 = flow.get(\"row1_61\"); \n}\n\n\nmsg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":470,"y":960,"wires":[["65ee7222.7dcffc"]]},{"id":"5b29257e.00dcac","type":"link in","z":"ad19a7b.79d5458","name":"60_т_1 команда з 1С","links":["c6aab831.664a18"],"x":155,"y":920,"wires":[["1a008e38.ca6e12"]]},{"id":"5938f63a.eee018","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":150,"y":460,"wires":[["36d6dce2.811134"]]},{"id":"36d6dce2.811134","type":"function","z":"ecb31b95.29a5e8","name":"init Змінні для події    #вага","func":"flow.set(\"cmdOts1_62\",false);\nflow.set(\"msgPayload_62\",{});\nflow.set(\"row1_62\",\"\");\nflow.set(\"row2_62\",\"\");\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":420,"wires":[[]]},{"id":"5b0d366a.6b4958","type":"function","z":"ecb31b95.29a5e8","name":"true","func":"var dies_1 = msg.payload.row1;\nvar dies_2 = msg.payload.row2;\n\n    if(dies_1 == \"#вес\" || dies_2 == \"#вес\"){\n        flow.set(\"cmdOts1_62\",true);\n    }else if(dies_1 !== \"#вес\" && dies_2 !== \"#вес\"){\n        flow.set(\"cmdOts1_62\",false);\n    }\n\nvar last_mes = {\n    row1: dies_1,\n    row2: dies_2\n}\n\nflow.set(\"row1_62\", msg.payload.row1);\nflow.set(\"row2_62\", msg.payload.row2);\nflow.set(\"msgPayload_62\", last_mes);\nreturn msg;","outputs":1,"noerr":0,"x":250,"y":380,"wires":[["f60e8d25.01664"]]},{"id":"f8e8792a.6e6238","type":"switch","z":"ecb31b95.29a5e8","name":"","property":"cmdOts1_62","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":130,"y":380,"wires":[["5b0d366a.6b4958"]]},{"id":"9c9d7c7f.54286","type":"inject","z":"ecb31b95.29a5e8","name":"reset","topic":"","payload":"msgPayload_62","payloadType":"flow","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":420,"wires":[["f8e8792a.6e6238"]]},{"id":"f60e8d25.01664","type":"function","z":"ecb31b95.29a5e8","name":"Дані строки з 1C","func":"var row1 = flow.get(\"row1_62\");\nvar row2 = flow.get(\"row2_62\");\n\n//msg.payload.row1 = flow.get(\"row1\");\n//msg.payload.row2 = flow.get(\"row2\");\n\n\nif(row1 == \"#вес\" ){\n   msg.payload.row1 = global.get(\"weight_60\");\n   msg.payload.row2 = flow.get(\"row2_62\"); \n   }else if(row2 == \"#вес\" ){\n   msg.payload.row2 = global.get(\"weight_60\");\n   msg.payload.row1 = flow.get(\"row1_62\"); \n}\n\n\nmsg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":410,"y":380,"wires":[["e19dcfaa.e1875"]]},{"id":"2d334690.13d1fa","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_3 команда з 1С","links":["7f02422e.bab85c"],"x":95,"y":340,"wires":[["5b0d366a.6b4958"]]},{"id":"f7cdd82c.e88c78","type":"inject","z":"ecb31b95.29a5e8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":190,"y":1080,"wires":[["fb175e22.1ce18"]]},{"id":"fb175e22.1ce18","type":"function","z":"ecb31b95.29a5e8","name":"init Змінні для події    #вага","func":"flow.set(\"cmdOts1_63\",false);\nflow.set(\"msgPayload_63\",{});\nflow.set(\"row1_63\",\"\");\nflow.set(\"row2_63\",\"\");\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":1040,"wires":[[]]},{"id":"c3f4ad9e.9866d","type":"function","z":"ecb31b95.29a5e8","name":"true","func":"var dies_1 = msg.payload.row1;\nvar dies_2 = msg.payload.row2;\n\n    if(dies_1 == \"#вес\" || dies_2 == \"#вес\"){\n        flow.set(\"cmdOts1_63\",true);\n    }else if(dies_1 !== \"#вес\" && dies_2 !== \"#вес\"){\n        flow.set(\"cmdOts1_63\",false);\n    }\n\nvar last_mes = {\n    row1: dies_1,\n    row2: dies_2\n}\n\nflow.set(\"row1_63\", msg.payload.row1);\nflow.set(\"row2_63\", msg.payload.row2);\nflow.set(\"msgPayload_63\", last_mes);\nreturn msg;","outputs":1,"noerr":0,"x":290,"y":1000,"wires":[["2bbb07d3.1af128"]]},{"id":"6fda94af.031c0c","type":"switch","z":"ecb31b95.29a5e8","name":"","property":"cmdOts1_63","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":170,"y":1000,"wires":[["c3f4ad9e.9866d"]]},{"id":"ad42a403.2c53c8","type":"inject","z":"ecb31b95.29a5e8","name":"reset","topic":"","payload":"msgPayload_63","payloadType":"flow","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":1040,"wires":[["6fda94af.031c0c"]]},{"id":"2bbb07d3.1af128","type":"function","z":"ecb31b95.29a5e8","name":"Дані строки з 1C","func":"var row1 = flow.get(\"row1_63\");\nvar row2 = flow.get(\"row2_63\");\n\n//msg.payload.row1 = flow.get(\"row1\");\n//msg.payload.row2 = flow.get(\"row2\");\n\n\nif(row1 == \"#вес\" ){\n   msg.payload.row1 = global.get(\"weight_60\");\n   msg.payload.row2 = flow.get(\"row2_63\"); \n   }else if(row2 == \"#вес\" ){\n   msg.payload.row2 = global.get(\"weight_60\");\n   msg.payload.row1 = flow.get(\"row1_63\"); \n}\n\n\nmsg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":450,"y":1000,"wires":[["e19dcfaa.e1875"]]},{"id":"eb79b4db.152f38","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_4 команда з 1С","links":["d6d6360e.e948d8"],"x":135,"y":960,"wires":[["c3f4ad9e.9866d"]]},{"id":"c0760f5.165d6f","type":"tcp in","z":"d5e818e4.8eb568","name":"","server":"server","host":"10.3.5.250","port":"2500","datamode":"stream","datatype":"utf8","newline":"","topic":"","base64":false,"x":150,"y":80,"wires":[["413bd671.fabf98"]]},{"id":"75a177f6.860408","type":"debug","z":"d5e818e4.8eb568","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":530,"y":80,"wires":[]},{"id":"413bd671.fabf98","type":"delay","z":"d5e818e4.8eb568","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":360,"y":80,"wires":[["75a177f6.860408","68863a27.640d24","8c36fcfe.28fd3","bcb96156.0ead"]]},{"id":"3adb981d.476be8","type":"link out","z":"d5e818e4.8eb568","name":"scale","links":["bc585b0.1b7a9a8"],"x":735,"y":120,"wires":[]},{"id":"68863a27.640d24","type":"function","z":"d5e818e4.8eb568","name":"глобальна змінна","func":"msg.payload = global.set(\"weight_80\",Number(msg.payload));\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":120,"wires":[["3adb981d.476be8"]]},{"id":"9a6a2590.d4f308","type":"debug","z":"d5e818e4.8eb568","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":740,"y":160,"wires":[]},{"id":"8c36fcfe.28fd3","type":"function","z":"d5e818e4.8eb568","name":"в дашборд","func":"msg.payload = Number(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":160,"wires":[["9a6a2590.d4f308","3adb981d.476be8"]]},{"id":"bcb96156.0ead","type":"function","z":"d5e818e4.8eb568","name":"set global zero weight","func":"var weight = Number(msg.payload);\n\nif (weight === 0){\n    global.set('zeroWeight_80',true);\n}\nreturn msg;","outputs":1,"noerr":0,"x":570,"y":200,"wires":[["40a270e1.1b47d"]]},{"id":"40a270e1.1b47d","type":"debug","z":"d5e818e4.8eb568","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":760,"y":200,"wires":[]},{"id":"bee9b9e3.edce68","type":"tcp in","z":"d5e818e4.8eb568","name":"","server":"server","host":"10.3.5.250","port":"2501","datamode":"stream","datatype":"utf8","newline":"","topic":"","base64":false,"x":110,"y":480,"wires":[["e3cadfdd.18b22"]]},{"id":"b35d5e4d.75614","type":"debug","z":"d5e818e4.8eb568","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":510,"y":480,"wires":[]},{"id":"e3cadfdd.18b22","type":"delay","z":"d5e818e4.8eb568","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":310,"y":480,"wires":[["b35d5e4d.75614","f0ae57f1.0e9fb8","53164f2f.91632","48399a60.830804"]]},{"id":"eb1b2b77.2de9f8","type":"link out","z":"d5e818e4.8eb568","name":"scale","links":["bc585b0.1b7a9a8"],"x":715,"y":520,"wires":[]},{"id":"f0ae57f1.0e9fb8","type":"function","z":"d5e818e4.8eb568","name":"глобальна змінна","func":"msg.payload = global.set(\"weight_60\",Number(msg.payload));\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":520,"wires":[["eb1b2b77.2de9f8"]]},{"id":"34ca465f.c9a42a","type":"debug","z":"d5e818e4.8eb568","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":740,"y":560,"wires":[]},{"id":"53164f2f.91632","type":"function","z":"d5e818e4.8eb568","name":"в дашборд","func":"msg.payload = Number(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":560,"wires":[["34ca465f.c9a42a","eb1b2b77.2de9f8"]]},{"id":"48399a60.830804","type":"function","z":"d5e818e4.8eb568","name":"set global zero weight","func":"var weight = Number(msg.payload);\n\nif (weight === 0){\n    global.set('zeroWeight_60',true);\n}\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":600,"wires":[["68628ae7.324194"]]},{"id":"68628ae7.324194","type":"debug","z":"d5e818e4.8eb568","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":740,"y":600,"wires":[]},{"id":"d9379585.3eec68","type":"comment","z":"d5e818e4.8eb568","name":"60 тон ваги","info":"","x":150,"y":420,"wires":[]},{"id":"d361c173.0e52","type":"comment","z":"d5e818e4.8eb568","name":"80 тон ваги","info":"","x":130,"y":40,"wires":[]},{"id":"214604e8.55d2ac","type":"function","z":"c7763c53.7c105","name":"Дані строки з форми СТ_0","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":460,"y":320,"wires":[["ac7f4f37.e0a5f"]]},{"id":"d17ec63f.077668","type":"ui_form","z":"bd734171.edc5f","name":"","label":"80 тонн, в\"їзд, Напрям до вагів","group":"6ddf97e1.cb79a8","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":210,"y":180,"wires":[["e1c4bea3.a194b"]]},{"id":"1980155.f0c3ceb","type":"ui_button","z":"bd734171.edc5f","name":"","group":"6ddf97e1.cb79a8","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":240,"y":220,"wires":[["bf732128.2b0b"]]},{"id":"d0dbfe00.a9c63","type":"ui_button","z":"bd734171.edc5f","name":"","group":"6ddf97e1.cb79a8","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":240,"y":260,"wires":[["1e56c4aa.f3d0ab"]]},{"id":"874e64ac.949868","type":"ui_button","z":"bd734171.edc5f","name":"","group":"6ddf97e1.cb79a8","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":240,"y":300,"wires":[["263dc70f.0aa658"]]},{"id":"e1c4bea3.a194b","type":"link out","z":"bd734171.edc5f","name":"80_т_вїзд_форма","links":["4b0c770d.4a6868"],"x":375,"y":180,"wires":[]},{"id":"bf732128.2b0b","type":"link out","z":"bd734171.edc5f","name":"80_т_вїзд_зелений","links":["b3fd6f56.0a5c9"],"x":355,"y":220,"wires":[]},{"id":"1e56c4aa.f3d0ab","type":"link out","z":"bd734171.edc5f","name":"80_т_вїзд_червоний","links":["1e6a5dce.180922"],"x":355,"y":260,"wires":[]},{"id":"263dc70f.0aa658","type":"link out","z":"bd734171.edc5f","name":"80_т_вїзд_погасити","links":["ae2dee07.c6e6b"],"x":355,"y":300,"wires":[]},{"id":"de270ecc.0c02c","type":"function","z":"812a160b.c93e38","name":"Дані строки з форми СТ_0","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":360,"wires":[["ba786a9.599a798"]]},{"id":"ebf9645b.95d818","type":"function","z":"812a160b.c93e38","name":"Дані строки з форми СТ_0","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":520,"y":760,"wires":[["ba786a9.599a798"]]},{"id":"4b0c770d.4a6868","type":"link in","z":"812a160b.c93e38","name":"80_т_2 форма","links":["e1c4bea3.a194b"],"x":315,"y":360,"wires":[["de270ecc.0c02c"]]},{"id":"b3fd6f56.0a5c9","type":"link in","z":"812a160b.c93e38","name":"80_т_2_зелений","links":["bf732128.2b0b","40880c66.9eebd4"],"x":275,"y":140,"wires":[["53e4e05.9307d2"]]},{"id":"1e6a5dce.180922","type":"link in","z":"812a160b.c93e38","name":"80_т_2 червоний","links":["1e56c4aa.f3d0ab","77863302.e7463c"],"x":275,"y":180,"wires":[["c6795937.914648"]]},{"id":"ae2dee07.c6e6b","type":"link in","z":"812a160b.c93e38","name":"80_т_2_погасити","links":["263dc70f.0aa658"],"x":275,"y":220,"wires":[["c10b37b0.279c88"]]},{"id":"a47fd3f2.bf7b6","type":"link in","z":"812a160b.c93e38","name":"80_т_1 форма","links":["493f53a.f1629ac"],"x":315,"y":760,"wires":[["ebf9645b.95d818"]]},{"id":"8e2f3663.a7d998","type":"link in","z":"812a160b.c93e38","name":"80_т_1 зелений","links":["d4c705b8.59ef58","51ffc9eb.0840b8"],"x":315,"y":860,"wires":[["3f984c85.bd5d74"]]},{"id":"af9f490b.efd3d8","type":"link in","z":"812a160b.c93e38","name":"80_т_1 червоний","links":["fcc6900b.fd672","f3ba0121.37e0b"],"x":315,"y":900,"wires":[["c641e115.e5626"]]},{"id":"2f41ceda.e534d2","type":"link in","z":"812a160b.c93e38","name":"80_т_1 погасити","links":["f633304e.1c3b"],"x":315,"y":940,"wires":[["a94f56a1.83c078"]]},{"id":"f65cc269.9d841","type":"comment","z":"bd734171.edc5f","name":"80 тонн, вїзд, від вагів","info":"","x":160,"y":360,"wires":[]},{"id":"65e289cd.d21028","type":"comment","z":"bd734171.edc5f","name":"80 тонн, вїзд, до вагів","info":"","x":160,"y":140,"wires":[]},{"id":"9cd7233.0a343e","type":"ui_form","z":"bd734171.edc5f","name":"","label":"80 тон, в\"їзд, Напрям від вагів","group":"6ddf97e1.cb79a8","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":190,"y":400,"wires":[["493f53a.f1629ac"]]},{"id":"2cc56082.a8957","type":"ui_button","z":"bd734171.edc5f","name":"","group":"6ddf97e1.cb79a8","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":220,"y":440,"wires":[["d4c705b8.59ef58"]]},{"id":"7616cea6.c7866","type":"ui_button","z":"bd734171.edc5f","name":"","group":"6ddf97e1.cb79a8","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":220,"y":480,"wires":[["fcc6900b.fd672"]]},{"id":"942aed9e.5eb2a","type":"ui_button","z":"bd734171.edc5f","name":"","group":"6ddf97e1.cb79a8","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":220,"y":520,"wires":[["f633304e.1c3b"]]},{"id":"493f53a.f1629ac","type":"link out","z":"bd734171.edc5f","name":"80 тонн, вїзд, від вагів_ФОРМА","links":["a47fd3f2.bf7b6"],"x":355,"y":400,"wires":[]},{"id":"d4c705b8.59ef58","type":"link out","z":"bd734171.edc5f","name":"80 тонн, вїзд, від вагів ЗЕЛЕНЕ","links":["8e2f3663.a7d998"],"x":315,"y":440,"wires":[]},{"id":"fcc6900b.fd672","type":"link out","z":"bd734171.edc5f","name":"80 тонн, вїзд, від вагів ЧЕРВОНЕ","links":["af9f490b.efd3d8"],"x":315,"y":480,"wires":[]},{"id":"f633304e.1c3b","type":"link out","z":"bd734171.edc5f","name":"80 тонн, вїзд, від вагів ПОГАСИТИ","links":["2f41ceda.e534d2"],"x":315,"y":520,"wires":[]},{"id":"69d8eab2.86cb54","type":"comment","z":"bd734171.edc5f","name":"80 тон, виїзд, до вагів","info":"","x":600,"y":140,"wires":[]},{"id":"aff85685.27bc58","type":"comment","z":"bd734171.edc5f","name":"80 тон, виїзд, від вагів","info":"","x":600,"y":360,"wires":[]},{"id":"9a8d3be4.194c98","type":"ui_form","z":"bd734171.edc5f","name":"","label":"80 тон, виїзд, Напрям до вагів","group":"2d7e0681.e8843a","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":610,"y":180,"wires":[["9613b25a.d94ff"]]},{"id":"7420141c.007fec","type":"ui_button","z":"bd734171.edc5f","name":"","group":"2d7e0681.e8843a","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":640,"y":220,"wires":[["d3ad5b19.b8f148"]]},{"id":"ed970a06.870e58","type":"ui_button","z":"bd734171.edc5f","name":"","group":"2d7e0681.e8843a","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":640,"y":260,"wires":[["dedd2d36.e8efe"]]},{"id":"a7134e7d.a125b","type":"ui_button","z":"bd734171.edc5f","name":"","group":"2d7e0681.e8843a","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":640,"y":300,"wires":[["235a06d8.0621ca"]]},{"id":"c913de92.0111a","type":"ui_form","z":"bd734171.edc5f","name":"","label":"80 тон, виїзд, Нарпям від вагів","group":"2d7e0681.e8843a","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":610,"y":400,"wires":[["b7ba9ee3.06c3f"]]},{"id":"4e968143.733f","type":"ui_button","z":"bd734171.edc5f","name":"","group":"2d7e0681.e8843a","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":640,"y":440,"wires":[["dbbf7113.98466"]]},{"id":"d4a0f4a6.773048","type":"ui_button","z":"bd734171.edc5f","name":"","group":"2d7e0681.e8843a","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":640,"y":480,"wires":[["f6a43b35.4d21a8"]]},{"id":"d1af1697.60ad98","type":"ui_button","z":"bd734171.edc5f","name":"","group":"2d7e0681.e8843a","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":640,"y":520,"wires":[["1c74de63.c29102"]]},{"id":"d3ad5b19.b8f148","type":"link out","z":"bd734171.edc5f","name":"","links":["93c94e02.25b19"],"x":755,"y":220,"wires":[]},{"id":"9613b25a.d94ff","type":"link out","z":"bd734171.edc5f","name":"","links":["40918cb8.4ccdd4"],"x":775,"y":180,"wires":[]},{"id":"dedd2d36.e8efe","type":"link out","z":"bd734171.edc5f","name":"","links":["79df4d11.2806e4"],"x":755,"y":260,"wires":[]},{"id":"235a06d8.0621ca","type":"link out","z":"bd734171.edc5f","name":"","links":["6f8c8ae8.baf964"],"x":755,"y":300,"wires":[]},{"id":"b7ba9ee3.06c3f","type":"link out","z":"bd734171.edc5f","name":"","links":["d3c1d935.ce5eb8"],"x":775,"y":400,"wires":[]},{"id":"dbbf7113.98466","type":"link out","z":"bd734171.edc5f","name":"","links":["89af50ca.9bfc2"],"x":755,"y":440,"wires":[]},{"id":"f6a43b35.4d21a8","type":"link out","z":"bd734171.edc5f","name":"","links":["b7cb0d24.d8966"],"x":755,"y":480,"wires":[]},{"id":"1c74de63.c29102","type":"link out","z":"bd734171.edc5f","name":"","links":["3ac0ba0a.0f3136"],"x":755,"y":520,"wires":[]},{"id":"93c94e02.25b19","type":"link in","z":"c7763c53.7c105","name":"80_т_3 зелене","links":["d3ad5b19.b8f148","33bd420a.33109e"],"x":215,"y":100,"wires":[["98e0613e.ddd32"]]},{"id":"79df4d11.2806e4","type":"link in","z":"c7763c53.7c105","name":"80_т_3 червоне","links":["dedd2d36.e8efe","c0787d08.c5e3a","fb949747.6cf128"],"x":215,"y":140,"wires":[["af59a754.426b78"]]},{"id":"6f8c8ae8.baf964","type":"link in","z":"c7763c53.7c105","name":"80_т_3 погасити","links":["235a06d8.0621ca"],"x":215,"y":180,"wires":[["a8829c6f.f45fc"]]},{"id":"40918cb8.4ccdd4","type":"link in","z":"c7763c53.7c105","name":"80_т_3 форма","links":["9613b25a.d94ff"],"x":215,"y":320,"wires":[["214604e8.55d2ac"]]},{"id":"89af50ca.9bfc2","type":"link in","z":"c7763c53.7c105","name":"80_т_4 зелене","links":["dbbf7113.98466","52293544.86bdec"],"x":215,"y":740,"wires":[["c1b54c1e.e3f2d"]]},{"id":"b7cb0d24.d8966","type":"link in","z":"c7763c53.7c105","name":"80_т_4 червоне","links":["f6a43b35.4d21a8","5671e788.eb5c08"],"x":215,"y":780,"wires":[["fb986830.39b5c8"]]},{"id":"3ac0ba0a.0f3136","type":"link in","z":"c7763c53.7c105","name":"80_т_4 погасити","links":["1c74de63.c29102"],"x":215,"y":820,"wires":[["626486b1.311ad8"]]},{"id":"4491aae8.5c06e4","type":"function","z":"c7763c53.7c105","name":"Дані строки з форми СТ_1","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":880,"wires":[["ac7f4f37.e0a5f"]]},{"id":"d3c1d935.ce5eb8","type":"link in","z":"c7763c53.7c105","name":"80_т_4 форма","links":["b7ba9ee3.06c3f"],"x":215,"y":860,"wires":[["4491aae8.5c06e4"]]},{"id":"ec481.a7c12b7f8","type":"link in","z":"ad19a7b.79d5458","name":"60_т_2 зелене","links":["55c18731.14e4e8","539b82f2.376b0c"],"x":260,"y":160,"wires":[["2ded541a.93d5cc"]]},{"id":"a9eea2de.573a4","type":"link in","z":"ad19a7b.79d5458","name":"60_т_2 черовне","links":["65a019c0.0ed6e8","bbb7b58.ce77048"],"x":255,"y":200,"wires":[["fd86d180.ba80f"]]},{"id":"9b4ef465.c23ec8","type":"link in","z":"ad19a7b.79d5458","name":"60_т_2 погасити","links":["72b30486.32513c"],"x":255,"y":240,"wires":[["1516693.a106d97"]]},{"id":"6e8c30b8.ea72b","type":"link in","z":"ad19a7b.79d5458","name":"60_т_2 форма","links":["efdbf813.36d128"],"x":255,"y":280,"wires":[["2a3ec338.f6832c"]]},{"id":"2a3ec338.f6832c","type":"function","z":"ad19a7b.79d5458","name":"Дані строки з форми СТ_1","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":540,"y":340,"wires":[["65ee7222.7dcffc"]]},{"id":"c7ce6413.ba5918","type":"function","z":"ad19a7b.79d5458","name":"Дані строки з форми СТ_0","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":660,"wires":[["65ee7222.7dcffc"]]},{"id":"4dc3a577.1e090c","type":"link in","z":"ad19a7b.79d5458","name":"60_т_1 погасити","links":["9f9c2a2.c3dead8"],"x":235,"y":840,"wires":[["72bbded1.c49c3"]]},{"id":"9703731.a3f749","type":"link in","z":"ad19a7b.79d5458","name":"60_т_1 червоне","links":["c1e40678.c6fb68","80b35d74.28237"],"x":235,"y":800,"wires":[["154e7e05.226402"]]},{"id":"5f586438.784fec","type":"link in","z":"ad19a7b.79d5458","name":"60_т_1 зелене","links":["98fb045a.32ceb8","20e56f48.a0cec"],"x":235,"y":760,"wires":[["e6db6302.7704f"]]},{"id":"70aa524d.93aa3c","type":"link in","z":"ad19a7b.79d5458","name":"60_т_1 форма","links":["655b136e.5c5b8c"],"x":235,"y":660,"wires":[["c7ce6413.ba5918"]]},{"id":"f7b58d10.20844","type":"ui_form","z":"bd734171.edc5f","name":"","label":"60 тонн, в\"їзд, Напрям до вагів","group":"d7af4cdd.f08d5","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":990,"y":180,"wires":[["efdbf813.36d128"]]},{"id":"89c38288.e7929","type":"ui_button","z":"bd734171.edc5f","name":"","group":"d7af4cdd.f08d5","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":1020,"y":220,"wires":[["55c18731.14e4e8"]]},{"id":"c4679774.5ee848","type":"ui_button","z":"bd734171.edc5f","name":"","group":"d7af4cdd.f08d5","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":1020,"y":260,"wires":[["65a019c0.0ed6e8"]]},{"id":"222f4adf.f4c436","type":"ui_button","z":"bd734171.edc5f","name":"","group":"d7af4cdd.f08d5","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":1020,"y":300,"wires":[["72b30486.32513c"]]},{"id":"efdbf813.36d128","type":"link out","z":"bd734171.edc5f","name":"60 тонн, в\"їзд, Напрям до вагів ФОРМА(2)","links":["6e8c30b8.ea72b"],"x":1155,"y":180,"wires":[]},{"id":"55c18731.14e4e8","type":"link out","z":"bd734171.edc5f","name":"60 тонн, в\"їзд, Напрям до вагів зЕЛЕНИЙ(2)","links":["ec481.a7c12b7f8"],"x":1135,"y":220,"wires":[]},{"id":"65a019c0.0ed6e8","type":"link out","z":"bd734171.edc5f","name":"60 тонн, в\"їзд, Напрям до вагів чЕРВОНИЙ(2)","links":["a9eea2de.573a4"],"x":1135,"y":260,"wires":[]},{"id":"72b30486.32513c","type":"link out","z":"bd734171.edc5f","name":"60 тонн, в\"їзд, Напрям до вагів ПОГАСИТИ(2)","links":["9b4ef465.c23ec8"],"x":1135,"y":300,"wires":[]},{"id":"25ca6466.8d1b2c","type":"comment","z":"bd734171.edc5f","name":"60 тонн, вїзд, до вагів","info":"","x":940,"y":140,"wires":[]},{"id":"20e0b235.cc156e","type":"comment","z":"bd734171.edc5f","name":"60 тонн, вїзд, від вагів","info":"","x":960,"y":360,"wires":[]},{"id":"3b7b5418.1a94ac","type":"ui_form","z":"bd734171.edc5f","name":"","label":"60 тон, в\"їзд, Напрям від вагів","group":"d7af4cdd.f08d5","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":990,"y":400,"wires":[["655b136e.5c5b8c"]]},{"id":"327a4a54.90c916","type":"ui_button","z":"bd734171.edc5f","name":"","group":"d7af4cdd.f08d5","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":1020,"y":440,"wires":[["98fb045a.32ceb8"]]},{"id":"2fe0818.fb27a7e","type":"ui_button","z":"bd734171.edc5f","name":"","group":"d7af4cdd.f08d5","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":1020,"y":480,"wires":[["c1e40678.c6fb68"]]},{"id":"d145a9c3.b2a1d8","type":"ui_button","z":"bd734171.edc5f","name":"","group":"d7af4cdd.f08d5","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":1020,"y":520,"wires":[["9f9c2a2.c3dead8"]]},{"id":"655b136e.5c5b8c","type":"link out","z":"bd734171.edc5f","name":"60 тонн, вїзд, від вагів_ФОРМА(2)","links":["70aa524d.93aa3c"],"x":1155,"y":400,"wires":[]},{"id":"98fb045a.32ceb8","type":"link out","z":"bd734171.edc5f","name":"60 тонн, вїзд, від вагів_ЗЕЛЕНЕ(2)","links":["5f586438.784fec"],"x":1115,"y":440,"wires":[]},{"id":"c1e40678.c6fb68","type":"link out","z":"bd734171.edc5f","name":"60 тонн, вїзд, від вагів_ЧЕРВОНЕ(2)","links":["9703731.a3f749"],"x":1115,"y":480,"wires":[]},{"id":"9f9c2a2.c3dead8","type":"link out","z":"bd734171.edc5f","name":"60 тонн, вїзд, від вагів_ПОГАСИТИ(2)","links":["4dc3a577.1e090c"],"x":1115,"y":520,"wires":[]},{"id":"47c84400.fc7d5c","type":"comment","z":"bd734171.edc5f","name":"60 тон, виїзд, до вагів","info":"","x":1340,"y":140,"wires":[]},{"id":"ccda555a.e247b8","type":"comment","z":"bd734171.edc5f","name":"60 тон, виїзд, від вагів","info":"","x":1340,"y":360,"wires":[]},{"id":"5f1215a8.a1707c","type":"ui_form","z":"bd734171.edc5f","name":"","label":"60 тон, виїзд, Напрям до вагів","group":"fbbab3d2.f8787","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":1350,"y":180,"wires":[["ab85c99d.e291f8"]]},{"id":"45de5bac.e6c6f4","type":"ui_button","z":"bd734171.edc5f","name":"","group":"fbbab3d2.f8787","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":1380,"y":220,"wires":[["c42d97bc.ca21c8"]]},{"id":"8428873e.456008","type":"ui_button","z":"bd734171.edc5f","name":"","group":"fbbab3d2.f8787","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":1380,"y":260,"wires":[["37047d43.8e32b2"]]},{"id":"902fe8a4.2279e8","type":"ui_button","z":"bd734171.edc5f","name":"","group":"fbbab3d2.f8787","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":1380,"y":300,"wires":[["983f40d2.afba5"]]},{"id":"29c5a67c.5bc1da","type":"ui_form","z":"bd734171.edc5f","name":"","label":"60 тон, виїзд, Нарпям від вагів","group":"fbbab3d2.f8787","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":1350,"y":400,"wires":[["79ff6fae.0e0b9"]]},{"id":"b13d7811.fd96e8","type":"ui_button","z":"bd734171.edc5f","name":"","group":"fbbab3d2.f8787","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":1380,"y":440,"wires":[["4c6aeb5c.08fec4"]]},{"id":"bb05da48.3f8b18","type":"ui_button","z":"bd734171.edc5f","name":"","group":"fbbab3d2.f8787","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":1380,"y":480,"wires":[["d88039da.52cfa8"]]},{"id":"a16f6757.0e10f8","type":"ui_button","z":"bd734171.edc5f","name":"","group":"fbbab3d2.f8787","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":1380,"y":520,"wires":[["bdfcbc52.6e4c6"]]},{"id":"c42d97bc.ca21c8","type":"link out","z":"bd734171.edc5f","name":"6_Т_З_(4)","links":["df25823e.925e6"],"x":1495,"y":220,"wires":[]},{"id":"ab85c99d.e291f8","type":"link out","z":"bd734171.edc5f","name":"6_Т_Ф_(4)","links":["b675e86.8a57b18"],"x":1515,"y":180,"wires":[]},{"id":"37047d43.8e32b2","type":"link out","z":"bd734171.edc5f","name":"6_Т_Ч_(4)","links":["13dc76e4.2cf349"],"x":1495,"y":260,"wires":[]},{"id":"983f40d2.afba5","type":"link out","z":"bd734171.edc5f","name":"6_Т_П_(4)","links":["5a71d32d.b6113c"],"x":1495,"y":300,"wires":[]},{"id":"79ff6fae.0e0b9","type":"link out","z":"bd734171.edc5f","name":"6_Т_ВІД_Ф_(4)","links":["645e4f9b.e61c2"],"x":1515,"y":400,"wires":[]},{"id":"4c6aeb5c.08fec4","type":"link out","z":"bd734171.edc5f","name":"6_Т_ВІД_З_(4)","links":["20a8d6dd.a5245a"],"x":1495,"y":440,"wires":[]},{"id":"d88039da.52cfa8","type":"link out","z":"bd734171.edc5f","name":"6_Т_ВІД_Ч_(4)","links":["8953f08e.93fd6"],"x":1495,"y":480,"wires":[]},{"id":"bdfcbc52.6e4c6","type":"link out","z":"bd734171.edc5f","name":"6_Т_ВІД_П_(4)","links":["c799e78a.ad27e8"],"x":1495,"y":520,"wires":[]},{"id":"df25823e.925e6","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_3 зелене","links":["c42d97bc.ca21c8","3b837127.dcddde"],"x":260,"y":140,"wires":[["6edbbbf1.9728b4"]]},{"id":"13dc76e4.2cf349","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_3 червоне","links":["37047d43.8e32b2"],"x":255,"y":180,"wires":[["3bfd35bd.05610a"]]},{"id":"5a71d32d.b6113c","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_3 погасити","links":["983f40d2.afba5"],"x":255,"y":220,"wires":[["f5b91b41.49c608"]]},{"id":"b675e86.8a57b18","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_3 форма","links":["ab85c99d.e291f8"],"x":255,"y":260,"wires":[["a71f55e2.c6adc8"]]},{"id":"c799e78a.ad27e8","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_4 погасити","links":["bdfcbc52.6e4c6"],"x":275,"y":840,"wires":[["ac7bb142.fe4bf"]]},{"id":"8953f08e.93fd6","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_4 червоний","links":["d88039da.52cfa8","6c2b0359.0cdf6c"],"x":275,"y":800,"wires":[["eb6b534d.2eaba"]]},{"id":"20a8d6dd.a5245a","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_4 зелене","links":["4c6aeb5c.08fec4","7828205f.88cbb"],"x":275,"y":760,"wires":[["5b872c39.d453d4"]]},{"id":"645e4f9b.e61c2","type":"link in","z":"ecb31b95.29a5e8","name":"60_т_4 форма","links":["79ff6fae.0e0b9"],"x":280,"y":720,"wires":[["338aed09.822ba2"]]},{"id":"a71f55e2.c6adc8","type":"function","z":"ecb31b95.29a5e8","name":"Дані строки з форми СТ_1","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":500,"y":320,"wires":[["e19dcfaa.e1875"]]},{"id":"338aed09.822ba2","type":"function","z":"ecb31b95.29a5e8","name":"Дані строки з форми СТ_0","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":700,"wires":[["e19dcfaa.e1875"]]},{"id":"9f713658.992148","type":"http in","z":"2e903c22.f77534","name":"","url":"/api/platform/setBoardText","method":"post","upload":false,"swaggerDoc":"","x":130,"y":1080,"wires":[["4781cb22.5e6f44"]]},{"id":"4781cb22.5e6f44","type":"function","z":"2e903c22.f77534","name":"get boarad ID","func":"msg.ip      = msg.req.query.boardID;\nreturn msg;","outputs":"1","noerr":0,"x":380,"y":1080,"wires":[["6a51005f.de176","274ddb6.0624624"]]},{"id":"274ddb6.0624624","type":"http response","z":"2e903c22.f77534","name":"","statusCode":"","headers":{},"x":470,"y":1140,"wires":[]},{"id":"6a51005f.de176","type":"switch","z":"2e903c22.f77534","name":"boards","property":"ip","propertyType":"msg","rules":[{"t":"eq","v":"80t_1","vt":"str"},{"t":"eq","v":"80t_2","vt":"str"},{"t":"eq","v":"80t_3","vt":"str"},{"t":"eq","v":"80t_4","vt":"str"},{"t":"eq","v":"60t_1","vt":"str"},{"t":"eq","v":"60t_2","vt":"str"},{"t":"eq","v":"60t_3","vt":"str"},{"t":"eq","v":"60t_4","vt":"str"}],"checkall":"true","repair":false,"outputs":8,"x":620,"y":1080,"wires":[["bd9d95e2.fc34f8"],["673e4096.295fc"],["d7647786.a75638"],["38ab168.9e321ea"],["c6aab831.664a18"],["aeb4136b.a2c1d"],["7f02422e.bab85c"],["d6d6360e.e948d8"]]},{"id":"bd9d95e2.fc34f8","type":"link out","z":"2e903c22.f77534","name":"","links":["1d1a2793.639e68"],"x":815,"y":960,"wires":[]},{"id":"673e4096.295fc","type":"link out","z":"2e903c22.f77534","name":"","links":["d8d74af5.e80178"],"x":815,"y":1000,"wires":[]},{"id":"d7647786.a75638","type":"link out","z":"2e903c22.f77534","name":"","links":["fc39a7a8.b713c8"],"x":815,"y":1040,"wires":[]},{"id":"38ab168.9e321ea","type":"link out","z":"2e903c22.f77534","name":"","links":["af644280.09ac6"],"x":815,"y":1080,"wires":[]},{"id":"c6aab831.664a18","type":"link out","z":"2e903c22.f77534","name":"","links":["5b29257e.00dcac"],"x":815,"y":1120,"wires":[]},{"id":"aeb4136b.a2c1d","type":"link out","z":"2e903c22.f77534","name":"","links":["22b7aa0e.1c3e86"],"x":815,"y":1160,"wires":[]},{"id":"7f02422e.bab85c","type":"link out","z":"2e903c22.f77534","name":"","links":["2d334690.13d1fa"],"x":815,"y":1200,"wires":[]},{"id":"d6d6360e.e948d8","type":"link out","z":"2e903c22.f77534","name":"","links":["eb79b4db.152f38"],"x":815,"y":1240,"wires":[]},{"id":"a07fc10f.eafe","type":"http in","z":"2e903c22.f77534","name":"","url":"/api/platform/setReaderConfigDisp","method":"post","upload":false,"swaggerDoc":"","x":160,"y":1440,"wires":[["96e81d28.ebd5e"]]},{"id":"96e81d28.ebd5e","type":"function","z":"2e903c22.f77534","name":"get cmd and light id","func":"msg.ip      = msg.req.query.rfidID;\nmsg.cmd     = msg.payload.cmd;\nreturn msg;","outputs":"1","noerr":0,"x":450,"y":1440,"wires":[["98d5b75c.ec0a68"]]},{"id":"98d5b75c.ec0a68","type":"switch","z":"2e903c22.f77534","name":"lights","property":"ip","propertyType":"msg","rules":[{"t":"eq","v":"80t_1","vt":"str"},{"t":"eq","v":"80t_2","vt":"str"},{"t":"eq","v":"80t_3","vt":"str"},{"t":"eq","v":"80t_4","vt":"str"},{"t":"eq","v":"60t_1","vt":"str"},{"t":"eq","v":"60t_2","vt":"str"},{"t":"eq","v":"60t_3","vt":"str"},{"t":"eq","v":"60t_4","vt":"str"}],"checkall":"true","repair":false,"outputs":8,"x":630,"y":1420,"wires":[["c9b7678f.4bde18"],["7ad13a57.ecb2c4"],["f675768a.307078"],["9a44b82e.272078"],["be98339b.796"],["bc6be1c2.b607b"],["84b9e90d.0fba18"],["13449b89.7b61f4"]]},{"id":"c9b7678f.4bde18","type":"switch","z":"2e903c22.f77534","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":1160,"wires":[["51ffc9eb.0840b8"],["f3ba0121.37e0b"]]},{"id":"7ad13a57.ecb2c4","type":"switch","z":"2e903c22.f77534","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":1240,"wires":[["40880c66.9eebd4"],["77863302.e7463c"]]},{"id":"f675768a.307078","type":"switch","z":"2e903c22.f77534","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":1320,"wires":[["33bd420a.33109e"],["c0787d08.c5e3a"]]},{"id":"9a44b82e.272078","type":"switch","z":"2e903c22.f77534","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":1400,"wires":[["52293544.86bdec"],["5671e788.eb5c08"]]},{"id":"be98339b.796","type":"switch","z":"2e903c22.f77534","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":1480,"wires":[["20e56f48.a0cec"],["80b35d74.28237"]]},{"id":"bc6be1c2.b607b","type":"switch","z":"2e903c22.f77534","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":1580,"wires":[["539b82f2.376b0c"],["bbb7b58.ce77048"]]},{"id":"84b9e90d.0fba18","type":"switch","z":"2e903c22.f77534","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":1660,"wires":[["3b837127.dcddde"],["fb949747.6cf128"]]},{"id":"13449b89.7b61f4","type":"switch","z":"2e903c22.f77534","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":1740,"wires":[["7828205f.88cbb"],["6c2b0359.0cdf6c"]]},{"id":"51ffc9eb.0840b8","type":"link out","z":"2e903c22.f77534","name":"80t_1_green_out","links":["8e2f3663.a7d998"],"x":1055,"y":1140,"wires":[]},{"id":"f3ba0121.37e0b","type":"link out","z":"2e903c22.f77534","name":"80t_1_red_out","links":["af9f490b.efd3d8"],"x":1055,"y":1180,"wires":[]},{"id":"40880c66.9eebd4","type":"link out","z":"2e903c22.f77534","name":"80t_2_green_out","links":["b3fd6f56.0a5c9"],"x":1055,"y":1220,"wires":[]},{"id":"77863302.e7463c","type":"link out","z":"2e903c22.f77534","name":"80t_2_red_out","links":["1e6a5dce.180922"],"x":1055,"y":1260,"wires":[]},{"id":"33bd420a.33109e","type":"link out","z":"2e903c22.f77534","name":"80t_3_green_out","links":["93c94e02.25b19"],"x":1055,"y":1300,"wires":[]},{"id":"c0787d08.c5e3a","type":"link out","z":"2e903c22.f77534","name":"80t_3_red_out","links":["79df4d11.2806e4"],"x":1055,"y":1340,"wires":[]},{"id":"52293544.86bdec","type":"link out","z":"2e903c22.f77534","name":"80t_4_green_out","links":["89af50ca.9bfc2"],"x":1055,"y":1380,"wires":[]},{"id":"5671e788.eb5c08","type":"link out","z":"2e903c22.f77534","name":"80t_4_red_out","links":["b7cb0d24.d8966"],"x":1055,"y":1420,"wires":[]},{"id":"80b35d74.28237","type":"link out","z":"2e903c22.f77534","name":"60t_1_red_out","links":["9703731.a3f749"],"x":1055,"y":1500,"wires":[]},{"id":"20e56f48.a0cec","type":"link out","z":"2e903c22.f77534","name":"60t_1_green_out","links":["5f586438.784fec"],"x":1055,"y":1460,"wires":[]},{"id":"bbb7b58.ce77048","type":"link out","z":"2e903c22.f77534","name":"60t_2_red_out","links":["a9eea2de.573a4"],"x":1055,"y":1580,"wires":[]},{"id":"539b82f2.376b0c","type":"link out","z":"2e903c22.f77534","name":"60t_2_green_out","links":["ec481.a7c12b7f8"],"x":1055,"y":1540,"wires":[]},{"id":"fb949747.6cf128","type":"link out","z":"2e903c22.f77534","name":"60t_3_red_out","links":["79df4d11.2806e4"],"x":1055,"y":1660,"wires":[]},{"id":"3b837127.dcddde","type":"link out","z":"2e903c22.f77534","name":"60t_3_green_out","links":["df25823e.925e6"],"x":1055,"y":1620,"wires":[]},{"id":"6c2b0359.0cdf6c","type":"link out","z":"2e903c22.f77534","name":"60t_4_red_out","links":["8953f08e.93fd6"],"x":1055,"y":1740,"wires":[]},{"id":"7828205f.88cbb","type":"link out","z":"2e903c22.f77534","name":"60t_4_green_out","links":["20a8d6dd.a5245a"],"x":1055,"y":1700,"wires":[]}]
