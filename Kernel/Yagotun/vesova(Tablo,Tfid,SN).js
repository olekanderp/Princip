[{"id":"8240f32a.64e8d","type":"tab","label":"RFID UHF"},{"id":"cdafab9f.08d118","type":"tab","label":"Табло 1 (СТ 1 і 2)","disabled":false,"info":""},{"id":"8f9d800c.7cdf4","type":"tab","label":"Табло 2 (СТ 1 і 2)","disabled":false,"info":""},{"id":"40dcdbed.95c274","type":"tab","label":"Зчитувач","disabled":false,"info":""},{"id":"17b156e0.3aac29","type":"tab","label":"Периметр","disabled":false,"info":""},{"id":"58118560.4b14cc","type":"tab","label":"Ваги","disabled":false,"info":""},{"id":"16ab13ed.699cdc","type":"tab","label":"Dashboard","disabled":false,"info":""},{"id":"63e63968.916938","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"f049111d.b9ba2","type":"subflow","name":"ETTN","info":"","in":[],"out":[]},{"id":"5df307b.7f71cf8","type":"subflow","name":"Subflow 1","info":"","in":[],"out":[]},{"id":"dee24f35.bc1eb","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#007ace","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#0e1b6a","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#007ace","edited":true},"page-titlebar-backgroundColor":{"value":"#007ace","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1ba2ff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#007ace","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"e9f9a8a1.a26618","type":"ui_group","z":"","name":"Зчитувачі","tab":"ded5b23.f17bc5","order":5,"disp":true,"width":"6","collapse":false},{"id":"ded5b23.f17bc5","type":"ui_tab","z":"","name":"Monitoring","icon":"dashboard","disabled":false,"hidden":false},{"id":"6a5b2eb3.f08ef","type":"ui_group","z":"","name":"Вага","tab":"ded5b23.f17bc5","order":6,"disp":true,"width":"6","collapse":false},{"id":"455cc101.994c1","type":"ui_group","z":"","name":"Периметр","tab":"ded5b23.f17bc5","order":7,"disp":true,"width":"5","collapse":false},{"id":"7e42aaa1.8169f4","type":"ui_group","z":"","name":"Табло 1 IN Сторона 1","tab":"ded5b23.f17bc5","order":2,"disp":true,"width":"6","collapse":false},{"id":"d1c5dc93.0d61d","type":"ui_group","z":"","name":"Табло 1 IN Сторона 0","tab":"ded5b23.f17bc5","order":1,"disp":true,"width":"6","collapse":false},{"id":"401b5c7b.57cf84","type":"ui_group","z":"","name":"Табло 2 OUT Сторона 0","tab":"ded5b23.f17bc5","order":3,"disp":true,"width":"6","collapse":false},{"id":"7959d802.3ba6c8","type":"ui_group","z":"","name":"Табло 2 OUT Сторона 1","tab":"ded5b23.f17bc5","order":4,"disp":true,"width":"6","collapse":false},{"id":"9c4ec8df.e8c3f8","type":"exec","z":"40dcdbed.95c274","command":"node /home/pi/wiegan/app.js","addpay":true,"append":"","useSpawn":"true","timer":"","oldrc":false,"name":"","x":340,"y":100,"wires":[["6fa1007a.613f5"],[],[]]},{"id":"aedacfe8.a5a76","type":"inject","z":"40dcdbed.95c274","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":110,"y":160,"wires":[["9c4ec8df.e8c3f8","e7bd5d10.1a24a","ebbbbf1b.6fc38"]]},{"id":"e7bd5d10.1a24a","type":"exec","z":"40dcdbed.95c274","command":"node /home/pi/wiegan/app_1.js","addpay":true,"append":"","useSpawn":"true","timer":"","oldrc":false,"name":"","x":350,"y":240,"wires":[["8d2750c8.13d78"],[],[]]},{"id":"ebbbbf1b.6fc38","type":"exec","z":"40dcdbed.95c274","command":"node /home/pi/wiegan/app_2.js","addpay":true,"append":"","useSpawn":"true","timer":"","oldrc":false,"name":"","x":350,"y":380,"wires":[["e837e947.e18e78"],[],[]]},{"id":"e8642214.68de","type":"debug","z":"40dcdbed.95c274","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":770,"y":360,"wires":[]},{"id":"a36e99b6.42a1e8","type":"Wiegand","z":"40dcdbed.95c274","name":"Gpio RFID 17 18 Init","host":"17","timer":"18","x":340,"y":40,"wires":[[]]},{"id":"3378f055.b60f8","type":"Wiegand","z":"40dcdbed.95c274","name":"Gpio RFID 22 23 Init","host":"22","timer":"23","x":340,"y":180,"wires":[[]]},{"id":"8064ca21.6572b8","type":"Wiegand","z":"40dcdbed.95c274","name":"Gpio RFID 25 5 Init","host":"25","timer":"5","x":330,"y":320,"wires":[[]]},{"id":"22c504b9.a16a4c","type":"comment","z":"40dcdbed.95c274","name":"Охорона","info":"","x":140,"y":380,"wires":[]},{"id":"38ad4b55.1f5584","type":"comment","z":"40dcdbed.95c274","name":"Вїзд","info":"","x":130,"y":100,"wires":[]},{"id":"aa394268.f1e3a","type":"comment","z":"40dcdbed.95c274","name":"Виїзд","info":"","x":130,"y":240,"wires":[]},{"id":"ec96cff.b24cf3","type":"debug","z":"17b156e0.3aac29","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":390,"y":100,"wires":[]},{"id":"ae90f454.dcf108","type":"debug","z":"17b156e0.3aac29","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":390,"y":200,"wires":[]},{"id":"d47d12b1.d5e85","type":"comment","z":"17b156e0.3aac29","name":"Виїзд Init","info":"","x":200,"y":40,"wires":[]},{"id":"1729ce58.1fb8a2","type":"comment","z":"17b156e0.3aac29","name":"Вїзд Init","info":"","x":190,"y":160,"wires":[]},{"id":"65a4554e.7c2bac","type":"comment","z":"17b156e0.3aac29","name":"1 Не пересічено: 0 Пересічено","info":"","x":410,"y":40,"wires":[]},{"id":"24499bf4.7729a4","type":"link out","z":"40dcdbed.95c274","name":"ЗЧ Вїзд","links":["de0306a3.44eb18","d7e31676.44ef28","6e922916.48a198","38e0f8e5.10ab38","96e400b2.8de26","e5e3183b.113088"],"x":675,"y":40,"wires":[]},{"id":"d140e40a.1d6fc8","type":"link out","z":"40dcdbed.95c274","name":"ЗЧ Виїзд","links":["7f9b68cc.93c368","2039c89d.c40578","84650412.8eddc8","370a49db.efffe6"],"x":695,"y":180,"wires":[]},{"id":"2dc8481b.c01a28","type":"link out","z":"40dcdbed.95c274","name":"ЗЧ Охорона","links":["de0306a3.44eb18","c3c1173.da750e8","e3fecac1.084838","38e0f8e5.10ab38","96e400b2.8de26","e5e3183b.113088"],"x":735,"y":400,"wires":[]},{"id":"e837e947.e18e78","type":"function","z":"40dcdbed.95c274","name":"Парсинг строки","func":"msg.payload = msg.payload.substring(0,7);\nreturn msg;","outputs":1,"noerr":0,"x":580,"y":360,"wires":[["e8642214.68de","7bb15f93.97ca7"]]},{"id":"8d2750c8.13d78","type":"function","z":"40dcdbed.95c274","name":"Парсинг строки","func":"msg.payload = msg.payload.substring(0,7);\nreturn msg;","outputs":1,"noerr":0,"x":580,"y":220,"wires":[["de6e0905.3ec5f8","416a0a32.014724"]]},{"id":"de6e0905.3ec5f8","type":"debug","z":"40dcdbed.95c274","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":770,"y":220,"wires":[]},{"id":"6fa1007a.613f5","type":"function","z":"40dcdbed.95c274","name":"Парсинг строки","func":"msg.payload = msg.payload.substring(0,7);\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":80,"wires":[["71087b82.1d4b84","30f2cc8f.063b74"]]},{"id":"71087b82.1d4b84","type":"debug","z":"40dcdbed.95c274","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":80,"wires":[]},{"id":"5deb1308.403dcc","type":"rpi-gpio in","z":"17b156e0.3aac29","name":"","pin":"31","intype":"down","debounce":"1000","read":false,"x":200,"y":200,"wires":[["ae90f454.dcf108"]]},{"id":"f1b693b4.613ef","type":"rpi-gpio in","z":"17b156e0.3aac29","name":"","pin":"40","intype":"down","debounce":"1000","read":false,"x":200,"y":100,"wires":[["ec96cff.b24cf3"]]},{"id":"3c58a7ac.43a128","type":"tcp in","z":"58118560.4b14cc","name":"","server":"server","host":"10.3.45.250","port":"2500","datamode":"stream","datatype":"utf8","newline":"","topic":"","base64":false,"x":170,"y":100,"wires":[["fd38a4d2.ab0648"]]},{"id":"a2e60f27.2375e","type":"debug","z":"58118560.4b14cc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":100,"wires":[]},{"id":"fd38a4d2.ab0648","type":"delay","z":"58118560.4b14cc","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":370,"y":100,"wires":[["a2e60f27.2375e","bed9a4fb.40adc8","3d0954e6.9cd4ac"]]},{"id":"c20bd0f8.3da67","type":"inject","z":"17b156e0.3aac29","name":"","topic":"","payload":"","payloadType":"date","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":360,"wires":[["965692c9.2f492"]]},{"id":"965692c9.2f492","type":"exec","z":"17b156e0.3aac29","command":"cat /sys/class/gpio/gpio6/value","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"В'їзд","x":270,"y":360,"wires":[["7ac078f5.7c42e8","3cf9adeb.131762","71516403.bb7a9c"],[],[]]},{"id":"9cd8e191.6e3a6","type":"Wiegand","z":"17b156e0.3aac29","name":"","host":"21","timer":"6","x":240,"y":300,"wires":[[]]},{"id":"7ac078f5.7c42e8","type":"debug","z":"17b156e0.3aac29","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":590,"y":360,"wires":[]},{"id":"8df1afa1.c5e","type":"inject","z":"17b156e0.3aac29","name":"","topic":"","payload":"","payloadType":"date","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":420,"wires":[["5ec7eae3.bce124"]]},{"id":"5ec7eae3.bce124","type":"exec","z":"17b156e0.3aac29","command":"cat /sys/class/gpio/gpio21/value","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Виїзд","x":270,"y":420,"wires":[["ecd01e7f.df954","a4c66598.c429c8","c560a518.6fbbf8"],[],[]]},{"id":"ecd01e7f.df954","type":"debug","z":"17b156e0.3aac29","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":590,"y":420,"wires":[]},{"id":"bef50c23.3fdf4","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"e9f9a8a1.a26618","order":1,"width":0,"height":0,"passthru":true,"label":"NFC Охорона","tooltip":"","color":"","bgcolor":"","icon":"","payload":"nfc_1","payloadType":"flow","topic":"NFC Охорона","x":380,"y":500,"wires":[["825f0f87.c25","5ee786cb.4ae1f8"]]},{"id":"cfbed1a.76ca93","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"e9f9a8a1.a26618","order":3,"width":0,"height":0,"passthru":false,"label":"NFC В'їзд","tooltip":"","color":"","bgcolor":"","icon":"","payload":"nfc_2","payloadType":"flow","topic":"NFC В'їзд","x":360,"y":540,"wires":[["ab5f8111.6a6f2"]]},{"id":"ddbad782.1b2968","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"e9f9a8a1.a26618","order":5,"width":0,"height":0,"passthru":false,"label":"NFC Виїзд","tooltip":"","color":"","bgcolor":"","icon":"","payload":"nfc_3","payloadType":"flow","topic":"NFC Охорона","x":370,"y":580,"wires":[["9bf3dedf.4f37d"]]},{"id":"57071f01.eb759","type":"link out","z":"16ab13ed.699cdc","name":"T2_side_0","links":["cc3d0766.8f63f8","b908f2f.85d1c1"],"x":975,"y":160,"wires":[]},{"id":"5c540912.b20f08","type":"ui_form","z":"16ab13ed.699cdc","name":"","label":"Табло 1 IN Сторона 0 (До вагів)","group":"d1c5dc93.0d61d","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":150,"y":160,"wires":[["3ec7c071.aaac4"]]},{"id":"2aa72011.9d77b","type":"ui_form","z":"16ab13ed.699cdc","name":"","label":"Табло2 OUT Сторона 0 (Від вагів)","group":"401b5c7b.57cf84","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":800,"y":160,"wires":[["57071f01.eb759"]]},{"id":"b5724898.c39438","type":"ui_gauge","z":"16ab13ed.699cdc","name":"Вага","group":"6a5b2eb3.f08ef","order":0,"width":0,"height":0,"gtype":"gage","title":"Вага, кг","label":"units","format":"{{value}}","min":0,"max":"60000","colors":["#00b500","#e6e600","#ca3838"],"seg1":"20000","seg2":"40000","x":330,"y":700,"wires":[]},{"id":"76d44e18.5ade9","type":"link out","z":"58118560.4b14cc","name":"scale","links":["378ee394.4cff5c"],"x":600,"y":160,"wires":[]},{"id":"bed9a4fb.40adc8","type":"function","z":"58118560.4b14cc","name":"","func":"msg.payload = global.set(\"weight\",Number(msg.payload));\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":160,"wires":[["76d44e18.5ade9"]]},{"id":"378ee394.4cff5c","type":"link in","z":"16ab13ed.699cdc","name":"scale","links":["76d44e18.5ade9"],"x":100,"y":700,"wires":[["b5724898.c39438","8db002f3.3d108"]]},{"id":"825f0f87.c25","type":"ui_text","z":"16ab13ed.699cdc","group":"e9f9a8a1.a26618","order":2,"width":0,"height":0,"name":"","label":"ID:","format":"{{msg.payload}}","layout":"row-spread","x":590,"y":500,"wires":[]},{"id":"ab5f8111.6a6f2","type":"ui_text","z":"16ab13ed.699cdc","group":"e9f9a8a1.a26618","order":4,"width":0,"height":0,"name":"","label":"ID:","format":"{{msg.payload}}","layout":"row-spread","x":590,"y":540,"wires":[]},{"id":"9bf3dedf.4f37d","type":"ui_text","z":"16ab13ed.699cdc","group":"e9f9a8a1.a26618","order":6,"width":0,"height":0,"name":"","label":"ID:","format":"{{msg.payload}}","layout":"row-spread","x":590,"y":580,"wires":[]},{"id":"5ee786cb.4ae1f8","type":"debug","z":"16ab13ed.699cdc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":640,"y":460,"wires":[]},{"id":"c3c1173.da750e8","type":"link in","z":"16ab13ed.699cdc","name":"","links":["2dc8481b.c01a28"],"x":75,"y":480,"wires":[["42357672.d364b8","9e718b7b.d4ebf8"]]},{"id":"d7e31676.44ef28","type":"link in","z":"16ab13ed.699cdc","name":"","links":["24499bf4.7729a4"],"x":75,"y":520,"wires":[["2a6e7014.a6ee9","77775458.4edfdc"]]},{"id":"2039c89d.c40578","type":"link in","z":"16ab13ed.699cdc","name":"","links":["d140e40a.1d6fc8"],"x":75,"y":560,"wires":[["43b9c72e.a85298"]]},{"id":"42357672.d364b8","type":"function","z":"16ab13ed.699cdc","name":"1 nfc","func":"flow.set(\"nfc_1\",msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":170,"y":480,"wires":[["825f0f87.c25"]]},{"id":"2a6e7014.a6ee9","type":"function","z":"16ab13ed.699cdc","name":"2 nfc","func":"flow.set(\"nfc_2\",msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":170,"y":520,"wires":[["ab5f8111.6a6f2"]]},{"id":"43b9c72e.a85298","type":"function","z":"16ab13ed.699cdc","name":"3 nfc","func":"flow.set(\"nfc_3\",msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":170,"y":560,"wires":[["9bf3dedf.4f37d"]]},{"id":"3cf9adeb.131762","type":"link out","z":"17b156e0.3aac29","name":"Периметр в'їзд","links":["92c2bcb9.503b6","c7693f9.7ef73c"],"x":515,"y":320,"wires":[]},{"id":"a4c66598.c429c8","type":"link out","z":"17b156e0.3aac29","name":"Периметр виїзд","links":["c6ac85cf.2584f8","41192ee0.1c066"],"x":515,"y":460,"wires":[]},{"id":"92c2bcb9.503b6","type":"link in","z":"16ab13ed.699cdc","name":"","links":["3cf9adeb.131762"],"x":95,"y":800,"wires":[["a0f27b71.1cf038"]]},{"id":"c6ac85cf.2584f8","type":"link in","z":"16ab13ed.699cdc","name":"","links":["a4c66598.c429c8"],"x":95,"y":840,"wires":[["3606970b.006e48"]]},{"id":"38f0b3d5.d4a62c","type":"ui_text","z":"16ab13ed.699cdc","group":"455cc101.994c1","order":2,"width":0,"height":0,"name":"","label":"Статус в'їзд","format":"{{msg.payload}}","layout":"row-spread","x":430,"y":800,"wires":[]},{"id":"2ce793a9.e01cec","type":"ui_text","z":"16ab13ed.699cdc","group":"455cc101.994c1","order":1,"width":0,"height":0,"name":"","label":"Статус виїзд","format":"{{msg.payload}}","layout":"row-spread","x":430,"y":840,"wires":[]},{"id":"a0f27b71.1cf038","type":"function","z":"16ab13ed.699cdc","name":"","func":"if(msg.payload == 1){\n    msg.payload = \"В нормі\"\n}else{\n    msg.payload = \"Порушений\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":230,"y":800,"wires":[["38f0b3d5.d4a62c"]]},{"id":"3606970b.006e48","type":"function","z":"16ab13ed.699cdc","name":"","func":"if(msg.payload == 1){\n    msg.payload = \"В нормі\"\n}else{\n    msg.payload = \"Порушений\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":230,"y":840,"wires":[["2ce793a9.e01cec"]]},{"id":"58c254a5.da832c","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"e9f9a8a1.a26618","order":7,"width":0,"height":0,"passthru":false,"label":"Зважування завершене","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":290,"y":640,"wires":[["bf60e2d1.97ab1"]]},{"id":"bf60e2d1.97ab1","type":"function","z":"16ab13ed.699cdc","name":"","func":"msg.payload = \"\";\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":640,"wires":[["825f0f87.c25","ab5f8111.6a6f2","9bf3dedf.4f37d"]]},{"id":"9e718b7b.d4ebf8","type":"debug","z":"16ab13ed.699cdc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":230,"y":420,"wires":[]},{"id":"77775458.4edfdc","type":"debug","z":"16ab13ed.699cdc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":430,"y":420,"wires":[]},{"id":"b8c748b1.f1f4b8","type":"http in","z":"8240f32a.64e8d","name":"","url":"/api/platform/setAccessTable","method":"post","upload":false,"swaggerDoc":"","x":180,"y":240,"wires":[["a27c4f6.e4a65b","6977f44f.754c3c"]]},{"id":"a27c4f6.e4a65b","type":"function","z":"8240f32a.64e8d","name":"set Access Table","func":"// var accessTable = [exampleAcess];\n// var exampleAcess = {\n//     \"pointID\":\"35235325325235\"\n//     \"ip\":\"10.3.5.210\",\n//     \"antennaID\":\"1\",\n//     \"direction\":0,\n//     \"tags\":[\"124124\",\"3525235\"],\n//     \"gpo\":['80','00'],\n//      \"marked\":false\n// }\n\nflow.set('accessTable',msg.payload);\nflow.set('accessTableUpdate',new Date());\nmsg.statusCode = 200;\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":240,"wires":[["38399916.7a5ea6"]]},{"id":"38399916.7a5ea6","type":"http response","z":"8240f32a.64e8d","name":"","x":630,"y":240,"wires":[]},{"id":"670f64aa.bb312c","type":"inject","z":"8240f32a.64e8d","name":"init","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"x":90,"y":40,"wires":[["9869dd8f.25b58"]]},{"id":"9869dd8f.25b58","type":"function","z":"8240f32a.64e8d","name":"NFC conf","func":"//040300000012000001dd0000db0007000280 - 02 GPO index, 80 or 00 - on/off\nflow.set('accessTable',[]);\n//timeout for delay to getting infrared state, ms\nflow.set('infraredtimeout',5000);\nreturn msg;","outputs":1,"noerr":0,"x":260,"y":40,"wires":[["edd8e25e.51f26"]]},{"id":"bfbabe81.f935a","type":"function","z":"8240f32a.64e8d","name":"get row from Access Table","func":"var aT = flow.get('accessTable');\nvar aTDate = flow.get('accessTableUpdate');\nvar nowDate = Date();\nvar diff = flow.get('actualDiff');\n\nmsg.do = false;\n//if access table is not actual\n\nfor (var i = 0; i < aT.length; i++){\n    if ((aT[i].ip === msg.ip) && (Number(aT[i].antenna)===msg.antennaID) && (aT[i].tags.indexOf(msg.tag.tagID) >= 0)&&!(aT[i].done)){\n        msg.accessTable = aT[i];\n        msg.aTLength = aT.length;\n        if ((aT[i].pointID != \"Неопределенно\")){\n            aT[i].done = true;\n        }\n        msg.do = true;\n        break;\n     }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":680,"y":340,"wires":[["6084ba0c.f1d234"]]},{"id":"4088a2cf.771b5c","type":"function","z":"8240f32a.64e8d","name":"get IP","func":"msg.tagID = msg.payload;\nvar  s = \"-\";\nmsg.tagID = msg.tagID.substring(0,2)+s+msg.tagID.substring(2,4)+s+msg.tagID.substring(4,6)+s+msg.tagID.substring(6,8);\nmsg.tag   = {\"tagID\":msg.tagID};\nmsg.antennaID = msg.antennaID;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":340,"wires":[["bfbabe81.f935a"]]},{"id":"bbb0caa8.bfd318","type":"http in","z":"8240f32a.64e8d","name":"","url":"/api/platform/getReaderConfig","method":"get","upload":false,"swaggerDoc":"","x":180,"y":600,"wires":[["bfe70c93.012bd","2cff98e5.1b45f8"]]},{"id":"ff0397a0.441f58","type":"http response","z":"8240f32a.64e8d","name":"","x":630,"y":600,"wires":[]},{"id":"6f98fc09.6f9694","type":"http in","z":"8240f32a.64e8d","name":"","url":"/api/platform/setDefaultTable","method":"post","upload":false,"swaggerDoc":"","x":180,"y":280,"wires":[["6f7f4933.e32778"]]},{"id":"6f7f4933.e32778","type":"function","z":"8240f32a.64e8d","name":"set default Table","func":"// var accessTable = [];\n// var exampleAcess = {\n//     \"ip\":\"10.3.5.210\",\n//     \"port\":5084,\n//     \"gpo\":['0180','0200']\n// }\n\nflow.set('accessTable',msg.payload);\nmsg.statusCode = 200;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":280,"wires":[["1d0fcc3c.b3e304"]]},{"id":"1d0fcc3c.b3e304","type":"http response","z":"8240f32a.64e8d","name":"","x":630,"y":280,"wires":[]},{"id":"53928169.278e3","type":"function","z":"8240f32a.64e8d","name":"FRONT","func":"msg.ip = \"NFC_front\";\nmsg.antennaID = 1;\nreturn msg;","outputs":1,"noerr":0,"x":220,"y":360,"wires":[["4088a2cf.771b5c"]]},{"id":"b251f021.4f29b","type":"function","z":"8240f32a.64e8d","name":"IN","func":"msg.ip = \"NFC_in\";\nmsg.antennaID = 1;\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":400,"wires":[["4088a2cf.771b5c"]]},{"id":"c745a69f.4a3578","type":"function","z":"8240f32a.64e8d","name":"OUT","func":"msg.ip = \"NFC_out\";\nmsg.antennaID = 1;\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":440,"wires":[["4088a2cf.771b5c"]]},{"id":"1d1483d7.fffdec","type":"http in","z":"8240f32a.64e8d","name":"","url":"/api/platform/setReaderConfig","method":"post","upload":false,"swaggerDoc":"","x":660,"y":40,"wires":[["18502db0.5e20c2","18230c7f.b4def4","d2fff1c5.38f77"]]},{"id":"18502db0.5e20c2","type":"http response","z":"8240f32a.64e8d","name":"","x":910,"y":100,"wires":[]},{"id":"927b1d94.09847","type":"inject","z":"8240f32a.64e8d","name":"","topic":"","payload":"puller","payloadType":"flow","repeat":"","crontab":"","once":false,"onceDelay":"","x":100,"y":780,"wires":[["451445f3.85d95c"]]},{"id":"f9f6318f.8e7c1","type":"inject","z":"8240f32a.64e8d","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":93.5,"y":840,"wires":[["27289cbd.f8d254"]]},{"id":"27289cbd.f8d254","type":"function","z":"8240f32a.64e8d","name":"get row from Access Table","func":"var aT = flow.get('accessTable');\nvar aTDate = flow.get('accessTableUpdate');\nvar nowDate = Date();\nvar diff = 2000;\n\nmsg.do = true;\n//if access table is not actual\nif (nowDate-aTDate > diff){\n    msg.do = false;\n}else{\nfor (var i = 0; i < aT.length; i++){\n    if ((aT[i].ip === msg.ip)&&Number(aT[i].antenna)===msg.tag.antennaID){\n        msg.accessTable = aT[i];\n        msg.aTLength = aT.length;\n        break;\n     }\n}\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":294,"y":840,"wires":[["451445f3.85d95c"]]},{"id":"1df745e.487f1ba","type":"function","z":"8240f32a.64e8d","name":"send to 1C","func":"msg.url = flow.get('host1C');\nmsg.tag.lastSeenTimestampUTC = new Date();\nmsg.tag.ip = msg.ip;\nmsg.tag.antenna = String(msg.antennaID);\nmsg.tag.antennaID = String(msg.antennaID);\nmsg.tag.direction = 'IN';\nmsg.tag.weight = JSON.parse(msg.payload);\n\nmsg.payload = [msg.tag];\n\nreturn msg;","outputs":1,"noerr":0,"x":1850,"y":440,"wires":[["c31812f5.3954"]]},{"id":"c31812f5.3954","type":"http request","z":"8240f32a.64e8d","name":"to 1C","method":"POST","ret":"txt","url":"","tls":"","x":2010,"y":440,"wires":[["7784dfd6.ca5a4"]]},{"id":"edd8e25e.51f26","type":"function","z":"8240f32a.64e8d","name":"1C conf","func":"//var host1C = \"http://s-app-mir-test/rfid_mir_test/hs/PerimeterControl/api/PrincipNodeRed/getTags\";\n//var host1C = \"http://s-app-yag-test/UE_yag/hs/PerimeterControl/api/PrincipNodeRed/getTags\";\nvar host1C = \"http://10.3.45.253/UE_yag/hs/PerimeterControl/api/PrincipNodeRed/getTags\";\n\nflow.set('host1C',host1C);\nflow.set('actualDiff',86900); //сколько секунда таблица доступа актуальна\nmsg.url = host1C;\nflow.set('puller',[]);\nflow.set('puller_timeout_sec',30);\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":40,"wires":[["6a63f3c2.3cc6ec"]]},{"id":"18230c7f.b4def4","type":"function","z":"8240f32a.64e8d","name":"","func":"msg.payload.ip = msg.req.query.rfidID;\nmsg.payload.event_name = \"Отправка команды\";\nmsg.payload.event_desc = msg.payload.event_name+\" \"+msg.payload.ip+\" \"+msg.payload.cmd;\nreturn msg;","outputs":1,"noerr":0,"x":910,"y":20,"wires":[[]]},{"id":"6a63f3c2.3cc6ec","type":"http request","z":"8240f32a.64e8d","name":"","method":"GET","ret":"txt","url":"","tls":"","x":350,"y":140,"wires":[["c288bcf5.1a0ac"]]},{"id":"c288bcf5.1a0ac","type":"function","z":"8240f32a.64e8d","name":"set Access Table","func":"flow.set('accessTable',JSON.parse(msg.payload));\nflow.set('accessTableUpdate',new Date());\nreturn msg;","outputs":1,"noerr":0,"x":570,"y":140,"wires":[["1b7568df.6123a7"]]},{"id":"be80fb0e.263628","type":"function","z":"8240f32a.64e8d","name":"Filling Puller","func":"var puller = flow.get('puller');\nvar puller_timeout_sec = flow.get('puller_timeout_sec');\nvar current_element = {\n    'ip':msg.ip,\n    'tagID':msg.tagID,\n    'antennaID':msg.tag.antennaID,\n    'lastSeenTimestampUTC':new Date()\n}\nvar pull = true;\nvar finded = false\nfor (var i = 0; i < puller.length; i++){\n    var element = puller[i];\n    if ((element.ip === current_element.ip)&&(element.tagID===current_element.tagID)&&(element.antennaID===current_element.antennaID)){\n        var diff = (current_element.lastSeenTimestampUTC-element.lastSeenTimestampUTC)*1000;\n        if (diff < puller_timeout_sec){\n            pull = false; \n        }else{\n            puller[i]=current_element;\n        }\n        finded = true;\n    }\n}\nif (!finded){\n    puller.push(current_element);\n}\n\nflow.set('puller',puller);\nmsg.pull = pull;\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":500,"wires":[["e5fe751.8cbae88"]]},{"id":"e5fe751.8cbae88","type":"switch","z":"8240f32a.64e8d","name":"","property":"pull","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":750,"y":500,"wires":[["ea3f79e5.2116f8"]]},{"id":"451445f3.85d95c","type":"debug","z":"8240f32a.64e8d","name":"","active":false,"console":"false","complete":"false","x":490,"y":780,"wires":[]},{"id":"e3fecac1.084838","type":"link in","z":"8240f32a.64e8d","name":"","links":["2dc8481b.c01a28"],"x":75,"y":360,"wires":[["53928169.278e3","97d60ede.b4fb7"]]},{"id":"6e922916.48a198","type":"link in","z":"8240f32a.64e8d","name":"","links":["24499bf4.7729a4"],"x":75,"y":400,"wires":[["b251f021.4f29b","97d60ede.b4fb7"]]},{"id":"84650412.8eddc8","type":"link in","z":"8240f32a.64e8d","name":"","links":["d140e40a.1d6fc8"],"x":75,"y":440,"wires":[["c745a69f.4a3578","97d60ede.b4fb7"]]},{"id":"97d60ede.b4fb7","type":"debug","z":"8240f32a.64e8d","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":410,"y":460,"wires":[]},{"id":"71516403.bb7a9c","type":"function","z":"17b156e0.3aac29","name":"infrared state 1","func":"global.set('infraredstate1',msg.payload);\nglobal.set('infraredstate1Date', new Date());\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":280,"wires":[[]]},{"id":"c560a518.6fbbf8","type":"function","z":"17b156e0.3aac29","name":"infrared state 2","func":"global.set('infraredstate2Date', new Date());\nglobal.set('infraredstate2', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":500,"wires":[[]]},{"id":"bfe70c93.012bd","type":"function","z":"8240f32a.64e8d","name":"check infrared state","func":"var payload = {\n    'infraredstate1':0,\n    'infraredstate2':0\n}\nvar infraredtimeout = flow.get('infraredtimeout');\nvar cDate = new Date();\nif ((cDate - global.get('infraredstate1Date')) < infraredtimeout){\n    payload.infraredstate1 = global.get('infraredstate1') ;   \n}\n\nif ((cDate - global.get('infraredstate2Date')) < infraredtimeout){\n    payload.infraredstate2 = global.get('infraredstate2') ;   \n}\n\nmsg.payload = {\"infraredstate\":payload.infraredstate1 == 1 && payload.infraredstate1 == 2};\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":600,"wires":[["ff0397a0.441f58"]]},{"id":"2cff98e5.1b45f8","type":"debug","z":"8240f32a.64e8d","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":400,"y":520,"wires":[]},{"id":"6977f44f.754c3c","type":"debug","z":"8240f32a.64e8d","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":430,"y":380,"wires":[]},{"id":"83dda67a.b59358","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"d1c5dc93.0d61d","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":100,"y":200,"wires":[["f9526e45.d8bb7"]]},{"id":"6f99a3ca.c99e5c","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"d1c5dc93.0d61d","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":100,"y":240,"wires":[["dbce0f0b.4f00a"]]},{"id":"c5070c2f.76ab","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"401b5c7b.57cf84","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":760,"y":200,"wires":[["c799557e.2e76b8"]]},{"id":"bc656dc7.7f5cf","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"401b5c7b.57cf84","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":760,"y":240,"wires":[["ac989baf.1ca518"]]},{"id":"c799557e.2e76b8","type":"link out","z":"16ab13ed.699cdc","name":"T2_side_0_green_t0","links":["fbd4a6ca.d28648"],"x":875,"y":200,"wires":[]},{"id":"ac989baf.1ca518","type":"link out","z":"16ab13ed.699cdc","name":"T2_side_0_red_t0","links":["58aca752.7940a8"],"x":875,"y":240,"wires":[]},{"id":"7784dfd6.ca5a4","type":"debug","z":"8240f32a.64e8d","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":2190,"y":440,"wires":[]},{"id":"11735989.86d496","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"d1c5dc93.0d61d","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":100,"y":280,"wires":[["d91e5df7.2b3d2"]]},{"id":"e49312df.baa15","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"401b5c7b.57cf84","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":760,"y":280,"wires":[["c33d5543.a961f8"]]},{"id":"c33d5543.a961f8","type":"link out","z":"16ab13ed.699cdc","name":"T2_side_0_off_t0","links":["437d34f.9acf1cc"],"x":875,"y":280,"wires":[]},{"id":"982cc711.70f6e8","type":"switch","z":"8240f32a.64e8d","name":"board_in_out","property":"ip","propertyType":"msg","rules":[{"t":"eq","v":"board_in","vt":"str"},{"t":"eq","v":"board_out","vt":"str"},{"t":"eq","v":"board_in2","vt":"str"},{"t":"eq","v":"board_out2","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":1010,"y":160,"wires":[["ea10be78.65eb8"],["67337a85.f350f4"],["d7e21846.83b358"],["41eec47d.813a4c"]]},{"id":"fd3236dd.6025f8","type":"link out","z":"8240f32a.64e8d","name":"t_g_1_s_0","links":["1f95baf4.180d55","c20924f6.cb5508"],"x":1315,"y":20,"wires":[]},{"id":"ea10be78.65eb8","type":"switch","z":"8240f32a.64e8d","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1200,"y":40,"wires":[["fd3236dd.6025f8"],["bcb8ccec.c50b9"]]},{"id":"67337a85.f350f4","type":"switch","z":"8240f32a.64e8d","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1200,"y":100,"wires":[["7554c058.eda19"],["94cfe2ce.f011e"]]},{"id":"bcb8ccec.c50b9","type":"link out","z":"8240f32a.64e8d","name":"t_r_1_s_0","links":["3b5651f6.753dde","cc620b1.e8fe3f8"],"x":1315,"y":60,"wires":[]},{"id":"7554c058.eda19","type":"link out","z":"8240f32a.64e8d","name":"t_g_2_s_1","links":["77576a92.cb9464","a0fb2f4c.029dc"],"x":1315,"y":100,"wires":[]},{"id":"94cfe2ce.f011e","type":"link out","z":"8240f32a.64e8d","name":"t_r_2_s_1","links":["a622d9c1.240fb8","eed0c6ea.c026b8"],"x":1315,"y":140,"wires":[]},{"id":"3591ed0f.20a192","type":"debug","z":"8240f32a.64e8d","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":860,"y":200,"wires":[]},{"id":"d2fff1c5.38f77","type":"function","z":"8240f32a.64e8d","name":"","func":"msg.ip      = msg.req.query.rfidID;\nmsg.cmd     = msg.payload.cmd;\nreturn msg;","outputs":"1","noerr":0,"x":910,"y":60,"wires":[["982cc711.70f6e8","3591ed0f.20a192"]]},{"id":"2f68e665.491b7a","type":"http in","z":"8240f32a.64e8d","name":"","url":"/api/platform/setBoardText","method":"post","upload":false,"swaggerDoc":"","x":150,"y":680,"wires":[["af2915ed.cb57f8"]]},{"id":"af2915ed.cb57f8","type":"function","z":"8240f32a.64e8d","name":"get boarad ID","func":"msg.ip      = msg.req.query.boardID;\nreturn msg;","outputs":"1","noerr":0,"x":400,"y":680,"wires":[["394b308.a66c4d","890d55b5.38ecd8","2315cf9.a2f7a3"]]},{"id":"394b308.a66c4d","type":"switch","z":"8240f32a.64e8d","name":"board_in_out","property":"ip","propertyType":"msg","rules":[{"t":"eq","v":"board_in","vt":"str"},{"t":"eq","v":"board_out","vt":"str"},{"t":"eq","v":"board_in2","vt":"str"},{"t":"eq","v":"board_out2","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":590,"y":680,"wires":[["28bd5b55.dee084"],["75659f9c.4d943"],["9333c6d0.f0d178"],["708f3024.e375e"]]},{"id":"28bd5b55.dee084","type":"link out","z":"8240f32a.64e8d","name":"1c to Board 1_S0 (rest)","links":["118eea46.c1da56","2cbfc58e.c4996a"],"x":735,"y":640,"wires":[]},{"id":"75659f9c.4d943","type":"link out","z":"8240f32a.64e8d","name":"1c to Board 2_S1 (rest)","links":["5ff6eb49.f272b4","6e9aa121.bcd7d"],"x":735,"y":680,"wires":[]},{"id":"890d55b5.38ecd8","type":"http response","z":"8240f32a.64e8d","name":"","statusCode":"","headers":{},"x":490,"y":740,"wires":[]},{"id":"1b21c769.ee2b09","type":"http request","z":"8240f32a.64e8d","name":"","method":"POST","ret":"txt","url":"http://10.3.45.250:4000/auth/login","tls":"","x":1310,"y":440,"wires":[["88225e85.1edce"]]},{"id":"2f7d1420.5b0cdc","type":"function","z":"8240f32a.64e8d","name":"Авторизация на весах","func":"msg.payload = {\n    \"username\":\"user\", \n    \"password\":\"user\"\n}\nmsg.headers = {\n    \"Content-Type\":\"application/json\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":440,"wires":[["1b21c769.ee2b09"]]},{"id":"88225e85.1edce","type":"function","z":"8240f32a.64e8d","name":"Получаем токен","func":"var payload = JSON.parse(msg.payload);\nmsg.headers = {\n    \"token\":payload.token\n}\nreturn msg;","outputs":1,"noerr":0,"x":1490,"y":440,"wires":[["de215ea7.0c2e7"]]},{"id":"de215ea7.0c2e7","type":"http request","z":"8240f32a.64e8d","name":"","method":"GET","ret":"txt","url":"http://10.3.45.250:4000/api/platform/yag_avto2/getWeight/status","tls":"","x":1670,"y":440,"wires":[["1df745e.487f1ba"]]},{"id":"8db002f3.3d108","type":"debug","z":"16ab13ed.699cdc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":270,"y":740,"wires":[]},{"id":"508f2d3.4e927d4","type":"debug","z":"58118560.4b14cc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":640,"y":220,"wires":[]},{"id":"3d0954e6.9cd4ac","type":"function","z":"58118560.4b14cc","name":"в дашборд","func":"msg.payload = Number(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":220,"wires":[["508f2d3.4e927d4","76d44e18.5ade9"]]},{"id":"689913c7.3bde8c","type":"inject","z":"63e63968.916938","name":"","topic":"","payload":"1722145","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":140,"wires":[["2ce334b6.9a357c"]]},{"id":"2ce334b6.9a357c","type":"function","z":"63e63968.916938","name":"","func":"msg.payload = msg.payload.toString(\"16\");\nreturn msg;","outputs":1,"noerr":0,"x":290,"y":140,"wires":[["18a3c256.9a5c2e"]]},{"id":"18a3c256.9a5c2e","type":"debug","z":"63e63968.916938","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":430,"y":140,"wires":[]},{"id":"7bb15f93.97ca7","type":"function","z":"40dcdbed.95c274","name":"в HEX","func":"var num_wi = Number(msg.payload);\nvar hex_wi = num_wi.toString(\"16\");\n//msg.payload = hex_wi;\nvar char_1 = hex_wi.substring(0,2);\nvar char_2 = hex_wi.substring(2,4);\nvar char_3 = hex_wi.substring(4,7);\nmsg.payload = char_3 + char_2 + char_1 + \"94\";\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":400,"wires":[["54e2eb49.8de214","2dc8481b.c01a28"]]},{"id":"54e2eb49.8de214","type":"debug","z":"40dcdbed.95c274","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":790,"y":440,"wires":[]},{"id":"9753ddc2.68739","type":"comment","z":"8f9d800c.7cdf4","name":"","info":"START1;0;0;1;0;Верхня;Нижня<EOR>\n\nSTART1;0;0;1;іва;фів;","x":100,"y":40,"wires":[]},{"id":"976a0d76.c6f8","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":80,"wires":[["d9f8c8af.34ccd8"]]},{"id":"1915e033.3f4b9","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":1000,"wires":[["a26d34c5.5e8af8"]]},{"id":"d9f8c8af.34ccd8","type":"function","z":"8f9d800c.7cdf4","name":"ТЕСТ 1 сторона 0","func":"\nvar num_avto_r1 = \"АК4323ВВ\";\nvar num_avto_r2 = \"13200 кг\";\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n//            START1;0;0;1;0;Верхня;Нижня<EOR>            \nreturn msg;","outputs":1,"noerr":0,"x":310,"y":80,"wires":[["9843dbc8.13f0b8"]]},{"id":"a26d34c5.5e8af8","type":"function","z":"8f9d800c.7cdf4","name":"ТЕСТ сторона 1","func":"\nvar num_avto_r1 = \" 123  \";\nvar num_avto_r2 = \" ТЕск кг \";\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":560,"y":1000,"wires":[["9843dbc8.13f0b8"]]},{"id":"9843dbc8.13f0b8","type":"converter","z":"8f9d800c.7cdf4","name":"","from":"win1251","x":820,"y":460,"wires":[["ccb823ed.60eb9"]]},{"id":"ccb823ed.60eb9","type":"tcp out","z":"8f9d800c.7cdf4","host":"10.3.45.246","port":"9761","beserver":"client","base64":false,"end":false,"name":"","x":1100,"y":460,"wires":[]},{"id":"d07b3b56.934298","type":"function","z":"8f9d800c.7cdf4","name":"Світлофор червний СТ_0","func":"\n\n\nmsg.payload =\"START1;0;1;3;0;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":420,"y":280,"wires":[["ccb823ed.60eb9"]]},{"id":"f36e622a.be9c","type":"function","z":"8f9d800c.7cdf4","name":"Світлофор зелений СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":420,"y":240,"wires":[["ccb823ed.60eb9"]]},{"id":"df6badf9.1e5eb","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":240,"wires":[["f36e622a.be9c"]]},{"id":"ed207582.5e3848","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":280,"wires":[["d07b3b56.934298"]]},{"id":"f0175f84.c9266","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":1120,"wires":[["dbb8d58d.442978"]]},{"id":"dbb8d58d.442978","type":"function","z":"8f9d800c.7cdf4","name":"погасити світлофори СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":600,"y":1120,"wires":[["71b090b4.cc6e2","ccb823ed.60eb9"]]},{"id":"71b090b4.cc6e2","type":"debug","z":"8f9d800c.7cdf4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":810,"y":1120,"wires":[]},{"id":"faf44534.f24a78","type":"debug","z":"8f9d800c.7cdf4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":810,"y":1040,"wires":[]},{"id":"2261875b.fab6b8","type":"debug","z":"8f9d800c.7cdf4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":810,"y":1080,"wires":[]},{"id":"ae0e46ed.89c338","type":"function","z":"8f9d800c.7cdf4","name":"Світлофор червний СТ_1","func":"\n\n\nmsg.payload =\"START1;0;1;3;1;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":600,"y":1080,"wires":[["2261875b.fab6b8","ccb823ed.60eb9"]]},{"id":"84b0109.40c23f","type":"function","z":"8f9d800c.7cdf4","name":"Світлофор зелений СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":600,"y":1040,"wires":[["faf44534.f24a78","ccb823ed.60eb9"]]},{"id":"59a8ec00.825584","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":1040,"wires":[["84b0109.40c23f"]]},{"id":"2925a2f2.639c1e","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":1080,"wires":[["ae0e46ed.89c338"]]},{"id":"47cc4a6f.3aaa04","type":"comment","z":"8f9d800c.7cdf4","name":"СТОРОНА 0","info":"START1;0;0;1;0;Верхня;Нижня<EOR>\n\nSTART1;0;0;1;іва;фів;","x":70,"y":180,"wires":[]},{"id":"919b33ff.543cd","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":320,"wires":[["c311442a.c99c18"]]},{"id":"c311442a.c99c18","type":"function","z":"8f9d800c.7cdf4","name":"погасити світлофори СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":420,"y":320,"wires":[["ccb823ed.60eb9"]]},{"id":"92adf0f4.3e1d1","type":"inject","z":"8f9d800c.7cdf4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":120,"wires":[["3ab83f01.47b47"]]},{"id":"3ab83f01.47b47","type":"function","z":"8f9d800c.7cdf4","name":"яскравість 100 всі сторони","func":"\n\n\nmsg.payload =\"START1;0;0;102;255;255;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":340,"y":120,"wires":[["ccb823ed.60eb9"]]},{"id":"ed8dc7ab.fe1d08","type":"comment","z":"8f9d800c.7cdf4","name":"СТОРОНА 1 ","info":"START1;0;0;1;0;Верхня;Нижня<EOR>\n\nSTART1;0;0;1;іва;фів;","x":130,"y":680,"wires":[]},{"id":"2ee65716.0cc0c8","type":"function","z":"cdafab9f.08d118","name":"Світлофор зелений СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":220,"wires":[["6c0dcf9b.8958a"]]},{"id":"d7178320.73fdb","type":"comment","z":"cdafab9f.08d118","name":"","info":"START1;0;0;1;0;Верхня;Нижня<EOR>\n\nSTART1;0;0;1;іва;фів;","x":80,"y":20,"wires":[]},{"id":"3e2bbf90.76032","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":60,"wires":[["59353cb0.689ea4"]]},{"id":"30fe6db4.534ca2","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":720,"wires":[["9fd6f5ec.9b4908"]]},{"id":"59353cb0.689ea4","type":"function","z":"cdafab9f.08d118","name":"ТЕСТ 1 сторона 0","func":"\nvar num_avto_r1 = \"АК4323ВВ\";\nvar num_avto_r2 = \"13200 кг\";\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n//            START1;0;0;1;0;Верхня;Нижня<EOR>            \nreturn msg;","outputs":1,"noerr":0,"x":290,"y":60,"wires":[["d2d74828.96ed28"]]},{"id":"9fd6f5ec.9b4908","type":"function","z":"cdafab9f.08d118","name":"ТЕСТ сторона 1","func":"\nvar num_avto_r1 = \" 123  \";\nvar num_avto_r2 = \" ТЕск кг \";\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n           \nreturn msg;","outputs":1,"noerr":0,"x":540,"y":720,"wires":[["d2d74828.96ed28"]]},{"id":"d2d74828.96ed28","type":"converter","z":"cdafab9f.08d118","name":"","from":"win1251","x":840,"y":440,"wires":[["6c0dcf9b.8958a"]]},{"id":"6c0dcf9b.8958a","type":"tcp out","z":"cdafab9f.08d118","host":"10.3.45.245","port":"9761","beserver":"client","base64":false,"end":false,"name":"","x":1080,"y":440,"wires":[]},{"id":"dd03173d.1ea318","type":"function","z":"cdafab9f.08d118","name":"Світлофор червний СТ_0","func":"\n\n\nmsg.payload =\"START1;0;1;3;0;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":260,"wires":[["6c0dcf9b.8958a"]]},{"id":"181b8753.11f2f9","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":220,"wires":[["2ee65716.0cc0c8"]]},{"id":"790a2f78.acb1","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":260,"wires":[["dd03173d.1ea318"]]},{"id":"34a8a8ac.3db778","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":840,"wires":[["60919a5b.05e504"]]},{"id":"60919a5b.05e504","type":"function","z":"cdafab9f.08d118","name":"погасити світлофори СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":580,"y":840,"wires":[["9d9c1d93.ac6ea","6c0dcf9b.8958a"]]},{"id":"9d9c1d93.ac6ea","type":"debug","z":"cdafab9f.08d118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":790,"y":840,"wires":[]},{"id":"9f45dec4.f1097","type":"debug","z":"cdafab9f.08d118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":790,"y":760,"wires":[]},{"id":"18ca9c35.0df1b4","type":"debug","z":"cdafab9f.08d118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":790,"y":800,"wires":[]},{"id":"3ea32773.19a958","type":"function","z":"cdafab9f.08d118","name":"Світлофор червний СТ_1","func":"\n\n\nmsg.payload =\"START1;0;1;3;1;1;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":580,"y":800,"wires":[["18ca9c35.0df1b4","6c0dcf9b.8958a"]]},{"id":"fa45ebb8.5e4198","type":"function","z":"cdafab9f.08d118","name":"Світлофор зелений СТ_1","func":"\n\n\nmsg.payload =\"START1;0;0;3;1;2;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":580,"y":760,"wires":[["9f45dec4.f1097","6c0dcf9b.8958a"]]},{"id":"75d1788.7014e88","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":760,"wires":[["fa45ebb8.5e4198"]]},{"id":"e9fbb629.dc6d78","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":800,"wires":[["3ea32773.19a958"]]},{"id":"d69d5c70.a078","type":"comment","z":"cdafab9f.08d118","name":"СТОРОНА 0","info":"START1;0;0;1;0;Верхня;Нижня<EOR>\n\nSTART1;0;0;1;іва;фів;","x":70,"y":160,"wires":[]},{"id":"ec1957a7.132b98","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":300,"wires":[["80a33f74.cdb07"]]},{"id":"80a33f74.cdb07","type":"function","z":"cdafab9f.08d118","name":"погасити світлофори СТ_0","func":"\n\n\nmsg.payload =\"START1;0;0;3;0;0;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":300,"wires":[["6c0dcf9b.8958a"]]},{"id":"ebd8590e.d836e8","type":"inject","z":"cdafab9f.08d118","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":100,"wires":[["829789d4.571cc8"]]},{"id":"829789d4.571cc8","type":"function","z":"cdafab9f.08d118","name":"яскравість 100 всі сторони","func":"\n\n\nmsg.payload =\"START1;0;0;102;255;255;\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":320,"y":100,"wires":[["6c0dcf9b.8958a"]]},{"id":"57a69e7e.7b4da","type":"comment","z":"cdafab9f.08d118","name":"СТОРОНА 1 ","info":"START1;0;0;1;0;Верхня;Нижня<EOR>\n\nSTART1;0;0;1;іва;фів;","x":70,"y":600,"wires":[]},{"id":"416a0a32.014724","type":"function","z":"40dcdbed.95c274","name":"в HEX","func":"var num_wi = Number(msg.payload);\nvar hex_wi = num_wi.toString(\"16\");\n//msg.payload = hex_wi;\nvar char_1 = hex_wi.substring(0,2);\nvar char_2 = hex_wi.substring(2,4);\nvar char_3 = hex_wi.substring(4,7);\nmsg.payload = char_3 + char_2 + char_1 + \"94\";\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":260,"wires":[["90551594.0a8e38","d140e40a.1d6fc8"]]},{"id":"30f2cc8f.063b74","type":"function","z":"40dcdbed.95c274","name":"в HEX","func":"var num_wi = Number(msg.payload);\nvar hex_wi = num_wi.toString(\"16\");\n//msg.payload = hex_wi;\nvar char_1 = hex_wi.substring(0,2);\nvar char_2 = hex_wi.substring(2,4);\nvar char_3 = hex_wi.substring(4,7);\nmsg.payload = char_3 + char_2 + char_1 + \"94\";\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":120,"wires":[["b5dca28f.dce1d","24499bf4.7729a4"]]},{"id":"b34c847c.68f3d8","type":"function","z":"8f9d800c.7cdf4","name":"Дані строки з форми СТ_0","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":420,"y":360,"wires":[["9843dbc8.13f0b8"]]},{"id":"aa2e9ded.b3c7","type":"function","z":"8f9d800c.7cdf4","name":"Дані строки з форми СТ_1","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":600,"y":960,"wires":[["9843dbc8.13f0b8"]]},{"id":"184b9be1.7cb5b4","type":"function","z":"cdafab9f.08d118","name":"Дані строки з форми СТ_0","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":480,"y":340,"wires":[["d2d74828.96ed28"]]},{"id":"b175e348.58f16","type":"function","z":"cdafab9f.08d118","name":"Дані строки з форми СТ_1","func":"var num_avto_r1 = msg.payload.r1;\nvar num_avto_r2 = msg.payload.r2;\n\n\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":580,"y":680,"wires":[["d2d74828.96ed28"]]},{"id":"50380708.dae788","type":"function","z":"8f9d800c.7cdf4","name":"Дані строки з NFC CТ_0","func":"var num_avto_r1 = msg.truck1;\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":410,"y":400,"wires":[[]]},{"id":"f8df4196.7c8b4","type":"function","z":"8f9d800c.7cdf4","name":"Дані строки з NFC CТ_1","func":"var num_avto_r1 = msg.truck1;\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":590,"y":920,"wires":[[]]},{"id":"48fcf238.af5c2c","type":"function","z":"cdafab9f.08d118","name":"Дані строки з NFC CТ_0","func":"var num_avto_r1 = msg.truck1;\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":470,"y":380,"wires":[["d2d74828.96ed28"]]},{"id":"f6d4de8c.e549b","type":"function","z":"cdafab9f.08d118","name":"Дані строки з NFC CТ_1","func":"var num_avto_r1 = msg.truck1;\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":570,"y":640,"wires":[["d2d74828.96ed28"]]},{"id":"d3c1f258.864c","type":"ui_form","z":"16ab13ed.699cdc","name":"","label":"Табло 1 IN Сторона 1 (Від вагів)","group":"7e42aaa1.8169f4","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":470,"y":160,"wires":[["3897260d.1714da"]]},{"id":"b06284cd.fdfc28","type":"ui_form","z":"16ab13ed.699cdc","name":"","label":"Табло2 OUT Сторона 1 (До вагів)","group":"7959d802.3ba6c8","order":1,"width":0,"height":0,"options":[{"label":"Номер","value":"r1","type":"text","required":false},{"label":"Вага","value":"r2","type":"text","required":false}],"formValue":{"r1":"","r2":""},"payload":"","submit":"submit","cancel":"cancel","topic":"","x":1160,"y":160,"wires":[["941a82ac.e540e"]]},{"id":"3897260d.1714da","type":"link out","z":"16ab13ed.699cdc","name":"T1 _ side 1","links":["bc09e8a4.dee8f8"],"x":635,"y":160,"wires":[]},{"id":"941a82ac.e540e","type":"link out","z":"16ab13ed.699cdc","name":"T2_side 1","links":["c2ac5553.e36a18"],"x":1335,"y":160,"wires":[]},{"id":"bc09e8a4.dee8f8","type":"link in","z":"cdafab9f.08d118","name":"","links":["3897260d.1714da"],"x":355,"y":680,"wires":[["b175e348.58f16"]]},{"id":"6251b577.3eb99c","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"7e42aaa1.8169f4","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":400,"y":200,"wires":[["7ae501d4.01ce6"]]},{"id":"65aa90a4.a61fc","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"7e42aaa1.8169f4","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":400,"y":240,"wires":[["e0d5e72f.6f6f18"]]},{"id":"a8b81543.11a4d8","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"7e42aaa1.8169f4","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":400,"y":280,"wires":[["66ec6317.db2e5c"]]},{"id":"e834354b.ea9fb8","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"7959d802.3ba6c8","order":1,"width":0,"height":0,"passthru":true,"label":"Зелений","tooltip":"","color":"","bgcolor":"green","icon":"","payload":"","payloadType":"date","topic":"","x":1160,"y":200,"wires":[["467b2077.b7ded"]]},{"id":"95300760.961d78","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"7959d802.3ba6c8","order":1,"width":0,"height":0,"passthru":true,"label":"Червоний","tooltip":"","color":"","bgcolor":"red","icon":"","payload":"","payloadType":"date","topic":"","x":1160,"y":240,"wires":[["c6cdc82b.463f48"]]},{"id":"467b2077.b7ded","type":"link out","z":"16ab13ed.699cdc","name":"Зелений Т2","links":["3ef87fbd.2fbb7"],"x":1275,"y":200,"wires":[]},{"id":"c6cdc82b.463f48","type":"link out","z":"16ab13ed.699cdc","name":"Чероний Т2","links":["4a87bb6e.5d5784"],"x":1275,"y":240,"wires":[]},{"id":"c2ddf685.13df68","type":"ui_button","z":"16ab13ed.699cdc","name":"","group":"7959d802.3ba6c8","order":1,"width":0,"height":0,"passthru":true,"label":"Погасити","tooltip":"","color":"","bgcolor":"gray","icon":"","payload":"","payloadType":"date","topic":"","x":1160,"y":280,"wires":[["d4a57fa1.95e0e"]]},{"id":"d4a57fa1.95e0e","type":"link out","z":"16ab13ed.699cdc","name":" погасити Т2","links":["23c80ed.84bf9f2"],"x":1275,"y":280,"wires":[]},{"id":"7ae501d4.01ce6","type":"link out","z":"16ab13ed.699cdc","name":"T1_side_1_green","links":["edc669c8.9cd9d8"],"x":540,"y":200,"wires":[]},{"id":"e0d5e72f.6f6f18","type":"link out","z":"16ab13ed.699cdc","name":"T1_side_1_red","links":["36ccdb44.1612d4"],"x":535,"y":240,"wires":[]},{"id":"66ec6317.db2e5c","type":"link out","z":"16ab13ed.699cdc","name":"T1_side_1_off","links":["71d47b56.4b7424"],"x":535,"y":280,"wires":[]},{"id":"edc669c8.9cd9d8","type":"link in","z":"cdafab9f.08d118","name":"","links":["7ae501d4.01ce6"],"x":355,"y":780,"wires":[["fa45ebb8.5e4198"]]},{"id":"36ccdb44.1612d4","type":"link in","z":"cdafab9f.08d118","name":"","links":["e0d5e72f.6f6f18"],"x":355,"y":820,"wires":[["3ea32773.19a958"]]},{"id":"71d47b56.4b7424","type":"link in","z":"cdafab9f.08d118","name":"","links":["66ec6317.db2e5c"],"x":355,"y":860,"wires":[["60919a5b.05e504"]]},{"id":"3ec7c071.aaac4","type":"link out","z":"16ab13ed.699cdc","name":"T1 _ side 0","links":["92321d42.9cdf"],"x":315,"y":160,"wires":[]},{"id":"f9526e45.d8bb7","type":"link out","z":"16ab13ed.699cdc","name":"T1_side_0_green","links":["d8161dbd.befbe"],"x":215,"y":200,"wires":[]},{"id":"dbce0f0b.4f00a","type":"link out","z":"16ab13ed.699cdc","name":"T1_side_0_red","links":["c3565113.21934"],"x":210,"y":240,"wires":[]},{"id":"d91e5df7.2b3d2","type":"link out","z":"16ab13ed.699cdc","name":"T1_side_0_off","links":["81013935.01eed8"],"x":210,"y":280,"wires":[]},{"id":"92321d42.9cdf","type":"link in","z":"cdafab9f.08d118","name":"T1 _ side 0_t","links":["3ec7c071.aaac4"],"x":315,"y":340,"wires":[["184b9be1.7cb5b4"]]},{"id":"d8161dbd.befbe","type":"link in","z":"cdafab9f.08d118","name":"T1_side_0_gree_t","links":["f9526e45.d8bb7"],"x":275,"y":200,"wires":[["2ee65716.0cc0c8"]]},{"id":"c3565113.21934","type":"link in","z":"cdafab9f.08d118","name":"T1_side_0_red_t","links":["dbce0f0b.4f00a"],"x":275,"y":240,"wires":[["dd03173d.1ea318"]]},{"id":"81013935.01eed8","type":"link in","z":"cdafab9f.08d118","name":"T1_side_0_off_t","links":["d91e5df7.2b3d2"],"x":275,"y":280,"wires":[["80a33f74.cdb07"]]},{"id":"b908f2f.85d1c1","type":"link in","z":"8f9d800c.7cdf4","name":"","links":["57071f01.eb759"],"x":235,"y":360,"wires":[["b34c847c.68f3d8"]]},{"id":"fbd4a6ca.d28648","type":"link in","z":"8f9d800c.7cdf4","name":"","links":["c799557e.2e76b8"],"x":235,"y":220,"wires":[["f36e622a.be9c"]]},{"id":"58aca752.7940a8","type":"link in","z":"8f9d800c.7cdf4","name":"","links":["ac989baf.1ca518"],"x":235,"y":260,"wires":[["d07b3b56.934298"]]},{"id":"437d34f.9acf1cc","type":"link in","z":"8f9d800c.7cdf4","name":"","links":["c33d5543.a961f8"],"x":235,"y":300,"wires":[["c311442a.c99c18"]]},{"id":"c2ac5553.e36a18","type":"link in","z":"8f9d800c.7cdf4","name":"T2_side_1","links":["941a82ac.e540e"],"x":395,"y":960,"wires":[["aa2e9ded.b3c7"]]},{"id":"3ef87fbd.2fbb7","type":"link in","z":"8f9d800c.7cdf4","name":"T2_side_1_green","links":["467b2077.b7ded"],"x":395,"y":1020,"wires":[["84b0109.40c23f"]]},{"id":"4a87bb6e.5d5784","type":"link in","z":"8f9d800c.7cdf4","name":"T2_side_1_red","links":["c6cdc82b.463f48"],"x":395,"y":1060,"wires":[["ae0e46ed.89c338"]]},{"id":"23c80ed.84bf9f2","type":"link in","z":"8f9d800c.7cdf4","name":"T2_side_1_off","links":["d4a57fa1.95e0e"],"x":395,"y":1100,"wires":[["dbb8d58d.442978"]]},{"id":"90551594.0a8e38","type":"debug","z":"40dcdbed.95c274","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":770,"y":260,"wires":[]},{"id":"b5dca28f.dce1d","type":"debug","z":"40dcdbed.95c274","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":120,"wires":[]},{"id":"83c8f01c.556a2","type":"comment","z":"16ab13ed.699cdc","name":"До вагів T2 S1","info":"","x":1100,"y":120,"wires":[]},{"id":"ef0601f7.bf9eb","type":"comment","z":"16ab13ed.699cdc","name":"Від вагів T2 S0","info":"","x":760,"y":120,"wires":[]},{"id":"2135e69c.05e3ea","type":"comment","z":"16ab13ed.699cdc","name":"Від вагів T1 S1","info":"","x":420,"y":120,"wires":[]},{"id":"900e9865.a6d5f8","type":"comment","z":"16ab13ed.699cdc","name":"До вагів T1 S0","info":"","x":100,"y":120,"wires":[]},{"id":"8ba548b6.80f098","type":"comment","z":"cdafab9f.08d118","name":"До вагів T1 S0","info":"","x":220,"y":160,"wires":[]},{"id":"2cc4ddf7.833682","type":"comment","z":"cdafab9f.08d118","name":"Від вагів T1 S1","info":"","x":220,"y":600,"wires":[]},{"id":"cb5054d8.97d3e8","type":"comment","z":"8f9d800c.7cdf4","name":"Від вагів T2 S0","info":"","x":220,"y":180,"wires":[]},{"id":"c40dea47.6e1338","type":"comment","z":"8f9d800c.7cdf4","name":"До вагів T2 S1","info":"","x":280,"y":680,"wires":[]},{"id":"4cc4e4b2.b52abc","type":"function","z":"cdafab9f.08d118","name":"Дані строки з NFC","func":"\nvar num_avto_r1 = msg.payload;\nvar num_avto_r2 = \"\";\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":450,"y":440,"wires":[["d2d74828.96ed28"]]},{"id":"e5e3183b.113088","type":"link in","z":"cdafab9f.08d118","name":"","links":["24499bf4.7729a4","2dc8481b.c01a28"],"x":315,"y":440,"wires":[[]]},{"id":"255bb8a6.85eb98","type":"function","z":"8f9d800c.7cdf4","name":"Дані строки з NFC CT_0","func":"\nvar num_avto_r1 = msg.payload;\nvar num_avto_r2 = \"\";\n\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + num_avto_r2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":410,"y":440,"wires":[["9843dbc8.13f0b8"]]},{"id":"370a49db.efffe6","type":"link in","z":"8f9d800c.7cdf4","name":"","links":["d140e40a.1d6fc8"],"x":235,"y":440,"wires":[["255bb8a6.85eb98"]]},{"id":"118eea46.c1da56","type":"link in","z":"cdafab9f.08d118","name":"1C to Board 1","links":["28bd5b55.dee084"],"x":155,"y":500,"wires":[["45dba6fe.615028"]]},{"id":"45dba6fe.615028","type":"function","z":"cdafab9f.08d118","name":"Дані строки з 1C","func":"msg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":330,"y":500,"wires":[["d2d74828.96ed28"]]},{"id":"5633a79f.83ce58","type":"link in","z":"cdafab9f.08d118","name":"rfid truck 1 table 1","links":["46f16a9d.111e54"],"x":155,"y":540,"wires":[["d4aad9c0.3f9db8"]]},{"id":"d4aad9c0.3f9db8","type":"function","z":"cdafab9f.08d118","name":"Дані строки з NFC","func":"var num_avto_r1 = msg.truck1;\n\nmsg.payload =\"START1;0;0;1;0;\" + num_avto_r1 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":330,"y":540,"wires":[["c525c88f.b4c988","d2d74828.96ed28"]]},{"id":"c525c88f.b4c988","type":"switch","z":"cdafab9f.08d118","name":"","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"finded","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":550,"y":540,"wires":[["dd03173d.1ea318"]]},{"id":"c20924f6.cb5508","type":"link in","z":"cdafab9f.08d118","name":"table_in_green_1_S0","links":["fd3236dd.6025f8"],"x":155,"y":360,"wires":[["2ee65716.0cc0c8"]]},{"id":"cc620b1.e8fe3f8","type":"link in","z":"cdafab9f.08d118","name":"table_in_red_1_S0","links":["bcb8ccec.c50b9","c7734ae5.72b348"],"x":155,"y":400,"wires":[["dd03173d.1ea318"]]},{"id":"1897a143.00f7af","type":"function","z":"8f9d800c.7cdf4","name":"Дані строки з NFC","func":"var num_avto_r1 = msg.truck1;\n\nmsg.payload =\"START1;0;0;1;1;\" + num_avto_r1 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":390,"y":780,"wires":[["cb196fb2.c47b","9843dbc8.13f0b8"]]},{"id":"ac90de1.b4d6e2","type":"link in","z":"8f9d800c.7cdf4","name":"rfid truck 1 table 2","links":["46f16a9d.111e54"],"x":235,"y":780,"wires":[["1897a143.00f7af"]]},{"id":"cb196fb2.c47b","type":"switch","z":"8f9d800c.7cdf4","name":"","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"finded","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":570,"y":780,"wires":[["ae0e46ed.89c338"]]},{"id":"77576a92.cb9464","type":"link in","z":"8f9d800c.7cdf4","name":"table_out_green_2_S1","links":["7554c058.eda19"],"x":215,"y":860,"wires":[["84b0109.40c23f"]]},{"id":"eed0c6ea.c026b8","type":"link in","z":"8f9d800c.7cdf4","name":"table_out_red_2_S1","links":["94cfe2ce.f011e"],"x":215,"y":900,"wires":[["ae0e46ed.89c338"]]},{"id":"6e9aa121.bcd7d","type":"link in","z":"8f9d800c.7cdf4","name":"1C to board 2","links":["75659f9c.4d943"],"x":235,"y":740,"wires":[["f78eb0a2.3a0e8"]]},{"id":"f78eb0a2.3a0e8","type":"function","z":"8f9d800c.7cdf4","name":"Дані строки з 1C","func":"msg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":370,"y":740,"wires":[["9843dbc8.13f0b8"]]},{"id":"9333c6d0.f0d178","type":"link out","z":"8240f32a.64e8d","name":"1c to Board 1_S1 (rest)","links":["41e5b8c.40b8548"],"x":735,"y":720,"wires":[]},{"id":"708f3024.e375e","type":"link out","z":"8240f32a.64e8d","name":"1c to Board 2_S0 (rest)","links":["5f04f545.b7b78c"],"x":735,"y":760,"wires":[]},{"id":"41e5b8c.40b8548","type":"link in","z":"cdafab9f.08d118","name":"1C to Board 1 S1","links":["9333c6d0.f0d178"],"x":175,"y":920,"wires":[["de5ee461.60a138"]]},{"id":"de5ee461.60a138","type":"function","z":"cdafab9f.08d118","name":"Дані строки з 1C","func":"msg.payload =\"START1;0;0;1;1;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":350,"y":920,"wires":[["d2d74828.96ed28"]]},{"id":"5f04f545.b7b78c","type":"link in","z":"8f9d800c.7cdf4","name":"1C to board 2 S0","links":["708f3024.e375e"],"x":235,"y":480,"wires":[["5971150e.971c0c"]]},{"id":"5971150e.971c0c","type":"function","z":"8f9d800c.7cdf4","name":"Дані строки з 1C","func":"msg.payload =\"START1;0;0;1;0;\" +  msg.payload.row1 +\";\" + msg.payload.row2 +\";\" + String.fromCharCode(10) + String.fromCharCode(13);\n             \nreturn msg;","outputs":1,"noerr":0,"x":370,"y":480,"wires":[["9843dbc8.13f0b8"]]},{"id":"b2f76f35.05f3","type":"link out","z":"8240f32a.64e8d","name":"t_g_1_s_1","links":["89d969f7.ef0b78"],"x":1315,"y":180,"wires":[]},{"id":"d7e21846.83b358","type":"switch","z":"8240f32a.64e8d","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1200,"y":160,"wires":[["b2f76f35.05f3"],["700a4a2a.ce1574"]]},{"id":"700a4a2a.ce1574","type":"link out","z":"8240f32a.64e8d","name":"t_r_1_s_1","links":["3b5651f6.753dde","94b6871.e467b78"],"x":1315,"y":220,"wires":[]},{"id":"41eec47d.813a4c","type":"switch","z":"8240f32a.64e8d","name":"green/red","property":"cmd","propertyType":"msg","rules":[{"t":"eq","v":"0100","vt":"str"},{"t":"eq","v":"0180","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1200,"y":220,"wires":[["1c454ea0.3b14a1"],["bebd30ff.616d7"]]},{"id":"89d969f7.ef0b78","type":"link in","z":"cdafab9f.08d118","name":"table_in_green_1_S1","links":["b2f76f35.05f3"],"x":195,"y":660,"wires":[["fa45ebb8.5e4198"]]},{"id":"94b6871.e467b78","type":"link in","z":"cdafab9f.08d118","name":"table_in_red_1_S1","links":["700a4a2a.ce1574"],"x":195,"y":700,"wires":[["3ea32773.19a958"]]},{"id":"829a072d.9663e8","type":"link in","z":"8f9d800c.7cdf4","name":"table_out_green_2_S0","links":["1c454ea0.3b14a1"],"x":115,"y":380,"wires":[["f36e622a.be9c"]]},{"id":"fd9cc720.485fd8","type":"link in","z":"8f9d800c.7cdf4","name":"table_out_red_2_S0","links":["bebd30ff.616d7"],"x":115,"y":420,"wires":[["d07b3b56.934298"]]},{"id":"1c454ea0.3b14a1","type":"link out","z":"8240f32a.64e8d","name":"t_g_2_s_0","links":["829a072d.9663e8","a0fb2f4c.029dc"],"x":1315,"y":260,"wires":[]},{"id":"bebd30ff.616d7","type":"link out","z":"8240f32a.64e8d","name":"t_r_2_s_0","links":["fd9cc720.485fd8"],"x":1315,"y":300,"wires":[]},{"id":"6202a763.6593f8","type":"http in","z":"8240f32a.64e8d","name":"","url":"/api/platform/getAccessTable","method":"get","upload":false,"swaggerDoc":"","x":170,"y":200,"wires":[["67984219.3f4c5c"]]},{"id":"67984219.3f4c5c","type":"function","z":"8240f32a.64e8d","name":"set Access Table","func":"msg.payload = flow.get('accessTable');\nmsg.statusCode = 200;\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":200,"wires":[["2e6ccef9.e5b842"]]},{"id":"2e6ccef9.e5b842","type":"http response","z":"8240f32a.64e8d","name":"","statusCode":"","headers":{},"x":620,"y":200,"wires":[]},{"id":"1b7568df.6123a7","type":"debug","z":"8240f32a.64e8d","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":140,"wires":[]},{"id":"2315cf9.a2f7a3","type":"debug","z":"8240f32a.64e8d","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":600,"y":860,"wires":[]},{"id":"ea3f79e5.2116f8","type":"function","z":"8240f32a.64e8d","name":"check infrared state","func":"var acess_granted = flow.get('access_granted');\n\nvar payload = {\n    'infraredstate1':0,\n    'infraredstate2':0\n}\nvar infraredtimeout = flow.get('infraredtimeout');\nvar cDate = new Date();\nif ((cDate - global.get('infraredstate1Date')) < infraredtimeout){\n    payload.infraredstate1 = global.get('infraredstate1') ;   \n}\n\nif ((cDate - global.get('infraredstate2Date')) < infraredtimeout){\n    payload.infraredstate2 = global.get('infraredstate2') ;   \n}\n\nmsg.perimetr = (payload.infraredstate1 == 1 && payload.infraredstate2 == 1);\nmsg.request_for_access = !acess_granted;\nflow.set('acess_granted',false);\nreturn msg;","outputs":1,"noerr":0,"x":930,"y":560,"wires":[["a39dcaff.750d38"]]},{"id":"a39dcaff.750d38","type":"switch","z":"8240f32a.64e8d","name":"request_for_access true/false","property":"request_for_access","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1200,"y":560,"wires":[["2f7d1420.5b0cdc"],["e8693d34.8771b"]]},{"id":"e8693d34.8771b","type":"function","z":"8240f32a.64e8d","name":"send text to board","func":"flow.set('temp_tagID',msg.tagID);\n\nmsg.payload = {\n                \"row1\":\"датчик\",\n                \"row2\":\"перекрито\"\n            };\n\n\nreturn msg;","outputs":1,"noerr":0,"x":1140,"y":640,"wires":[["28bd5b55.dee084","75659f9c.4d943"]]},{"id":"6084ba0c.f1d234","type":"switch","z":"8240f32a.64e8d","name":"access granted","property":"do","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":910,"y":340,"wires":[["17771783.ddf1b8"],["be80fb0e.263628"]]},{"id":"17771783.ddf1b8","type":"function","z":"8240f32a.64e8d","name":"set granted ","func":"flow.set('access_granted',true);\nreturn msg;","outputs":1,"noerr":0,"x":1110,"y":340,"wires":[[]]}]
