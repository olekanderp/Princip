[{"id":"273cec33.ecb1f4","type":"tab","label":"Flow 1"},{"id":"c7c38a30.528b08","type":"serial-port","z":"","serialport":"/dev/ttyUSB0","serialbaud":"57600","databits":"8","parity":"none","stopbits":"1","newline":"1500","bin":"bin","out":"time","addchar":false},{"id":"2fa0abb7.a0d104","type":"function","z":"273cec33.ecb1f4","name":"length","func":"var epc = msg.payload;\nvar lengEpc = epc.length;\nif(lengEpc > 12){\n    return msg;\n}\n","outputs":1,"noerr":0,"x":310,"y":239,"wires":[["d48d325b.2e1d1"]]},{"id":"d6acb07d.c91ed","type":"serial in","z":"273cec33.ecb1f4","name":"","serial":"c7c38a30.528b08","x":170,"y":239,"wires":[["2fa0abb7.a0d104","b8ba9575.7d7248","c2b65ed2.6ef8b"]]},{"id":"d48d325b.2e1d1","type":"function","z":"273cec33.ecb1f4","name":"main filter","func":"var epc = msg.payload;\nvar epcStr = epc.slice(4, 30);\n\n\nvar keycode = \"\";\nvar el = \"\";\n\n\nepcStr.forEach(function(element) {\n  if (element.toString('16').length <2) el = \"0\" + element.toString('16'); else el = element.toString('16');\n  keycode = keycode + el;\n});\n\nmsg.payload = keycode.substring(0,24);\nflow.set(\"keycode\",msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":239,"wires":[["66164614.dd97c8","a310cb33.3e62e8"]]},{"id":"b8ba9575.7d7248","type":"debug","z":"273cec33.ecb1f4","name":"","active":true,"console":false,"complete":"false","x":330,"y":279,"wires":[]},{"id":"66164614.dd97c8","type":"debug","z":"273cec33.ecb1f4","name":"","active":true,"console":false,"complete":"false","x":610,"y":239,"wires":[]},{"id":"c1937e3e.bdf0a","type":"http response","z":"273cec33.ecb1f4","name":"","x":750,"y":279,"wires":[]},{"id":"3a17673b.ea0258","type":"function","z":"273cec33.ecb1f4","name":"zaput","func":"//msg.payload = Buffer.from(\"0C00020001020400000000BD33\",\"hex\"); 14 байт\nmsg.payload = Buffer.from(\"0C000200010206000000003525\",\"hex\");    // 16 байт      \nflow.set(\"res\",msg.res);\nflow.set(\"req\",msg.req);\nreturn msg;","outputs":1,"noerr":0,"x":455.00000762939453,"y":99.00000190734863,"wires":[["f690fec8.a8b72","10530b00.567b55"]]},{"id":"a8c874a6.ef5858","type":"inject","z":"273cec33.ecb1f4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":180,"y":99,"wires":[["3a17673b.ea0258"]]},{"id":"f690fec8.a8b72","type":"serial out","z":"273cec33.ecb1f4","name":"","serial":"c7c38a30.528b08","x":670,"y":99,"wires":[]},{"id":"ccf09125.83782","type":"http in","z":"273cec33.ecb1f4","name":"","url":"/api/platform/getTag","method":"get","swaggerDoc":"","x":210,"y":139,"wires":[["3a17673b.ea0258","10530b00.567b55"]]},{"id":"a310cb33.3e62e8","type":"function","z":"273cec33.ecb1f4","name":"RFID SEND","func":"msg.payload = {\n    \"rfid\": flow.get(\"keycode\")\n}\n//flow.set('rfid',\"\");\n\n\n\nmsg.res = flow.get(\"res\",msg.res);\nmsg.req = flow.set(\"req\",msg.req);\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":279,"wires":[["c1937e3e.bdf0a"]]},{"id":"10530b00.567b55","type":"debug","z":"273cec33.ecb1f4","name":"","active":true,"console":false,"complete":"false","x":611.2500076293945,"y":139.00000190734863,"wires":[]},{"id":"55743dcd.19d704","type":"debug","z":"273cec33.ecb1f4","name":"","active":true,"console":false,"complete":"false","x":370,"y":339,"wires":[]},{"id":"b2ce7df0.20023","type":"inject","z":"273cec33.ecb1f4","name":"Остання мітка","topic":"","payload":"keycode","payloadType":"flow","repeat":"","crontab":"","once":false,"x":200,"y":339,"wires":[["55743dcd.19d704"]]},{"id":"cd03640c.0baf78","type":"inject","z":"273cec33.ecb1f4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":127,"y":441,"wires":[["8f9cbceb.54042"]]},{"id":"8f9cbceb.54042","type":"function","z":"273cec33.ecb1f4","name":"read","func":"msg.payload = Buffer.from(\"0C00020001020400000000BD33\", \"hex\");\nreturn msg;","outputs":1,"noerr":0,"x":263,"y":439,"wires":[["300413a4.97b3dc","31b4fa4b.8f65f6"]]},{"id":"300413a4.97b3dc","type":"debug","z":"273cec33.ecb1f4","name":"","active":true,"console":false,"complete":"false","x":470,"y":433,"wires":[]},{"id":"31b4fa4b.8f65f6","type":"serial out","z":"273cec33.ecb1f4","name":"","serial":"c7c38a30.528b08","x":578,"y":370,"wires":[]},{"id":"b9554bba.29c068","type":"inject","z":"273cec33.ecb1f4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":118,"y":486,"wires":[["db601928.769b18"]]},{"id":"db601928.769b18","type":"function","z":"273cec33.ecb1f4","name":"open sesion 1","func":"msg.payload = Buffer.from(\"04FF211995\", \"hex\");\nreturn msg;","outputs":1,"noerr":0,"x":284,"y":484,"wires":[["369478aa.0ba1a8","300413a4.97b3dc","31b4fa4b.8f65f6"]]},{"id":"369478aa.0ba1a8","type":"debug","z":"273cec33.ecb1f4","name":"","active":true,"console":false,"complete":"false","x":461,"y":478,"wires":[]},{"id":"fbaaf9cb.8f74f8","type":"inject","z":"273cec33.ecb1f4","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":121,"y":538,"wires":[["6564d19d.8eea9"]]},{"id":"6564d19d.8eea9","type":"function","z":"273cec33.ecb1f4","name":"open sesion 2","func":"msg.payload = Buffer.from(\"040021D96A\", \"hex\");\nreturn msg;","outputs":1,"noerr":0,"x":287,"y":536,"wires":[["15631f18.458d51","31b4fa4b.8f65f6"]]},{"id":"15631f18.458d51","type":"debug","z":"273cec33.ecb1f4","name":"","active":true,"console":false,"complete":"false","x":464,"y":530,"wires":[]},{"id":"c2b65ed2.6ef8b","type":"function","z":"273cec33.ecb1f4","name":"length 0","func":"var epc = msg.payload;\nvar lengEpc = epc.length;\nif(lengEpc < 7){\n    return msg;\n}\n","outputs":1,"noerr":0,"x":320.00000381469727,"y":201.25000286102295,"wires":[["22dc00fb.79694"]]},{"id":"95d220b7.6a4b4","type":"http response","z":"273cec33.ecb1f4","name":"","x":636.2500114440918,"y":198.75000190734863,"wires":[]},{"id":"22dc00fb.79694","type":"function","z":"273cec33.ecb1f4","name":"RFID SEND","func":"msg.payload = {\n    \"rfid\": null\n}\n//flow.set('rfid',\"\");\n\n\n\nmsg.res = flow.get(\"res\",msg.res);\nmsg.req = flow.set(\"req\",msg.req);\nreturn msg;","outputs":1,"noerr":0,"x":488.75003814697266,"y":198.75000381469727,"wires":[["95d220b7.6a4b4"]]}]
