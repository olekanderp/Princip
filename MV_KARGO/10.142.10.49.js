[{"id":"1a058ff7.9f1118","type":"tab","label":"Print pdf","disabled":false,"info":""},{"id":"9776c835.6cbc78","type":"tab","label":"Serial MOXA","disabled":false,"info":""},{"id":"4bb080a4.fa4e3","type":"exec","z":"1a058ff7.9f1118","command":"","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":890,"y":60,"wires":[["884a736b.8171e"],["daf59b73.735078"],["d77a46e6.0de1e"]]},{"id":"884a736b.8171e","type":"debug","z":"1a058ff7.9f1118","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":710,"y":200,"wires":[]},{"id":"daf59b73.735078","type":"debug","z":"1a058ff7.9f1118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":710,"y":240,"wires":[]},{"id":"d77a46e6.0de1e","type":"debug","z":"1a058ff7.9f1118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":710,"y":280,"wires":[]},{"id":"34e0de6d.c2415a","type":"file","z":"1a058ff7.9f1118","name":"","filename":"","appendNewline":false,"createDir":true,"overwriteFile":"true","encoding":"none","x":530,"y":60,"wires":[["1709824.95f087e","a500a41f.c54848"]]},{"id":"964a02f8.12bc48","type":"http in","z":"1a058ff7.9f1118","name":"","url":"sendToPrinter","method":"post","upload":false,"swaggerDoc":"","x":120,"y":60,"wires":[["893bd0a7.73e998","81a08b72.b64f3","308821eb.cc7dfe"]]},{"id":"893bd0a7.73e998","type":"http response","z":"1a058ff7.9f1118","name":"","statusCode":"","headers":{},"x":202,"y":200,"wires":[]},{"id":"cc7abd87.c494","type":"http in","z":"1a058ff7.9f1118","name":"","url":"/getLastPDF","method":"get","upload":false,"swaggerDoc":"","x":141.5,"y":487,"wires":[["9cc0add7.9b7aa8"]]},{"id":"7336e10.61ec9a","type":"http response","z":"1a058ff7.9f1118","name":"","statusCode":"","headers":{},"x":478.5,"y":490,"wires":[]},{"id":"184b1027.43749","type":"debug","z":"1a058ff7.9f1118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":501.5,"y":548,"wires":[]},{"id":"9cc0add7.9b7aa8","type":"file in","z":"1a058ff7.9f1118","name":"","filename":"filename.pdf","format":"","chunk":false,"sendError":false,"encoding":"none","x":323.5,"y":484,"wires":[["7336e10.61ec9a","184b1027.43749"]]},{"id":"1709824.95f087e","type":"debug","z":"1a058ff7.9f1118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":450,"y":160,"wires":[]},{"id":"81a08b72.b64f3","type":"function","z":"1a058ff7.9f1118","name":"query params","func":"msg.printer_name = msg.req.query.name;\nmsg.barcode      = msg.req.query.barcode;\nmsg.filename     = msg.barcode+\".pdf\";\n\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":60,"wires":[["34e0de6d.c2415a"]]},{"id":"a500a41f.c54848","type":"function","z":"1a058ff7.9f1118","name":"set cmd","func":"msg.payload = \"lp\" + \" -n 2 -o collate=true\" + \" -d \" + msg.printer_name + \"  -o fit-to-page \"+msg.filename;\n//lp -d Zebra_Technologies_ZTC_GC420d_  -o fit-to-page filename.pdf\nreturn msg;\n\n","outputs":1,"noerr":0,"x":740,"y":60,"wires":[["4bb080a4.fa4e3"]]},{"id":"308821eb.cc7dfe","type":"debug","z":"1a058ff7.9f1118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":170,"y":300,"wires":[]},{"id":"10efa619.6bcaca","type":"tcp in","z":"9776c835.6cbc78","name":"","server":"client","host":"10.142.10.41","port":"4015","datamode":"stream","datatype":"utf8","newline":"","topic":"","base64":false,"x":150,"y":180,"wires":[["ffe57df9.9f5dd","87ab7a3b.c9f1"]]},{"id":"ffe57df9.9f5dd","type":"debug","z":"9776c835.6cbc78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":470,"y":180,"wires":[]},{"id":"3f3ba9a1.22d046","type":"tcp in","z":"9776c835.6cbc78","name":"","server":"client","host":"10.142.10.40","port":"4016","datamode":"stream","datatype":"utf8","newline":"","topic":"","base64":false,"x":150,"y":260,"wires":[["419b6b03.4a2304","71432a27.5b943c"]]},{"id":"419b6b03.4a2304","type":"debug","z":"9776c835.6cbc78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":460,"y":260,"wires":[]},{"id":"1a532ff.09f8fd","type":"tcp in","z":"9776c835.6cbc78","name":"","server":"client","host":"10.142.10.42","port":"4017","datamode":"stream","datatype":"utf8","newline":"","topic":"","base64":false,"x":150,"y":340,"wires":[["f70bb76e.749158","c7eedffa.5fd3d"]]},{"id":"f70bb76e.749158","type":"debug","z":"9776c835.6cbc78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":460,"y":340,"wires":[]},{"id":"6e36f731.c1dc98","type":"tcp in","z":"9776c835.6cbc78","name":"","server":"client","host":"10.142.10.43","port":"4018","datamode":"stream","datatype":"utf8","newline":"","topic":"","base64":false,"x":150,"y":420,"wires":[["6e2423ee.c43a3c","98f85d06.2ca86"]]},{"id":"6e2423ee.c43a3c","type":"debug","z":"9776c835.6cbc78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":460,"y":420,"wires":[]},{"id":"dcb612b0.d7bc48","type":"inject","z":"9776c835.6cbc78","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":110,"y":100,"wires":[["a7cf6c31.37cef8"]]},{"id":"a7cf6c31.37cef8","type":"function","z":"9776c835.6cbc78","name":"init flow params","func":"flow.set('host','192.168.10.5/kku_prod/hs/PerimeterControl/api/NodeRed/BarCode');\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":100,"wires":[[]]},{"id":"20dedb47.259e4c","type":"function","z":"9776c835.6cbc78","name":"set payload","func":"msg.payload = {\n    'BarCode':msg.payload,\n    'ReaderId':msg.readerID,\n    'dateCreated':new Date(),\n    'dateModified':new Date()\n}\nmsg.url = flow.get('host');\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":560,"wires":[["32c4ec70.883fbc","868c577a.d313b8"]]},{"id":"32c4ec70.883fbc","type":"http request","z":"9776c835.6cbc78","name":"","method":"POST","ret":"txt","paytoqs":false,"url":"","tls":"","proxy":"","authType":"basic","x":850,"y":560,"wires":[["ac99c22a.5adc1"]]},{"id":"ac99c22a.5adc1","type":"debug","z":"9776c835.6cbc78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1010,"y":360,"wires":[]},{"id":"87ab7a3b.c9f1","type":"function","z":"9776c835.6cbc78","name":"Пробовідбірник 2","func":"msg.readerID = 'p2';\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":220,"wires":[["20dedb47.259e4c"]]},{"id":"71432a27.5b943c","type":"function","z":"9776c835.6cbc78","name":"Пробовідбірник 1","func":"msg.readerID = 'p1';\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":300,"wires":[["20dedb47.259e4c"]]},{"id":"c7eedffa.5fd3d","type":"function","z":"9776c835.6cbc78","name":"Пробовідбірник 3","func":"msg.readerID = 'p3';\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":380,"wires":[["20dedb47.259e4c"]]},{"id":"98f85d06.2ca86","type":"function","z":"9776c835.6cbc78","name":"Пробовідбірник 4","func":"msg.readerID = 'p4';\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":460,"wires":[["20dedb47.259e4c"]]},{"id":"b85267c1.552a08","type":"inject","z":"9776c835.6cbc78","name":"","topic":"","payload":"2101000245854","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":560,"wires":[["33672d13.091292"]]},{"id":"33672d13.091292","type":"function","z":"9776c835.6cbc78","name":"p5","func":"msg.readerID = 'p5';\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":560,"wires":[["20dedb47.259e4c"]]},{"id":"64ca95a7.c43d4c","type":"debug","z":"9776c835.6cbc78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":660,"y":420,"wires":[]},{"id":"868c577a.d313b8","type":"debug","z":"9776c835.6cbc78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":720,"y":480,"wires":[]}]
